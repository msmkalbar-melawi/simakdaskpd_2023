<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');


class Calk extends CI_Controller {

	function __contruct(){	
		parent::__construct();
  
	}

	function get_status($tgl,$skpd){
        $n_status = '';
        $tanggal = $tgl;
        $sql = "select case when '$tanggal'>=tgl_dpa_ubah then 'nilai_ubah' 
                    when '$tanggal'>=tgl_dpa_sempurna then 'nilai_sempurna' 
                    when '$tanggal'<=tgl_dpa 
                    then 'nilai' else 'nilai' end as anggaran from trhrka where kd_skpd ='$skpd'";
        $q_trhrka = $this->db->query($sql);
        $num_rows = $q_trhrka->num_rows();
        
        foreach ($q_trhrka->result() as $r_trhrka){
             $n_status = $r_trhrka->anggaran;                   
        }    
        return $n_status;                         
    }
	
	function hambatan_pendapatan(){
        $data['page_title']= 'HAMBATAN CALK';
        $this->template->set('title', 'HAMBATAN CALK');   
        $this->template->load('template','calk/cetak_hambatan_pendapatan',$data) ;	
	}
	
	function lap_lra_lo_calk(){
        $data['page_title']= 'LAPORAN CALK LRA LO';
        $this->template->set('title', 'LAPORAN CALK LRA LO');   
        $this->template->load('template','calk/cetak_lap_calk_lra_lo',$data) ;	
	}
	
	function lap_aset_calk(){
        $data['page_title']= 'LAPORAN ASET CALK';
        $this->template->set('title', 'LAPORAN ASET CALK');   
        $this->template->load('template','calk/cetak_lap_aset_calk',$data) ;	
	}
	
	function lap_wajib_calk(){
        $data['page_title']= 'LAPORAN WAJIB CALK';
        $this->template->set('title', 'LAPORAN WAJIB CALK');   
        $this->template->load('template','calk/cetak_lap_wajib_calk',$data) ;	
	}
	
	function lap_lpe_lain_calk(){
        $data['page_title']= 'LAPORAN LPE LAIN CALK';
        $this->template->set('title', 'LAPORAN LPE LAIN CALK');   
        $this->template->load('template','calk/cetak_lap_lpe_calk',$data) ;	
	}
	
	function lap_lpe_beban_lain(){
        $data['page_title']= 'LAPORAN LPE BEBAN LAIN';
        $this->template->set('title', 'LAPORAN LPE BEBAN LAIN');   
        $this->template->load('template','calk/cetak_lap_calk_beban_lain',$data) ;	
	}
	
	function lap_penyajian_calk(){
        $data['page_title']= 'LAPORAN PENYAJIAN DATA CALK';
        $this->template->set('title', 'LAPORAN PENYAJIAN DATA CALK');   
        $this->template->load('template','calk/cetak_lap_penyajian_calk',$data) ;	
	}
	
	function cetak_hambatan_pendapatan(){
		$ctk = $this->uri->segment(3);
        $spasi = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;
        $angg    = "nilai_ubah"; //$this->get_status($dcetak,$kd_skpd);
        $lanjut  = 0;

		
	    if($angg=='nilai'){
            $jangg = 'PENYUSUNAN' ;  
            $v = '1';
	    } else{
	       if($angg=='nilai_sempurna'){
	           $jangg = 'PENYEMPURNAAN' ;
               $v = '2';
	       }else{
	           $jangg = 'PERUBAHAN' ;
               $v = '3';
	       }
	    }
		
        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">HAMBATAN PENDAPATAN</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr></table>";
				  
				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\"><tr>
											  <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">Kode SKPD</td>
											  <td bgcolor=\"#CCCCCC\" width=\"25%\" align=\"center\">Nama SKPD</td>
											  <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">Kode Rekening</td>                        
                    						  <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\">Nama Rekening</td>
                    						  <td bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\">Keterangan</td>
                    				</tr>"; 		  

				$sql = "select kd_skpd, (select nm_skpd from ms_skpd where kd_skpd=a.kd_skpd) nm_skpd, kd_ang, (SELECT nm_rek4 FROM ms_rek4 WHERE kd_rek4=kd_ang) nm_rek, ket1 from lamp_calk_at a ORDER BY kd_skpd, kd_ang";
				
				$sqlsclient=$this->db->query($sql);
					
					$no=1;
					foreach ($sqlsclient->result() as $row)
					{
						$kd_skpd=$row->kd_skpd;
						$nm_skpd=$row->nm_skpd;
						$kd_ang=$row->kd_ang;
						$nm_rek=$row->nm_rek;
						$ket1=$row->ket1;
						
						
						$cRet .= "<tr>
											 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
                    						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
                    						 <td align=\"center\" valign=\"top\">".$kd_ang."</td>                         
                    						 <td align=\"left\" valign=\"top\">".$nm_rek."</td>                         
                    						 <td align=\"justify\" valign=\"top\">".$ket1."</td>                         
                    			</tr>"; 
						
					}
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("BAB_II");
        $this->template->set('title', 'BAB II');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_calk_lo_811(){
		$ctk     = $this->uri->segment(3);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;

        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">LAPORAN CALK PAJAK LO</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Pajak Daerah - LRA $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Piutang Pajak $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Piutang Pajak $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Pajak Daerah - LO $thn</td>                        
					</tr>"; 		  

		$sql = "SELECT x.kd_skpd, x.nm_skpd, ISNULL(y.lra_pjk,0) lra_pjk, 
											 ISNULL(y.piutang_pjk,0) piutang_pjk, 
											 ISNULL(y.piutang_pjk_lalu,0) piutang_pjk_lalu 
				FROM (SELECT kd_skpd, nm_skpd FROM ms_skpd) x
					  LEFT JOIN
					 (SELECT kd_unit,
							 SUM(CASE WHEN jns=411 AND thn=$thn THEN nilai ELSE 0 END) AS lra_pjk, 
							 SUM(CASE WHEN jns=811 AND thn=$thn THEN nilai ELSE 0 END) AS piutang_pjk,
							 SUM(CASE WHEN jns=811 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS piutang_pjk_lalu 
					  FROM (
						SELECT 811 jns, d.kd_unit, $cthnsbl thn, ISNULL(SUM(d.debet-d.kredit),0)*-1 nilai 
						FROM trhju_calk c INNER JOIN trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE LEFT(d.kd_rek5,5)='11301' AND YEAR(c.tgl_voucher)<='$cthnsbl'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 811 jns, d.kd_unit, $thn thn, ISNULL(SUM(d.debet-d.kredit),0) nilai 
						FROM trhju_calk c inner join trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE LEFT(d.kd_rek5,5)='11301' AND YEAR(c.tgl_voucher)<='$thn'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 411 jns, b.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,3)=411 AND YEAR(a.tgl_voucher)=$thn
						GROUP BY b.kd_unit ) p GROUP BY kd_unit 
					  ) y ON x.kd_skpd=y.kd_unit 
				WHERE lra_pjk<>0 OR piutang_pjk<>0 OR piutang_pjk_lalu<>0 
				ORDER BY kd_skpd";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$lra_pjk=$row->lra_pjk;
			$piutang_pjk=$row->piutang_pjk;
			$piutang_pjk_lalu=$row->piutang_pjk_lalu;
						
			$pjk_lo = $lra_pjk+$piutang_pjk+$piutang_pjk_lalu;
						
			IF($lra_pjk<0){$num_lra_pajak = $lra_pjk*-1; $a="("; $b=")";} ELSE { $num_lra_pajak = $lra_pjk; $a=""; $b="";}
			IF($piutang_pjk<0){$num_piutang_pjk = $piutang_pjk*-1; $c="("; $d=")";} ELSE { $num_piutang_pjk = $piutang_pjk; $c=""; $d="";}
			IF($piutang_pjk_lalu<0){$num_piutang_pjk_lalu = $piutang_pjk_lalu*-1; $e="("; $f=")";} ELSE { $num_piutang_pjk_lalu = $piutang_pjk_lalu; $e=""; $f="";}
			IF($pjk_lo<0){$num_pjk_lo = $pjk_lo*-1; $g="("; $h=")";} ELSE { $num_pjk_lo = $pjk_lo; $g=""; $h="";}
						
			$cRet .= "<tr>
						 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
						 <td align=\"right\" valign=\"top\">$a".number_format($num_lra_pajak,"2",",",".")."$b</td>                         
						 <td align=\"right\" valign=\"top\">$c".number_format($num_piutang_pjk,"2",",",".")."$d</td>                         
						 <td align=\"right\" valign=\"top\">$e".number_format($num_piutang_pjk_lalu,"2",",",".")."$f</td> 
						 <td align=\"right\" valign=\"top\">$g".number_format($num_pjk_lo,"2",",",".")."$h</td>
					</tr>"; 
		} 
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_PAJAK");
        $this->template->set('title', 'LAPORAN CALK PAJAK');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_calk_aset(){
		$ctk     = $this->uri->segment(3);
		$rek     = $this->uri->segment(4);
		$jns     = $this->uri->segment(5);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');

		IF($jns=='1'){$judul2="BERTAMBAH"; $nil="tambah"; $num=2;}
		ELSE{$judul2="BERKURANG"; $nil="kurang"; $num=3;}
		
		IF($rek=='131'){ $judul="TANAH"; $rek1="kd_rek3='$rek'"; $rek2="LEFT(kd_rek,4)=$rek$num";}
		ELSE IF($rek=='132'){ $judul="PERALATAN DAN MESIN"; $rek1="kd_rek3='$rek'"; $rek2="LEFT(kd_rek,4)=$rek$num";}
		ELSE IF($rek=='133'){ $judul="GEDUNG DAN BANGUNAN"; $rek1="kd_rek3='$rek'"; $rek2="LEFT(kd_rek,4)=$rek$num";}
		ELSE IF($rek=='134'){ $judul="JALAN, IRIGASI DAN JARINGAN"; $rek1="kd_rek3='$rek'"; $rek2="LEFT(kd_rek,4)=$rek$num";}
		ELSE IF($rek=='135'){ $judul="ASET TETAP LAINNYA"; $rek1="kd_rek3='$rek'"; $rek2="LEFT(kd_rek,4)=$rek$num";}
		ELSE IF($rek=='136'){ $judul="KONSTRUKSI DALAM PENGERJAAN"; $rek1="kd_rek3='$rek'"; $rek2="LEFT(kd_rek,4)=$rek$num";}
		ELSE IF($rek=='143'){ $judul="ASET TIDAK BERWUJUD"; $rek1="LEFT(kd_rek5,5) IN ('15301','15302','15303','15304','15305')"; $rek2="LEFT(kd_rek,4)=$rek$num";}
		ELSE { $judul="ASET LAIN-LAIN"; $rek1="kd_rek3='154'"; $rek2="LEFT(kd_rek,4)=$rek$num";}
		
		
		
		
        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">PEMERINTAH PROVINSI KALIMANTAN BARAT</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">$judul</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">NAMA SKPD</td>
						<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">KODE AKUN</td>
						<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"50%\" align=\"center\">$judul2</td>                        
					</tr>
					<tr>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">PENJELASAN</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">REALISASI</td>
					</tr>
					<tr>
						<td bgcolor=\"#CCCCCC\" align=\"center\">1</td>
						<td bgcolor=\"#CCCCCC\" align=\"center\">2</td>
						<td bgcolor=\"#CCCCCC\" align=\"center\">3</td>
						<td bgcolor=\"#CCCCCC\" align=\"center\">4</td>                        
						<td bgcolor=\"#CCCCCC\" align=\"center\">5</td>                        
					</tr>"; 		  
		
		$sql = "SELECT *, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd FROM (
					SELECT 1 jns, kd_skpd, '' kd_rek2, kd_rek3, '' penjelasan, ISNULL(SUM($nil),0) nilai, '' kd_rinci 
					FROM lamp_aset WHERE $rek1 
					GROUP BY kd_skpd, kd_rek3
					UNION ALL
					SELECT 2 jns, kd_skpd, kd_rek kd_rek2, 131 kd_rek, ket penjelasan, nilai, kd_rinci
					FROM isi_neraca_calk WHERE $rek2 ) x
					WHERE nilai<>0 and kd_skpd<>''
					ORDER BY kd_skpd, jns, kd_rek2, kd_rinci, nilai";
		$sqlsclient=$this->db->query($sql);
		
		foreach ($sqlsclient->result() as $row)
		{
			$jns=$row->jns;
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$kd_rek3=$row->kd_rek3;
			$penjelasan=$row->penjelasan;
			$nilai=$row->nilai;
			$kd_rinci=$row->kd_rinci;
			
			IF($nilai<0){$num_nilai = $nilai*-1; $a="("; $b=")";} ELSE { $num_nilai = $nilai; $a=""; $b="";}
			
			if($jns==1){
				$cRet .= "<tr>
							 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
							 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
							 <td align=\"center\" valign=\"top\">".$kd_rek3."</td>                         
							 <td align=\"justify\" valign=\"top\">&nbsp;</td>                         
							 <td align=\"right\" valign=\"top\">$a".number_format($nilai,"2",",",".")."$b</td> 
						</tr>"; 
			}else{
				$cRet .= "<tr>
							 <td align=\"center\" valign=\"top\">&nbsp;</td>
							 <td align=\"left\" valign=\"top\">&nbsp;</td>                         
							 <td align=\"center\" valign=\"top\">&nbsp;</td>                         
							 <td align=\"justify\" valign=\"top\">$penjelasan</td>                         
							 <td align=\"right\" valign=\"top\">$a".number_format($nilai,"2",",",".")."$b</td> 
						</tr>"; 
			}
		} 
		
		$query1 = $this->db->query("SELECT ISNULL(SUM($nil),0) nilai, '' kd_rinci 
									FROM lamp_aset WHERE $rek1");
		$prvn = $query1->row();          
		$jum = $prvn->nilai;     
		
		$cRet .= "<tr>
							 <td colspan=\"4\" align=\"center\" valign=\"top\"><b>Total</b></td>
							 <td align=\"right\" valign=\"top\"><b>".number_format($jum,"2",",",".")."</b></td> 
						</tr>"; 
		
						
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_ASET");
        $this->template->set('title', 'LAPORAN CALK ASET');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_calk_wajib(){
		$ctk     = $this->uri->segment(3);
		$rek     = $this->uri->segment(4);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');

		IF($rek=='211'){ $judul="Utang PPh Pusat"; $rek2="LEFT(kd_rek5,5)='21103'";}
		ELSE IF($rek=='212'){ $judul="Utang PPN Pusat"; $rek2="LEFT(kd_rek5,5)='21104'";}
		ELSE IF($rek=='213'){ $judul="Utang Perhitungan Pihak Ketiga Lainnya"; $rek2="LEFT(kd_rek5,5)='21107'";}
		ELSE IF($rek=='221'){ $judul="Pendapatan Diterima Dimuka lainnya"; $rek2="LEFT(kd_rek5,3)='214'";}
		ELSE IF($rek=='231'){ $judul="Utang Belanja Pegawai"; $rek2="LEFT(kd_rek5,5)='21501'";}
		ELSE IF($rek=='232'){ $judul="Utang Belanja Barang dan Jasa"; $rek2="LEFT(kd_rek5,5)='21502'";}
		ELSE { $judul="Utang Belanja Modal"; $rek2="LEFT(kd_rek5,5)='21503'";}
		
        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">PEMERINTAH PROVINSI KALIMANTAN BARAT</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">$judul</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">KODE AKUN</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">NILAI</td>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">PENJELASAN</td>                        
					</tr>
					<tr>
						<td bgcolor=\"#CCCCCC\" align=\"center\">1</td>
						<td bgcolor=\"#CCCCCC\" align=\"center\">2</td>
						<td bgcolor=\"#CCCCCC\" align=\"center\">3</td>
						<td bgcolor=\"#CCCCCC\" align=\"center\">4</td>                        
						<td bgcolor=\"#CCCCCC\" align=\"center\">5</td>                        
					</tr>"; 		  
		
		$sql = "SELECT *, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, $rek kd_rek3 FROM (
					SELECT 1 jns, a.kd_unit kd_skpd, ISNULL(SUM(CASE WHEN YEAR(tgl_voucher)<=$thn THEN kredit-debet ELSE 0 END),0) nilai, '' penjelasan, '' kd_rinci
					FROM trdju_calk a INNER JOIN trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					WHERE $rek2
					GROUP BY a.kd_unit
					UNION ALL
					SELECT 2 jns, kd_skpd, 0 nilai, ket penjelasan, kd_rinci FROM isi_neraca_calk WHERE kd_rek=$rek) x
					WHERE nilai<>0 OR penjelasan NOT LIKE ''
					ORDER BY kd_skpd, jns";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$jns=$row->jns;
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$kd_rek3=$row->kd_rek3;
			$penjelasan=$row->penjelasan;
			$nilai=$row->nilai;
			$kd_rinci=$row->kd_rinci;
						
			IF($nilai<0){$num_nilai = $nilai*-1; $a="("; $b=")";} ELSE { $num_nilai = $nilai; $a=""; $b="";}
			
			if($jns==1){
				$cRet .= "<tr>
							 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
							 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
							 <td align=\"center\" valign=\"top\">".$kd_rek3."</td>                         
							 <td align=\"right\" valign=\"top\">$a".number_format($num_nilai,"2",",",".")."$b</td> 
							 <td align=\"right\" valign=\"top\">&nbsp;</td> 
						</tr>"; 
			}else{
				$cRet .= "<tr>
							 <td align=\"center\" valign=\"top\">&nbsp;</td>
							 <td align=\"left\" valign=\"top\">&nbsp;</td>                         
							 <td align=\"center\" valign=\"top\">&nbsp;</td>                         
							 <td align=\"justify\" valign=\"top\">&nbsp;</td>                         
							 <td align=\"justify\" valign=\"top\">$penjelasan</td> 
						</tr>"; 
			}
		}
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_ASET");
        $this->template->set('title', 'LAPORAN CALK ASET');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_penyajian_calk(){
		$ctk     = $this->uri->segment(3);
		$rek     = $this->uri->segment(4);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');

		IF($rek=='131'){ $judul="TANAH"; $rek_bel=521; $rek_lamp="kd_rek3='$rek'";}
		ELSE IF($rek=='132'){ $judul="PERALATAN DAN MESIN"; $rek_bel=522; $rek_lamp="kd_rek3='$rek'";}
		ELSE IF($rek=='133'){ $judul="GEDUNG DAN BANGUNAN"; $rek_bel=523; $rek_lamp="kd_rek3='$rek'";}
		ELSE IF($rek=='134'){ $judul="JALAN, IRIGASI DAN JARINGAN"; $rek_bel=524; $rek_lamp="kd_rek3='$rek'";}
		ELSE IF($rek=='135'){ $judul="ASET TETAP LAINNYA"; $rek_bel=525; $rek_lamp="kd_rek3='$rek'";}
		ELSE { $judul="ASET LAINNYA"; $rek_bel=526; $rek_lamp="LEFT(kd_rek3,2)='15'";}
		
        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">PEMERINTAH PROVINSI KALIMANTAN BARAT</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">$judul</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"25%\" align=\"center\">NAMA SKPD</td>
						<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\">REALISASI TAHUN ANGGARAN $thn</td>
						<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">SELISIH</td>                        
						<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\">KETERANGAN</td>                        
					</tr>
					<tr>
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">BELANJA MODAL</td>
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">NERACA</td>
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">NILAI</td>
						<td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\">PENJELASAN</td>
					</tr>
					<tr>
						<td bgcolor=\"#CCCCCC\" align=\"center\">1</td>
						<td bgcolor=\"#CCCCCC\" align=\"center\">2</td>
						<td bgcolor=\"#CCCCCC\" align=\"center\">3</td>
						<td bgcolor=\"#CCCCCC\" align=\"center\">4</td>                        
						<td bgcolor=\"#CCCCCC\" align=\"center\">5</td>                        
						<td bgcolor=\"#CCCCCC\" align=\"center\">6</td>                        
						<td bgcolor=\"#CCCCCC\" align=\"center\">7</td>                        
					</tr>"; 		  
		
		$sql = "SELECT *, tot_belanja_modal-tot_neraca selisih, 0 nilai, '' ket, '' kd_rinci, 1 jns FROM (
				SELECT x.kd_skpd, x.nm_skpd, ISNULL(y.tot_belanja_modal,0) tot_belanja_modal, ISNULL(z.tot_neraca,0) tot_neraca FROM ms_skpd x
				LEFT JOIN
				(
				SELECT b.kd_unit, ISNULL(SUM(debet-kredit),0) tot_belanja_modal 
				FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher 
				WHERE YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)=$rek_bel
				GROUP BY b.kd_unit) y ON x.kd_skpd=y.kd_unit
				LEFT JOIN
				(SELECT kd_skpd, ISNULL(SUM(tahun_n),0) tot_neraca FROM lamp_aset WHERE $rek_lamp GROUP BY kd_skpd) z
				ON x.kd_skpd=z.kd_skpd) t
				WHERE tot_belanja_modal<>0 OR tot_neraca<>0
				UNION ALL
				SELECT kd_skpd, '' nm_skpd, 0 tot_belanja_modal, 0 tot_neraca, 0 selisih, nilai, ket, kd_rinci, 2 jns FROM isi_analisis_calk WHERE kd_rek='$rek'
				ORDER BY kd_skpd, kd_rinci";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$jns=$row->jns;
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$tot_belanja_modal=$row->tot_belanja_modal;
			$tot_neraca=$row->tot_neraca;
			$selisih=$row->selisih;
			$nilai=$row->nilai;
			$ket=$row->ket;
			$kd_rinci=$row->kd_rinci;
						
			IF($tot_belanja_modal<0){$num_tot_belanja_modal = $tot_belanja_modal*-1; $a="("; $b=")";} ELSE { $num_tot_belanja_modal = $tot_belanja_modal; $a=""; $b="";}
			IF($tot_neraca<0){$num_tot_neraca = $tot_neraca*-1; $c="("; $d=")";} ELSE { $num_tot_neraca = $tot_neraca; $c=""; $d="";}
			IF($selisih<0){$num_selisih = $selisih*-1; $e="("; $f=")";} ELSE { $num_selisih = $selisih; $e=""; $f="";}
			IF($nilai<0){$num_nilai = $nilai*-1; $g="("; $h=")";} ELSE { $num_nilai = $nilai; $g=""; $h="";}
			
			if($jns==1){
				$cRet .= "<tr>
							 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
							 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
							 <td align=\"right\" valign=\"top\">$a".number_format($num_tot_belanja_modal,"2",",",".")."$b</td>                         
							 <td align=\"right\" valign=\"top\">$c".number_format($num_tot_neraca,"2",",",".")."$d</td>                         
							 <td align=\"right\" valign=\"top\">$e".number_format($num_selisih,"2",",",".")."$f</td> 
							 <td align=\"right\" valign=\"top\">$g".number_format($num_nilai,"2",",",".")."$h</td> 
							 <td align=\"justify\" valign=\"top\">$ket</td> 
						</tr>"; 
			}else{
				$cRet .= "<tr>
							 <td align=\"center\" valign=\"top\"></td>
							 <td align=\"left\" valign=\"top\"></td>                         
							 <td align=\"right\" valign=\"top\"></td>                         
							 <td align=\"right\" valign=\"top\"></td>                         
							 <td align=\"right\" valign=\"top\"></td> 
							 <td align=\"right\" valign=\"top\">$g".number_format($num_nilai,"2",",",".")."$h</td> 
							 <td align=\"justify\" valign=\"top\">$ket</td>  
						</tr>"; 
			}
		} 
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_PENJELESAN");
        $this->template->set('title', 'LAPORAN CALK PENJELESAN');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	
	function cetak_lap_calk_lo_812(){
		$ctk     = $this->uri->segment(3);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;

        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">LAPORAN CALK RETRIBUSI LO</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Retribusi Daerah - LRA $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Piutang Retribusi $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Piutang Retribusi $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Diterima dimuka $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Diterima dimuka $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Retribusi Daerah - LO $thn</td>                        
					</tr>"; 		  

		$sql = "SELECT x.kd_skpd, x.nm_skpd, ISNULL(y.lra_pjk,0) lra_pjk, 
											 ISNULL(y.piutang_pjk,0) piutang_pjk, 
											 ISNULL(y.piutang_pjk_lalu,0) piutang_pjk_lalu, 
											 ISNULL(y.dimuka,0) dimuka, 
											 ISNULL(y.dimuka_lalu,0) dimuka_lalu 
				FROM (SELECT kd_skpd, nm_skpd FROM ms_skpd) x
					  LEFT JOIN
					 (SELECT kd_unit,
							 SUM(CASE WHEN jns=412 AND thn=$thn THEN nilai ELSE 0 END) AS lra_pjk, 
							 SUM(CASE WHEN jns=812 AND thn=$thn THEN nilai ELSE 0 END) AS piutang_pjk,
							 SUM(CASE WHEN jns=812 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS piutang_pjk_lalu, 
							 SUM(CASE WHEN jns=8121 AND kd_unit<>'3.13.01.17' AND thn=$thn THEN nilai ELSE 0 END) AS dimuka,
							 SUM(CASE WHEN jns=8121 AND kd_unit<>'3.13.01.17' AND thn=$cthnsbl THEN nilai ELSE 0 END) AS dimuka_lalu 
					  FROM (
						SELECT 812 jns, d.kd_unit, $cthnsbl thn, ISNULL(SUM(d.debet-d.kredit),0)*-1 nilai 
						FROM trhju_calk c INNER JOIN trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE LEFT(d.kd_rek5,5)='11302' AND YEAR(c.tgl_voucher)<='$cthnsbl'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 812 jns, d.kd_unit, $thn thn, ISNULL(SUM(d.debet-d.kredit),0) nilai 
						FROM trhju_calk c inner join trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE LEFT(d.kd_rek5,5)='11302' AND YEAR(c.tgl_voucher)<='$thn'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 412 jns, b.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,3)=412 AND YEAR(a.tgl_voucher)=$thn
						GROUP BY b.kd_unit 
						UNION ALL
						SELECT 8121 jns, d.kd_unit, $cthnsbl thn, ISNULL(SUM(d.kredit-d.debet),0) nilai 
						FROM trhju_calk c INNER JOIN trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE LEFT(d.kd_rek5,3)='214' AND YEAR(c.tgl_voucher)<='$cthnsbl'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 8121 jns, d.kd_unit, $thn thn, ISNULL(SUM(d.kredit-d.debet),0)*-1 nilai 
						FROM trhju_calk c inner join trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE LEFT(d.kd_rek5,3)='214' AND YEAR(c.tgl_voucher)<='$thn'
						GROUP BY d.kd_unit) p GROUP BY kd_unit 
					 ) y ON x.kd_skpd=y.kd_unit 
				WHERE lra_pjk<>0 OR piutang_pjk<>0 OR piutang_pjk_lalu<>0 OR dimuka<>0 OR dimuka_lalu<>0 
				ORDER BY kd_skpd";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$lra_pjk=$row->lra_pjk;
			$piutang_pjk=$row->piutang_pjk;
			$piutang_pjk_lalu=$row->piutang_pjk_lalu;
			$dimuka=$row->dimuka;
			$dimuka_lalu=$row->dimuka_lalu;
						
			$pjk_lo = $lra_pjk+$piutang_pjk+$piutang_pjk_lalu+$dimuka+$dimuka_lalu;
						
			IF($lra_pjk<0){$num_lra_pajak = $lra_pjk*-1; $a="("; $b=")";} ELSE { $num_lra_pajak = $lra_pjk; $a=""; $b="";}
			IF($piutang_pjk<0){$num_piutang_pjk = $piutang_pjk*-1; $c="("; $d=")";} ELSE { $num_piutang_pjk = $piutang_pjk; $c=""; $d="";}
			IF($piutang_pjk_lalu<0){$num_piutang_pjk_lalu = $piutang_pjk_lalu*-1; $e="("; $f=")";} ELSE { $num_piutang_pjk_lalu = $piutang_pjk_lalu; $e=""; $f="";}
			IF($dimuka<0){$num_dimuka = $dimuka*-1; $i="("; $j=")";} ELSE { $num_dimuka = $dimuka; $i=""; $j="";}
			IF($dimuka_lalu<0){$num_dimuka_lalu = $dimuka_lalu*-1; $k="("; $l=")";} ELSE { $num_dimuka_lalu = $dimuka_lalu; $k=""; $l="";}
			IF($pjk_lo<0){$num_pjk_lo = $pjk_lo*-1; $g="("; $h=")";} ELSE { $num_pjk_lo = $pjk_lo; $g=""; $h="";}
						
			$cRet .= "<tr>
						 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
						 <td align=\"right\" valign=\"top\">$a".number_format($num_lra_pajak,"2",",",".")."$b</td>                         
						 <td align=\"right\" valign=\"top\">$c".number_format($num_piutang_pjk,"2",",",".")."$d</td>                         
						 <td align=\"right\" valign=\"top\">$e".number_format($num_piutang_pjk_lalu,"2",",",".")."$f</td> 
						 <td align=\"right\" valign=\"top\">$i".number_format($num_dimuka,"2",",",".")."$j</td> 
						 <td align=\"right\" valign=\"top\">$k".number_format($num_dimuka_lalu,"2",",",".")."$l</td> 
						 <td align=\"right\" valign=\"top\">$g".number_format($num_pjk_lo,"2",",",".")."$h</td>
					</tr>"; 
		} 
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_RETRIBUSI");
        $this->template->set('title', 'LAPORAN CALK RETRIBUSI');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_calk_lo_814(){
		$ctk     = $this->uri->segment(3);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;

        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">LAPORAN CALK LAIN LAIN PAD LO</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Lain-lain PAD Yang Sah - LRA $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Piutang Lain-lain PAD yang Sah $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Piutang Lain-lain PAD yang Sah $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Piutang Bagi Hasil Pajak $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Piutang Bagi Hasil Pajak $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Piutang BLUD $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Piutang BLUD $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Lain-lain PAD Yang Sah - LO $thn</td>                        
					</tr>"; 		  

		$sql = "SELECT x.kd_skpd, x.nm_skpd, ISNULL(y.lra_lain,0) lra_lain, 
							 ISNULL(y.piutang_lain,0) piutang_lain, 
							 ISNULL(y.piutang_lain_lalu,0) piutang_lain_lalu,
							 ISNULL(y.piutang_bhp,0) piutang_bhp, 
							 ISNULL(y.piutang_bhp_lalu,0) piutang_bhp_lalu,
							 ISNULL(y.piutang_blud,0) piutang_blud, 
							 ISNULL(y.piutang_blud_lalu,0) piutang_blud_lalu
				FROM (SELECT kd_skpd, nm_skpd FROM ms_skpd) x
					  LEFT JOIN
					 (SELECT kd_unit,
							 SUM(CASE WHEN jns=414 AND thn=$thn THEN nilai ELSE 0 END) AS lra_lain, 
							 SUM(CASE WHEN jns=814 AND thn=$thn THEN nilai ELSE 0 END) AS piutang_lain,
							 SUM(CASE WHEN jns=814 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS piutang_lain_lalu,
							 SUM(CASE WHEN jns=8141 AND thn=$thn THEN nilai ELSE 0 END) AS piutang_bhp,
							 SUM(CASE WHEN jns=8141 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS piutang_bhp_lalu,
							 SUM(CASE WHEN jns=8142 AND thn=$thn THEN nilai ELSE 0 END) AS piutang_blud,
							 SUM(CASE WHEN jns=8142 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS piutang_blud_lalu
					  FROM (
						SELECT 814 jns, d.kd_unit, $cthnsbl thn, ISNULL(SUM(d.debet-d.kredit),0)*-1 nilai 
						FROM trhju_calk c INNER JOIN trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE (LEFT(d.kd_rek5,5)='11304' AND LEFT(d.kd_rek5,7)<>'1130411') AND YEAR(c.tgl_voucher)<='$cthnsbl'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 814 jns, d.kd_unit, $thn thn, ISNULL(SUM(d.debet-d.kredit),0) nilai 
						FROM trhju_calk c inner join trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE (LEFT(d.kd_rek5,5)='11304' AND LEFT(d.kd_rek5,7)<>'1130411') AND YEAR(c.tgl_voucher)<='$thn'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 8141 jns, d.kd_unit, $cthnsbl thn, ISNULL(SUM(d.debet-d.kredit),0)*-1 nilai 
						FROM trhju_calk c INNER JOIN trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE LEFT(d.kd_rek5,5)='11305' AND YEAR(c.tgl_voucher)<='$cthnsbl'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 8141 jns, d.kd_unit, $thn thn, ISNULL(SUM(d.debet-d.kredit),0) nilai 
						FROM trhju_calk c inner join trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE LEFT(d.kd_rek5,5)='11305' AND YEAR(c.tgl_voucher)<='$thn'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 8142 jns, d.kd_unit, $cthnsbl thn, ISNULL(SUM(d.debet-d.kredit),0)*-1 nilai 
						FROM trhju_calk c INNER JOIN trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE LEFT(d.kd_rek5,7)='1130411' AND YEAR(c.tgl_voucher)<='$cthnsbl'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 8142 jns, d.kd_unit, $thn thn, ISNULL(SUM(d.debet-d.kredit),0) nilai 
						FROM trhju_calk c inner join trdju_calk d 
						ON c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
						WHERE LEFT(d.kd_rek5,7)='1130411' AND YEAR(c.tgl_voucher)<='$thn'
						GROUP BY d.kd_unit
						UNION ALL
						SELECT 414 jns, b.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,3)=414 AND YEAR(a.tgl_voucher)=$thn
						GROUP BY b.kd_unit 
						) p GROUP BY kd_unit 
					 ) y ON x.kd_skpd=y.kd_unit 
				WHERE lra_lain<>0 OR piutang_lain<>0 OR piutang_lain_lalu<>0 OR piutang_blud<>0 OR piutang_blud_lalu<>0 
				ORDER BY kd_skpd";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$lra_lain=$row->lra_lain;
			$piutang_lain=$row->piutang_lain;
			$piutang_lain_lalu=$row->piutang_lain_lalu;
			$piutang_bhp=$row->piutang_bhp;
			$piutang_bhp_lalu=$row->piutang_bhp_lalu;
			$piutang_blud=$row->piutang_blud;
			$piutang_blud_lalu=$row->piutang_blud_lalu;
						
			$lain_lo = $lra_lain+$piutang_lain+$piutang_lain_lalu+$piutang_bhp+$piutang_bhp_lalu+$piutang_blud+$piutang_blud_lalu;
						
			IF($lra_lain<0){$num_lra_lain = $lra_lain*-1; $a="("; $b=")";} ELSE { $num_lra_lain = $lra_lain; $a=""; $b="";}
			IF($piutang_lain<0){$num_piutang_lain = $piutang_lain*-1; $c="("; $d=")";} ELSE { $num_piutang_lain = $piutang_lain; $c=""; $d="";}
			IF($piutang_lain_lalu<0){$num_piutang_lain_lalu = $piutang_lain_lalu*-1; $e="("; $f=")";} ELSE { $num_piutang_lain_lalu = $piutang_lain_lalu; $e=""; $f="";}
			IF($piutang_bhp<0){$num_piutang_bhp = $piutang_bhp*-1; $i="("; $j=")";} ELSE { $num_piutang_bhp = $piutang_bhp; $i=""; $j="";}
			IF($piutang_bhp_lalu<0){$num_piutang_bhp_lalu = $piutang_bhp_lalu*-1; $k="("; $l=")";} ELSE { $num_piutang_bhp_lalu = $piutang_bhp_lalu; $k=""; $l="";}
			IF($piutang_blud<0){$num_piutang_blud = $piutang_blud*-1; $g="("; $h=")";} ELSE { $num_piutang_blud = $piutang_blud; $g=""; $h="";}
			IF($piutang_blud_lalu<0){$num_piutang_blud_lalu = $piutang_blud_lalu*-1; $m="("; $n=")";} ELSE { $num_piutang_blud_lalu = $piutang_blud_lalu; $m=""; $n="";}
			
			IF($lain_lo<0){$num_lain_lo = $lain_lo*-1; $o="("; $p=")";} ELSE { $num_lain_lo = $lain_lo; $o=""; $p="";}
						
			$cRet .= "<tr>
						 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
						 <td align=\"right\" valign=\"top\">$a".number_format($num_lra_lain,"2",",",".")."$b</td>                         
						 <td align=\"right\" valign=\"top\">$c".number_format($num_piutang_lain,"2",",",".")."$d</td>                         
						 <td align=\"right\" valign=\"top\">$e".number_format($num_piutang_lain_lalu,"2",",",".")."$f</td> 
						 <td align=\"right\" valign=\"top\">$i".number_format($num_piutang_bhp,"2",",",".")."$j</td> 
						 <td align=\"right\" valign=\"top\">$k".number_format($num_piutang_bhp_lalu,"2",",",".")."$l</td> 
						 <td align=\"right\" valign=\"top\">$g".number_format($num_piutang_blud,"2",",",".")."$h</td>
						 <td align=\"right\" valign=\"top\">$m".number_format($num_piutang_blud_lalu,"2",",",".")."$n</td>
						 <td align=\"right\" valign=\"top\">$o".number_format($num_lain_lo,"2",",",".")."$p</td>
					</tr>"; 
		} 
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_LAIN");
        $this->template->set('title', 'LAPORAN CALK LAIN');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_calk_lpe(){
		$ctk     = $this->uri->segment(3);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;

        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">LAPORAN CALK LPE LAIN LAIN</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Penyisihan Piutang</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Koreksi Penyusutan</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Hibah Keluar</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Mutasi Masuk Aset OPD</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Mutasi Keluar Aset OPD</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Penghapusan Persediaan APBN</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Perubahan Kode Rekening</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Koreksi Tanah</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Koreksi Utang Belanja</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Reklass Antar Akun</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Tagihan Penjualan Angsuran</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Penyertaan Modal</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Persediaan APBN yang belum</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Aset peralatan dan mesin reklas ke persediaan lain-lain</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Koreksi Dana Transfer Pemerintah Pusat</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Koreksi Gedung dan Bangunan</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Koreksi Persediaan</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Koreksi Kas</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Total</td>                        
					</tr>"; 		  

		$sql = "SELECT x.kd_skpd, x.nm_skpd, ISNULL(y.peny_piutang,0) peny_piutang,
							 ISNULL(y.koreksi_peny,0) koreksi_peny, 
							 ISNULL(y.hibah_kel,0) hibah_kel, 
							 ISNULL(y.mutasi_masuk,0) mutasi_masuk,
							 ISNULL(y.mutasi_kel,0) mutasi_kel,
							 ISNULL(y.hapus_pers,0) hapus_pers,
							 ISNULL(y.ubah_kode,0) ubah_kode,
							 ISNULL(y.koreksi_tanah,0) koreksi_tanah,
							 ISNULL(y.koreksi_utang,0) koreksi_utang, 
							 ISNULL(y.reklas_akun,0) reklas_akun,
							 ISNULL(y.tagihan,0) tagihan,
							 ISNULL(y.peny_modal,0) peny_modal,
							 ISNULL(y.persediaan_apbn,0) persediaan_apbn,
							 ISNULL(y.aset_peralatan,0) aset_peralatan,
							 ISNULL(y.koreksi_dana,0) koreksi_dana,
							 ISNULL(y.koreksi_gedung,0) koreksi_gedung,
							 ISNULL(y.koreksi_persediaan,0) koreksi_persediaan,
							 ISNULL(y.koreksi_kas,0) koreksi_kas
				FROM (SELECT kd_skpd, nm_skpd FROM ms_skpd) x
				LEFT JOIN
				(
				SELECT kd_unit,
					 SUM(CASE WHEN jns=331 AND thn=$thn THEN nilai ELSE 0 END) AS peny_piutang, 
					 SUM(CASE WHEN jns=332 AND thn=$thn THEN nilai ELSE 0 END) AS koreksi_peny, 
					 SUM(CASE WHEN jns=333 AND thn=$thn THEN nilai ELSE 0 END) AS hibah_kel,
					 SUM(CASE WHEN jns=334 AND thn=$thn THEN nilai ELSE 0 END) AS mutasi_masuk,
					 SUM(CASE WHEN jns=335 AND thn=$thn THEN nilai ELSE 0 END) AS mutasi_kel,
					 SUM(CASE WHEN jns=336 AND thn=$thn THEN nilai ELSE 0 END) AS hapus_pers,
					 SUM(CASE WHEN jns=337 AND thn=$thn THEN nilai ELSE 0 END) AS ubah_kode,
					 SUM(CASE WHEN jns=338 AND thn=$thn THEN nilai ELSE 0 END) AS koreksi_tanah,
					 SUM(CASE WHEN jns=339 AND thn=$thn THEN nilai ELSE 0 END) AS koreksi_utang,
					 SUM(CASE WHEN jns=3310 AND thn=$thn THEN nilai ELSE 0 END) AS reklas_akun,
					 SUM(CASE WHEN jns=3311 AND thn=$thn THEN nilai ELSE 0 END) AS tagihan,
					 SUM(CASE WHEN jns=3312 AND thn=$thn THEN nilai ELSE 0 END) AS peny_modal,
					 SUM(CASE WHEN jns=3313 AND thn=$thn THEN nilai ELSE 0 END) AS persediaan_apbn,
					 SUM(CASE WHEN jns=3314 AND thn=$thn THEN nilai ELSE 0 END) AS aset_peralatan,
					 SUM(CASE WHEN jns=3315 AND thn=$thn THEN nilai ELSE 0 END) AS koreksi_dana,
					 SUM(CASE WHEN jns=3316 AND thn=$thn THEN nilai ELSE 0 END) AS koreksi_gedung,
					 SUM(CASE WHEN jns=3317 AND thn=$thn THEN nilai ELSE 0 END) AS koreksi_persediaan, 
					 SUM(CASE WHEN jns=3318 AND thn=$thn THEN nilai ELSE 0 END) AS koreksi_kas 
				FROM (
				SELECT 331 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='1' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 332 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='2' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 333 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='3' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 334 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='4' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 335 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='5' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 336 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='6' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 337 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='7' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 338 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='8' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 339 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='9' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 3310 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='10' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 3311 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='11' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 3312 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='12' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 3313 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='13' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 3314 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='14' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 3315 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='15' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 3316 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='16' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 3317 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='17' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit
				UNION ALL
				SELECT 3318 jns, a.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai
				FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				WHERE kd_rek5='3110101' AND reev='3' AND tgl_real='18' AND YEAR(tgl_voucher)='$thn'
				GROUP BY a.kd_unit) p GROUP BY kd_unit ) y ON x.kd_skpd=y.kd_unit 
				WHERE peny_piutang<>0 OR koreksi_peny<>0 OR hibah_kel<>0 OR mutasi_masuk<>0 OR mutasi_kel<>0 OR hapus_pers<>0 OR ubah_kode<>0 OR koreksi_tanah<>0 OR koreksi_utang<>0 OR reklas_akun<>0 OR tagihan<>0 OR peny_modal<>0 OR persediaan_apbn<>0 OR aset_peralatan<>0 OR koreksi_dana<>0 OR koreksi_gedung<>0 OR koreksi_persediaan<>0
				ORDER BY kd_skpd";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$peny_piutang=$row->peny_piutang;
			$koreksi_peny=$row->koreksi_peny;
			$hibah_kel=$row->hibah_kel;
			$mutasi_masuk=$row->mutasi_masuk;
			$mutasi_kel=$row->mutasi_kel;
			$hapus_pers=$row->hapus_pers;
			$ubah_kode=$row->ubah_kode;
			$koreksi_tanah=$row->koreksi_tanah;
			$koreksi_utang=$row->koreksi_utang;
			$reklas_akun=$row->reklas_akun;
			$tagihan=$row->tagihan;
			$peny_modal=$row->peny_modal;
			$persediaan_apbn=$row->persediaan_apbn;
			$aset_peralatan=$row->aset_peralatan;
			$koreksi_dana=$row->koreksi_dana;
			$koreksi_gedung=$row->koreksi_gedung;
			$koreksi_persediaan=$row->koreksi_persediaan;
			$koreksi_kas=$row->koreksi_kas;
						
			$tot_lain = $peny_piutang+$koreksi_peny+$hibah_kel+$mutasi_masuk+$mutasi_kel+$hapus_pers+$ubah_kode+$koreksi_tanah+$koreksi_utang+$reklas_akun+$tagihan+$peny_modal+$persediaan_apbn+$aset_peralatan+$koreksi_dana+$koreksi_gedung+$koreksi_persediaan+$koreksi_kas;
						
			IF($peny_piutang<0){$num_peny_piutang = $peny_piutang*-1; $a="("; $b=")";} ELSE { $num_peny_piutang = $peny_piutang; $a=""; $b="";}
			IF($koreksi_peny<0){$num_koreksi_peny = $koreksi_peny*-1; $c="("; $d=")";} ELSE { $num_koreksi_peny = $koreksi_peny; $c=""; $d="";}
			IF($hibah_kel<0){$num_hibah_kel = $hibah_kel*-1; $e="("; $f=")";} ELSE { $num_hibah_kel = $hibah_kel; $e=""; $f="";}
			IF($mutasi_masuk<0){$num_mutasi_masuk = $mutasi_masuk*-1; $g="("; $h=")";} ELSE { $num_mutasi_masuk = $mutasi_masuk; $g=""; $h="";}
			IF($mutasi_kel<0){$num_mutasi_kel = $mutasi_kel*-1; $i="("; $j=")";} ELSE { $num_mutasi_kel = $mutasi_kel; $i=""; $j="";}
			IF($hapus_pers<0){$num_hapus_pers = $hapus_pers*-1; $k="("; $l=")";} ELSE { $num_hapus_pers = $hapus_pers; $k=""; $l="";}
			IF($ubah_kode<0){$num_ubah_kode = $ubah_kode*-1; $m="("; $n=")";} ELSE { $num_ubah_kode = $ubah_kode; $m=""; $n="";}
			IF($koreksi_tanah<0){$num_koreksi_tanah = $koreksi_tanah*-1; $o="("; $p=")";} ELSE { $num_koreksi_tanah = $koreksi_tanah; $o=""; $p="";}
			IF($koreksi_utang<0){$num_koreksi_utang = $koreksi_utang*-1; $q="("; $r=")";} ELSE { $num_koreksi_utang = $koreksi_utang; $q=""; $r="";}
			IF($reklas_akun<0){$num_reklas_akun = $reklas_akun*-1; $s="("; $t=")";} ELSE { $num_reklas_akun = $reklas_akun; $s=""; $t="";}
			IF($tagihan<0){$num_tagihan = $tagihan*-1; $u="("; $v=")";} ELSE { $num_tagihan = $tagihan; $u=""; $v="";}
			IF($peny_modal<0){$num_peny_modal = $peny_modal*-1; $w="("; $x=")";} ELSE { $num_peny_modal = $peny_modal; $w=""; $x="";}
			IF($persediaan_apbn<0){$num_persediaan_apbn = $persediaan_apbn*-1; $y="("; $z=")";} ELSE { $num_persediaan_apbn = $persediaan_apbn; $y=""; $z="";}
			IF($aset_peralatan<0){$num_aset_peralatan = $aset_peralatan*-1; $aa="("; $bb=")";} ELSE { $num_aset_peralatan = $aset_peralatan; $aa=""; $bb="";}
			IF($koreksi_dana<0){$num_koreksi_dana = $koreksi_dana*-1; $cc="("; $dd=")";} ELSE { $num_koreksi_dana = $koreksi_dana; $cc=""; $dd="";}
			IF($koreksi_gedung<0){$num_koreksi_gedung = $koreksi_gedung*-1; $ee="("; $ff=")";} ELSE { $num_koreksi_gedung = $koreksi_gedung; $ee=""; $ff="";}
			IF($koreksi_persediaan<0){$num_koreksi_persediaan = $koreksi_persediaan*-1; $gg="("; $hh=")";} ELSE { $num_koreksi_persediaan = $koreksi_persediaan; $gg=""; $hh="";}
			IF($koreksi_kas<0){$num_koreksi_kas = $koreksi_kas*-1; $kk="("; $ll=")";} ELSE { $num_koreksi_kas = $koreksi_kas; $kk=""; $ll="";}
			IF($tot_lain<0){$num_tot_lain = $tot_lain*-1; $ii="("; $jj=")";} ELSE { $num_tot_lain = $tot_lain; $ii=""; $jj="";}
			
			$cRet .= "<tr>
						 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
						 <td align=\"right\" valign=\"top\">$a".number_format($num_peny_piutang,"2",",",".")."$b</td>                         
						 <td align=\"right\" valign=\"top\">$c".number_format($num_koreksi_peny,"2",",",".")."$d</td>                         
						 <td align=\"right\" valign=\"top\">$e".number_format($num_hibah_kel,"2",",",".")."$f</td> 
						 <td align=\"right\" valign=\"top\">$g".number_format($num_mutasi_masuk,"2",",",".")."$h</td>
						 <td align=\"right\" valign=\"top\">$i".number_format($num_mutasi_kel,"2",",",".")."$j</td>
						 <td align=\"right\" valign=\"top\">$k".number_format($num_hapus_pers,"2",",",".")."$l</td>
						 <td align=\"right\" valign=\"top\">$m".number_format($num_ubah_kode,"2",",",".")."$n</td>
						 <td align=\"right\" valign=\"top\">$o".number_format($num_koreksi_tanah,"2",",",".")."$p</td>
						 <td align=\"right\" valign=\"top\">$q".number_format($num_koreksi_utang,"2",",",".")."$r</td>
						 <td align=\"right\" valign=\"top\">$s".number_format($num_reklas_akun,"2",",",".")."$t</td>
						 <td align=\"right\" valign=\"top\">$u".number_format($num_tagihan,"2",",",".")."$v</td>
						 <td align=\"right\" valign=\"top\">$w".number_format($num_peny_modal,"2",",",".")."$x</td>
						 <td align=\"right\" valign=\"top\">$y".number_format($num_persediaan_apbn,"2",",",".")."$z</td>
						 <td align=\"right\" valign=\"top\">$aa".number_format($num_aset_peralatan,"2",",",".")."$bb</td>
						 <td align=\"right\" valign=\"top\">$cc".number_format($num_koreksi_dana,"2",",",".")."$dd</td>
						 <td align=\"right\" valign=\"top\">$ee".number_format($num_koreksi_gedung,"2",",",".")."$ff</td>
						 <td align=\"right\" valign=\"top\">$gg".number_format($num_koreksi_persediaan,"2",",",".")."$hh</td>
						 <td align=\"right\" valign=\"top\">$kk".number_format($num_koreksi_kas,"2",",",".")."$ll</td>
						 <td align=\"right\" valign=\"top\">$ii".number_format($num_tot_lain,"2",",",".")."$jj</td>
					</tr>"; 
		} 
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_LPE_LAIN");
        $this->template->set('title', 'LAPORAN CALK LPE LAIN');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_calk_beban_lain(){
		$ctk     = $this->uri->segment(3);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;

        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">PEMERINTAH PROVINSI KALIMANTAN BARAT</td>      
                  </tr>
				   <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">LAPORAN BEBAN LAIN-LAIN TAHUN ANGGARAN $thn</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">&nbsp;</td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Persediaan Lain-Lain</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Penyisihan Piutang</td>                        
					</tr>"; 		  

		$sql = "SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=z.kd_skpd) nm_skpd, ISNULL(SUM(persediaan_lain),0) persediaan_lain, ISNULL(SUM(penyi_piu),0) penyi_piu
				FROM (
				SELECT kd_skpd, sal_awal-kurang+tambah+tahun_n persediaan_lain, 0 penyi_piu
				FROM (
				SELECT kd_skpd, SUM(sal_awal) sal_awal, SUM(kurang) kurang, SUM(tambah) tambah, 
				SUM(tahun_n) tahun_n, sum(isnull(korplus,0)-isnull(kormin,0)) koreksi 
				FROM lamp_aset 
				WHERE kd_rek3 = '117' AND kd_rek5='1170302' 
				GROUP BY kd_skpd ) x
				UNION ALL
				select kd_skpd, 0 persediaan_lain, sum(penyi_piu) penyi_piu
				from (select kd_skpd, 
				case when (left(kode1,5)=11301 or kode1=1130405) and umur_t=1 and isnull(umur_b,1)=0 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.005 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t=0 and isnull(umur_b,1)>=1 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.005 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t=1 and isnull(umur_b,1)>=1 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.1 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t=2 and isnull(umur_b,1)=0 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.1 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t=2 and isnull(umur_b,1)>=1 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.5 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t=3 and isnull(umur_b,1)=0 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.5 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t=3 and isnull(umur_b,1)>=1 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.5 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t=4 and isnull(umur_b,1)=0 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.5 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t=4 and isnull(umur_b,1)>=1 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.5 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t=5 and isnull(umur_b,1)=0 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.5 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t=5 and isnull(umur_b,1)>=1 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 1 as decimal(20,2))
				when (left(kode1,5)=11301 or kode1=1130405) and umur_t>=6 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 1 as decimal(20,2))
				when (left(kode1,5)=11302 or kode1 in (1130406,1130410)) and umur_t<1 and isnull(umur_b,1)<=1 then
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.005 as decimal(20,2))
				when (left(kode1,5)=11302 or kode1 in (1130406,1130410)) and umur_t<1 and isnull(umur_b,1)>1 and isnull(umur_b,1)<=3 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.1 as decimal(20,2))
				when (left(kode1,5)=11302 or kode1 in (1130406,1130410)) and umur_t<1 and isnull(umur_b,1)>3 and isnull(umur_b,1)<=12 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi)* 0.5 as decimal(20,2))
				when (left(kode1,5)=11302 or kode1 in (1130406,1130410)) and umur_t>=1 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 1 as decimal(20,2))
				when kode1=1130407 then 0
				when (left(kode1,5) not in (11301,11302) or kode1 not in (1130405,1130406,1130410,1130407)) and umur_t=0 and isnull(umur_b,1)=0 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.005 as decimal(20,2))
				when (left(kode1,5) not in (11301,11302) or kode1 not in (1130405,1130406,1130410,1130407)) and umur_t=0 and isnull(umur_b,1)=1 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 0.1 as decimal(20,2))
				when (left(kode1,5) not in (11301,11302) or kode1 not in (1130405,1130406,1130410,1130407)) and umur_t=0 and isnull(umur_b,1)=2 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi)* 0.5 as decimal(20,2))
				when (left(kode1,5) not in (11301,11302) or kode1 not in (1130405,1130406,1130410,1130407)) and umur_t=0 and isnull(umur_b,1)>=3 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 1 as decimal(20,2))
				when (left(kode1,5) not in (11301,11302) or kode1 not in (1130405,1130406,1130410,1130407)) and umur_t>=1 then 
				cast((sal_awal-kurang+tambah+tahun_n+koreksi) * 1 as decimal(20,2))
				else 'Tidak Diketahui' end as penyi_piu 
				from
				(SELECT kd_skpd, no_lamp, kd_rek5 as kode1, kd_rek5 as kode, nm_rek5 as nama, lokasi, tahun, isnull(bulan,1) bulan, jumlah,   
				sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, keterangan, case when 12+1-isnull(bulan,1)=12 then $thn-tahun+1 else $thn-tahun end 
				as umur_t, case when 12+1-isnull(bulan,1)=12 then 0 else 12+1-isnull(bulan,1) end as umur_b FROM lamp_aset where kd_rek3 
				in (113) and left(kd_rek5,5) not in ('11307') and tahun<= $thn) a) a
				GROUP BY kd_skpd) z
				GROUP BY kd_skpd
				ORDER BY kd_skpd";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$persediaan_lain=$row->persediaan_lain;
			$penyi_piu=$row->penyi_piu;
			
						
			IF($persediaan_lain<0){$num_persediaan_lain = $persediaan_lain*-1; $a="("; $b=")";} ELSE { $num_persediaan_lain = $persediaan_lain; $a=""; $b="";}
			IF($penyi_piu<0){$num_penyi_piu = $penyi_piu*-1; $c="("; $d=")";} ELSE { $num_penyi_piu = $penyi_piu; $c=""; $d="";}
			
			$cRet .= "<tr>
						 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
						 <td align=\"right\" valign=\"top\">$a".number_format($num_persediaan_lain,"2",",",".")."$b</td>                         
						 <td align=\"right\" valign=\"top\">$c".number_format($num_penyi_piu,"2",",",".")."$d</td>                         
					</tr>"; 
		} 
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_LPE_BEBAN_LAIN");
        $this->template->set('title', 'LAPORAN CALK LPE BEBAN LAIN');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	
	function cetak_lap_calk_beban_911(){
		$ctk     = $this->uri->segment(3);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;

        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">LAPORAN CALK BEBAN PEGAWAI</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Pegawai - LRA $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Pegawai Penambah Kapitalisasi Aset $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Utang Pegawai $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Utang Pegawai $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Pegawai - LO $thn</td>                        
					</tr>"; 		  

		$sql = "SELECT x.kd_skpd, x.nm_skpd, ISNULL(y.lra_peg,0) lra_peg,
							 ISNULL(y.peg_kapit,0) peg_kapit, 
							 ISNULL(y.utang_peg,0) utang_peg, 
							 ISNULL(y.utang_peg_lalu,0) utang_peg_lalu 
				FROM (SELECT kd_skpd, nm_skpd FROM ms_skpd) x
					  LEFT JOIN
					 (SELECT kd_unit,
							 SUM(CASE WHEN jns=511 AND thn=$thn THEN nilai ELSE 0 END) AS lra_peg, 
							 SUM(CASE WHEN jns=9111 AND thn=$thn THEN nilai ELSE 0 END) AS peg_kapit, 
							 SUM(CASE WHEN jns=911 AND thn=$thn THEN nilai ELSE 0 END) AS utang_peg,
							 SUM(CASE WHEN jns=911 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS utang_peg_lalu 
					  FROM (
						SELECT 9111 jns, a.kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai_trans),0)*-1 nilai
						FROM trkapitalisasi a INNER JOIN ms_rek5 b ON a.kd_rek5=b.kd_rek5 
						WHERE jenis<>'X' AND nilai_trans<>0 AND LEFT(b.map_lo,3)='911'
						GROUP BY a.kd_skpd
						UNION ALL
						SELECT 911 jns, b.kd_unit, $cthnsbl thn, ISNULL(SUM(kredit-debet),0)*-1 nilai
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,5) IN ('21501') AND YEAR(tgl_voucher)<='$cthnsbl'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 911 jns, b.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,5) IN ('21501') AND YEAR(tgl_voucher)<='$thn'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 511 jns, b.kd_unit, $thn thn, ISNULL(SUM(b.debet-b.kredit),0) nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,3) IN ('511') AND YEAR(tgl_voucher)='$thn' 
						GROUP BY b.kd_unit) p GROUP BY kd_unit 
					  ) y ON x.kd_skpd=y.kd_unit 
				WHERE lra_peg<>0 OR peg_kapit<>0 OR utang_peg<>0 OR utang_peg_lalu<>0 
				ORDER BY kd_skpd";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$lra_peg=$row->lra_peg;
			$peg_kapit=$row->peg_kapit;
			$utang_peg=$row->utang_peg;
			$utang_peg_lalu=$row->utang_peg_lalu;
						
			$peg_lo = $lra_peg+$peg_kapit+$utang_peg+$utang_peg_lalu;
						
			IF($lra_peg<0){$num_lra_peg = $lra_peg*-1; $a="("; $b=")";} ELSE { $num_lra_peg = $lra_peg; $a=""; $b="";}
			IF($peg_kapit<0){$num_peg_kapit = $peg_kapit*-1; $c="("; $d=")";} ELSE { $num_peg_kapit = $peg_kapit; $c=""; $d="";}
			IF($utang_peg<0){$num_utang_peg = $utang_peg*-1; $e="("; $f=")";} ELSE { $num_utang_peg = $utang_peg; $e=""; $f="";}
			IF($utang_peg_lalu<0){$num_utang_peg_lalu = $utang_peg_lalu*-1; $g="("; $h=")";} ELSE { $num_utang_peg_lalu = $utang_peg_lalu; $g=""; $h="";}
			IF($peg_lo<0){$num_peg_lo = $peg_lo*-1; $i="("; $j=")";} ELSE { $num_peg_lo = $peg_lo; $i=""; $j="";}
						
			$cRet .= "<tr>
						 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
						 <td align=\"right\" valign=\"top\">$a".number_format($num_lra_peg,"2",",",".")."$b</td>                         
						 <td align=\"right\" valign=\"top\">$c".number_format($num_peg_kapit,"2",",",".")."$d</td>                         
						 <td align=\"right\" valign=\"top\">$e".number_format($num_utang_peg,"2",",",".")."$f</td> 
						 <td align=\"right\" valign=\"top\">$g".number_format($num_utang_peg_lalu,"2",",",".")."$h</td>
						 <td align=\"right\" valign=\"top\">$i".number_format($num_peg_lo,"2",",",".")."$j</td>
					</tr>"; 
		} 
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_PEGAWAI");
        $this->template->set('title', 'LAPORAN CALK PEGAWAI');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_calk_beban_912(){
		//--pindah
		$sql51 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=5";
        $hasil51 = $this->db->query($sql51);
		foreach ($hasil51->result() as $row)
        {
			$kd_rek51 = $row->kd_rek;			
		}
		
		$sql91 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=9";
        $hasil91 = $this->db->query($sql91);
		foreach ($hasil91->result() as $row)
        {
			$kd_rek91 = $row->kd_rek;			
		}
		
		$sql21 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=2";
        $hasil21 = $this->db->query($sql21);
		foreach ($hasil21->result() as $row)
        {
			$kd_rek21 = $row->kd_rek;			
		}
		
		$sql52 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=5";
        $hasil52 = $this->db->query($sql52);
		foreach ($hasil52->result() as $row)
        {
			$kd_rek52 = $row->kd_rek;			
		}
		
		$sql92 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=9";
        $hasil92 = $this->db->query($sql92);
		foreach ($hasil92->result() as $row)
        {
			$kd_rek92 = $row->kd_rek;			
		}
		
		$sql22 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=2";
        $hasil22 = $this->db->query($sql22);
		foreach ($hasil22->result() as $row)
        {
			$kd_rek22 = $row->kd_rek;			
		}
		
		$sql53 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=5";
        $hasil53 = $this->db->query($sql53);
		foreach ($hasil53->result() as $row)
        {
			$kd_rek53 = $row->kd_rek;			
		}
		
		$sql93 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=9";
        $hasil93 = $this->db->query($sql93);
		foreach ($hasil93->result() as $row)
        {
			$kd_rek93 = $row->kd_rek;			
		}
		
		$sql23 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=2";
        $hasil23 = $this->db->query($sql23);
		foreach ($hasil23->result() as $row)
        {
			$kd_rek23 = $row->kd_rek;			
		}
		
		$sql54 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=5";
        $hasil54 = $this->db->query($sql54);
		foreach ($hasil54->result() as $row)
        {
			$kd_rek54 = $row->kd_rek;			
		}
		
		$sql94 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=9";
        $hasil94 = $this->db->query($sql94);
		foreach ($hasil94->result() as $row)
        {
			$kd_rek94 = $row->kd_rek;			
		}
		
		$sql24 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=2";
        $hasil24 = $this->db->query($sql24);
		foreach ($hasil24->result() as $row)
        {
			$kd_rek24 = $row->kd_rek;			
		}
		//--akhir
			
		
		$ctk     = $this->uri->segment(3);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;

        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">LAPORAN CALK BEBAN BARANG JASA</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Barang Jasa - LRA $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Barang dibayar dimuka $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Barang dibayar dimuka $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Jasa dibayar dimuka $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Jasa dibayar dimuka $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Utang Barang dan Jasa $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Utang Barang dan Jasa $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Belanja Modal yang tidak diakui sebagai aset tetap</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Belanja Barang dan Jasa sebagai penambah kapitalisasi aset</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Belanja barang dan jasa BLUD</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Barang dan Jasa - LO</td>                        
					</tr>"; 		  

		$sql = "SELECT x.kd_skpd, x.nm_skpd, ISNULL(y.brgjsa_lra,0) brgjsa_lra,
							 ISNULL(y.beban_dimuka,0) beban_dimuka,
							 ISNULL(y.beban_dimuka_lalu,0) beban_dimuka_lalu, 
							 ISNULL(y.beban_jasa,0) beban_jasa, 
							 ISNULL(y.beban_jasa_lalu,0) beban_jasa_lalu,
							 ISNULL(y.utang_brg_jasa,0) utang_brg_jasa, 
							 ISNULL(y.utang_brg_jasa_lalu,0) utang_brg_jasa_lalu,
							 ISNULL(y.bm_tdk_aset_ttp,0) bm_tdk_aset_ttp,
							 ISNULL(y.brg_jsa_tmbh_kapit,0) brg_jsa_tmbh_kapit,
							 ISNULL(y.brg_jsa_blud,0) brg_jsa_blud
				FROM (SELECT kd_skpd, nm_skpd FROM ms_skpd) x
					  LEFT JOIN
					 (SELECT kd_unit, 
							 SUM(CASE WHEN jns=512 AND thn=$thn THEN nilai ELSE 0 END) AS brgjsa_lra,
							 SUM(CASE WHEN jns=912 AND thn=$thn THEN nilai ELSE 0 END) AS beban_dimuka,
							 SUM(CASE WHEN jns=912 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS beban_dimuka_lalu,
							 SUM(CASE WHEN jns=9121 AND thn=$thn THEN nilai ELSE 0 END) AS beban_jasa,
							 SUM(CASE WHEN jns=9121 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS beban_jasa_lalu, 
							 SUM(CASE WHEN jns=9122 AND thn=$thn THEN nilai ELSE 0 END) AS utang_brg_jasa,
							 SUM(CASE WHEN jns=9122 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS utang_brg_jasa_lalu,
							 SUM(CASE WHEN jns=9123 AND thn=$thn THEN nilai ELSE 0 END) AS bm_tdk_aset_ttp,
							 SUM(CASE WHEN jns=9124 AND thn=$thn THEN nilai ELSE 0 END) AS brg_jsa_tmbh_kapit,
							 SUM(CASE WHEN jns=9125 AND thn=$thn THEN nilai ELSE 0 END) AS brg_jsa_blud  
					  FROM (
						SELECT 512 jns, b.kd_unit, $thn thn, SUM(b.debet-b.kredit) nilai
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE b.kd_rek5 IN ($kd_rek51) 
						AND YEAR(tgl_voucher)='$thn'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 912 jns, b.kd_unit, $cthnsbl thn, ISNULL(SUM(debet-kredit),0)*-1 nilai
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,5) IN ('11602') AND YEAR(tgl_voucher)<='$cthnsbl'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 912 jns, b.kd_unit, $thn thn, ISNULL(SUM(debet-kredit),0) nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,5) IN ('11602') AND YEAR(tgl_voucher)<='$thn'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 9121 jns, b.kd_unit, $cthnsbl thn, ISNULL(SUM(debet-kredit),0) nilai
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,5) IN ('11603') AND YEAR(tgl_voucher)<='$cthnsbl'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 9121 jns, b.kd_unit, $thn thn, ISNULL(SUM(debet-kredit),0)*-1 nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,5) IN ('11603') AND YEAR(tgl_voucher)<='$thn'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 9122 jns, b.kd_unit, $cthnsbl thn, ISNULL(SUM(kredit-debet),0)*-1 nilai
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE b.kd_rek5 IN ($kd_rek21) AND YEAR(tgl_voucher)<='$cthnsbl'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 9122 jns, b.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE b.kd_rek5 IN ($kd_rek21) AND YEAR(tgl_voucher)<='$thn'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 9123 jns, kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai),0) nilai
						FROM nilai_beban_calk WHERE kd_rek IN ('9127')
						GROUP BY kd_skpd
						UNION ALL
						SELECT 9124 jns, kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai),0) nilai
						FROM nilai_beban_calk WHERE kd_rek IN ('9128')
						GROUP BY kd_skpd
						UNION ALL
						SELECT 9125 jns, b.kd_unit, $thn thn, ISNULL(SUM(0),0) nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE b.kd_rek5 IN ('5122003') AND YEAR(tgl_voucher)='$thn'
						GROUP BY b.kd_unit) p GROUP BY kd_unit 
					  ) y ON x.kd_skpd=y.kd_unit 
				WHERE brgjsa_lra<>0 OR beban_dimuka<>0 OR beban_dimuka_lalu<>0 OR beban_jasa<>0 OR beban_jasa_lalu<>0 OR utang_brg_jasa<>0 OR utang_brg_jasa_lalu<>0 OR bm_tdk_aset_ttp<>0 OR brg_jsa_tmbh_kapit<>0 OR brg_jsa_blud<>0 
				ORDER BY kd_skpd";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$brgjsa_lra=$row->brgjsa_lra;
			$beban_dimuka=$row->beban_dimuka;
			$beban_dimuka_lalu=$row->beban_dimuka_lalu;
			$beban_jasa=$row->beban_jasa;
			$beban_jasa_lalu=$row->beban_jasa_lalu;
			$utang_brg_jasa=$row->utang_brg_jasa;
			$utang_brg_jasa_lalu=$row->utang_brg_jasa_lalu;
			$bm_tdk_aset_ttp=$row->bm_tdk_aset_ttp;
			$brg_jsa_tmbh_kapit=$row->brg_jsa_tmbh_kapit;
			$brg_jsa_blud=$row->brg_jsa_blud;
						
			$brgjsa_lo = $brgjsa_lra+$beban_dimuka+$beban_dimuka_lalu+$beban_jasa+$beban_jasa_lalu+$utang_brg_jasa+$utang_brg_jasa_lalu+$bm_tdk_aset_ttp+$brg_jsa_tmbh_kapit+$brg_jsa_blud;
						
			IF($brgjsa_lra<0){$num_brgjsa_lra = $brgjsa_lra*-1; $a="("; $b=")";} ELSE { $num_brgjsa_lra = $brgjsa_lra; $a=""; $b="";}
			IF($beban_dimuka<0){$num_beban_dimuka = $beban_dimuka*-1; $c="("; $d=")";} ELSE { $num_beban_dimuka = $beban_dimuka; $c=""; $d="";}
			IF($beban_dimuka_lalu<0){$num_beban_dimuka_lalu = $beban_dimuka_lalu*-1; $e="("; $f=")";} ELSE { $num_beban_dimuka_lalu = $beban_dimuka_lalu; $e=""; $f="";}
			IF($beban_jasa<0){$num_beban_jasa = $beban_jasa*-1; $g="("; $h=")";} ELSE { $num_beban_jasa = $beban_jasa; $g=""; $h="";}
			IF($beban_jasa_lalu<0){$num_beban_jasa_lalu = $beban_jasa_lalu*-1; $i="("; $j=")";} ELSE { $num_beban_jasa_lalu = $beban_jasa_lalu; $i=""; $j="";}
			IF($utang_brg_jasa<0){$num_utang_brg_jasa = $utang_brg_jasa*-1; $k="("; $l=")";} ELSE { $num_utang_brg_jasa = $utang_brg_jasa; $k=""; $l="";}
			IF($utang_brg_jasa_lalu<0){$num_utang_brg_jasa_lalu = $utang_brg_jasa_lalu*-1; $m="("; $n=")";} ELSE { $num_utang_brg_jasa_lalu = $utang_brg_jasa_lalu; $m=""; $n="";}
			IF($bm_tdk_aset_ttp<0){$num_bm_tdk_aset_ttp = $bm_tdk_aset_ttp*-1; $o="("; $p=")";} ELSE { $num_bm_tdk_aset_ttp = $bm_tdk_aset_ttp; $o=""; $p="";}
			IF($brg_jsa_tmbh_kapit<0){$num_brg_jsa_tmbh_kapit = $brg_jsa_tmbh_kapit*-1; $q="("; $r=")";} ELSE { $num_brg_jsa_tmbh_kapit = $brg_jsa_tmbh_kapit; $q=""; $r="";}
			IF($brg_jsa_blud<0){$num_brg_jsa_blud = $brg_jsa_blud*-1; $s="("; $t=")";} ELSE { $num_brg_jsa_blud = $brg_jsa_blud; $s=""; $t="";}
			IF($brgjsa_lo<0){$num_brgjsa_lo = $brgjsa_lo*-1; $u="("; $v=")";} ELSE { $num_brgjsa_lo = $brgjsa_lo; $u=""; $v="";}
						
			$cRet .= "<tr>
						 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
						 <td align=\"right\" valign=\"top\">$a".number_format($num_brgjsa_lra,"2",",",".")."$b</td>                         
						 <td align=\"right\" valign=\"top\">$c".number_format($num_beban_dimuka,"2",",",".")."$d</td>                         
						 <td align=\"right\" valign=\"top\">$e".number_format($num_beban_dimuka_lalu,"2",",",".")."$f</td> 
						 <td align=\"right\" valign=\"top\">$g".number_format($num_beban_jasa,"2",",",".")."$h</td>
						 <td align=\"right\" valign=\"top\">$i".number_format($num_beban_jasa_lalu,"2",",",".")."$j</td>
						 <td align=\"right\" valign=\"top\">$k".number_format($num_utang_brg_jasa,"2",",",".")."$l</td>
						 <td align=\"right\" valign=\"top\">$m".number_format($num_utang_brg_jasa_lalu,"2",",",".")."$n</td>
						 <td align=\"right\" valign=\"top\">$o".number_format($num_bm_tdk_aset_ttp,"2",",",".")."$p</td>
						 <td align=\"right\" valign=\"top\">$q".number_format($num_brg_jsa_tmbh_kapit,"2",",",".")."$r</td>
						 <td align=\"right\" valign=\"top\">$s".number_format($num_brg_jsa_blud,"2",",",".")."$t</td>
						 <td align=\"right\" valign=\"top\">$u".number_format($num_brgjsa_lo,"2",",",".")."$v</td>
					</tr>"; 
		} 
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_BARANG");
        $this->template->set('title', 'LAPORAN CALK BARANG');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_calk_beban_912_2(){
		
		//--pindah
		$sql51 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=5";
        $hasil51 = $this->db->query($sql51);
		foreach ($hasil51->result() as $row)
        {
			$kd_rek51 = $row->kd_rek;			
		}
		
		$sql91 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=9";
        $hasil91 = $this->db->query($sql91);
		foreach ($hasil91->result() as $row)
        {
			$kd_rek91 = $row->kd_rek;			
		}
		
		$sql21 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=2";
        $hasil21 = $this->db->query($sql21);
		foreach ($hasil21->result() as $row)
        {
			$kd_rek21 = $row->kd_rek;			
		}
		
		$sql52 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=5";
        $hasil52 = $this->db->query($sql52);
		foreach ($hasil52->result() as $row)
        {
			$kd_rek52 = $row->kd_rek;			
		}
		
		$sql92 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=9";
        $hasil92 = $this->db->query($sql92);
		foreach ($hasil92->result() as $row)
        {
			$kd_rek92 = $row->kd_rek;			
		}
		
		$sql22 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=2";
        $hasil22 = $this->db->query($sql22);
		foreach ($hasil22->result() as $row)
        {
			$kd_rek22 = $row->kd_rek;			
		}
		
		$sql53 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=5";
        $hasil53 = $this->db->query($sql53);
		foreach ($hasil53->result() as $row)
        {
			$kd_rek53 = $row->kd_rek;			
		}
		
		$sql93 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=9";
        $hasil93 = $this->db->query($sql93);
		foreach ($hasil93->result() as $row)
        {
			$kd_rek93 = $row->kd_rek;			
		}
		
		$sql23 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=2";
        $hasil23 = $this->db->query($sql23);
		foreach ($hasil23->result() as $row)
        {
			$kd_rek23 = $row->kd_rek;			
		}
		
		$sql54 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=5";
        $hasil54 = $this->db->query($sql54);
		foreach ($hasil54->result() as $row)
        {
			$kd_rek54 = $row->kd_rek;			
		}
		
		$sql94 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=9";
        $hasil94 = $this->db->query($sql94);
		foreach ($hasil94->result() as $row)
        {
			$kd_rek94 = $row->kd_rek;			
		}
		
		$sql24 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=2";
        $hasil24 = $this->db->query($sql24);
		foreach ($hasil24->result() as $row)
        {
			$kd_rek24 = $row->kd_rek;			
		}
		//--akhir
		
		$ctk     = $this->uri->segment(3);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;

        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">LAPORAN CALK BEBAN PERSEDIAAN</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Persediaan - LRA $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Persediaan $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Persediaan $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Persediaan Lain-lain (Nilai dibawah Kapitalisasi) $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Persediaan Lain-lain (Nilai dibawah Kapitalisasi) $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Belanja Modal yang tidak diakui sebagai aset tetap</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Belanja Persediaan yag menjadi Aset</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Utang Persediaan (belanja yang diserahkan) $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Utang Persediaan (belanja yang diserahkan) $cthnsbl</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Persediaan BLUD $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Persediaan BLUD $cthnsbl</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Persediaan APBN $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Persediaan APBN $cthnsbl</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">P3D dari Pemerintah Kab/Kota ke Pemerintah Provinsi</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">P3D dari Pemerintah Provinsi ke Pemerintah Pusat</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Persediaan - LO $thn</td>
					</tr>"; 		  

		$sql = "SELECT x.kd_skpd, x.nm_skpd, ISNULL(y.persediaan_lra,0) persediaan_lra,
                             ISNULL(y.persediaan,0) persediaan,
                             ISNULL(y.persediaan_lalu,0) persediaan_lalu,
                             ISNULL(y.persediaan_lain,0) persediaan_lain,
                             ISNULL(y.persediaan_lain_lalu,0) persediaan_lain_lalu,
                             ISNULL(y.bm_tdk_aset_ttp,0) bm_tdk_aset_ttp,
                             ISNULL(y.persediaan_aset,0) persediaan_aset,
                             ISNULL(y.utang_persediaan,0) utang_persediaan,
                             ISNULL(y.utang_persediaan_lalu,0) utang_persediaan_lalu,
                             ISNULL(y.persediaan_blud,0) persediaan_blud,
                             ISNULL(y.persediaan_blud_lalu,0) persediaan_blud_lalu,
                             ISNULL(y.persediaan_apbn,0) persediaan_apbn,
                             ISNULL(y.persediaan_apbn_lalu,0) persediaan_apbn_lalu,
                             ISNULL(y.p3d_kab_kota,0) p3d_kab_kota,
                             ISNULL(y.p3d_prov,0) p3d_prov
				FROM (SELECT kd_skpd, nm_skpd FROM ms_skpd) x
					  LEFT JOIN
					 (SELECT kd_unit, 
							 SUM(CASE WHEN jns=512 AND thn=$thn THEN nilai ELSE 0 END) AS persediaan_lra,
							 SUM(CASE WHEN jns=912 AND thn=$thn THEN nilai ELSE 0 END) AS persediaan,
							 SUM(CASE WHEN jns=912 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS persediaan_lalu,
							 SUM(CASE WHEN jns=9121 AND thn=$thn THEN nilai ELSE 0 END) AS persediaan_lain,
							 SUM(CASE WHEN jns=9121 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS persediaan_lain_lalu,
							 SUM(CASE WHEN jns=9122 AND thn=$thn THEN nilai ELSE 0 END) AS bm_tdk_aset_ttp,
							 SUM(CASE WHEN jns=9123 AND thn=$thn THEN nilai ELSE 0 END) AS persediaan_aset,
							 SUM(CASE WHEN jns=9124 AND kd_unit<>'1.02.02.01' AND thn=$thn THEN nilai
                                      WHEN jns=9124 AND kd_unit='1.02.02.01' AND thn=$thn THEN nilai*-1 ELSE 0 END) AS utang_persediaan,
							 SUM(CASE WHEN jns=9124 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS utang_persediaan_lalu,
							 SUM(CASE WHEN jns=9125 AND thn=$thn THEN nilai ELSE 0 END) AS persediaan_blud,
							 SUM(CASE WHEN jns=9125 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS persediaan_blud_lalu,
							 SUM(CASE WHEN jns=9126 AND thn=$thn THEN nilai ELSE 0 END) AS persediaan_apbn,
							 SUM(CASE WHEN jns=9126 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS persediaan_apbn_lalu,
							 SUM(CASE WHEN jns=9127 AND thn=$thn THEN nilai ELSE 0 END) AS p3d_kab_kota,
							 SUM(CASE WHEN jns=9128 AND thn=$thn THEN nilai ELSE 0 END) AS p3d_prov
					  FROM (
						SELECT 512 jns, b.kd_unit, $thn thn, SUM(b.debet-b.kredit) nilai
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE b.kd_rek5 IN ($kd_rek52) 
						AND YEAR(tgl_voucher)='$thn'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 912 jns, b.kd_unit, $cthnsbl thn, ISNULL(SUM(debet-kredit),0) nilai
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,5) IN ('11701','11702','11703') AND YEAR(tgl_voucher)<='$cthnsbl'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 912 jns, b.kd_unit, $thn thn, ISNULL(SUM(debet-kredit),0)*-1 nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,5) IN ('11701','11702','11703') AND YEAR(tgl_voucher)<='$thn'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 9121 jns, kd_unit, $thn thn, ISNULL(sal_awal-kurang+tambah+tahun_n+koreksi,0) nilai
						FROM (
						SELECT kd_skpd kd_unit, SUM(sal_awal) sal_awal, SUM(kurang) kurang, SUM(tambah) tambah, 
						SUM(tahun_n) tahun_n, SUM(ISNULL(korplus,0)-ISNULL(kormin,0)) koreksi
						FROM lamp_aset WHERE kd_rek5='1170302' and tahun<='$thn'
						GROUP BY kd_skpd) x
						UNION ALL
						SELECT 9121 jns, kd_unit, $cthnsbl thn, ISNULL(sal_awal,0)*-1 nilai
						FROM (
						SELECT kd_skpd kd_unit, SUM(sal_awal) sal_awal, SUM(kurang) kurang, SUM(tambah) tambah, 
						SUM(tahun_n) tahun_n, SUM(ISNULL(korplus,0)-ISNULL(kormin,0)) koreksi
						FROM lamp_aset WHERE kd_rek5='1170302' and tahun<='$cthnsbl'
						GROUP BY kd_skpd) x
						UNION ALL
						SELECT 9122 jns, kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai),0) nilai
						FROM nilai_beban_calk WHERE kd_rek='9135'
						GROUP BY kd_skpd
						UNION ALL
						SELECT 9123 jns, kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai),0) nilai
						FROM nilai_beban_calk WHERE kd_rek='9136'
						GROUP BY kd_skpd
						UNION ALL
						SELECT 9124 jns, b.kd_unit, $thn thn, ISNULL(SUM(debet-kredit),0) nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
						WHERE YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,7) IN ($kd_rek22,'2150210')
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 9124 jns, kd_unit, $cthnsbl thn, ISNULL(SUM(nilai),0) nilai FROM (
						SELECT b.kd_unit, ISNULL(SUM(debet-kredit),0) nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
						WHERE YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,7) IN ($kd_rek22,'2150210')
						GROUP BY b.kd_unit
						) z
						GROUP BY kd_unit
						UNION ALL
						SELECT 9125 jns, b.kd_unit, $thn thn, ISNULL(SUM(0),0) nilai
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
						WHERE YEAR(a.tgl_voucher)='$thn' AND LEFT(b.kd_rek5,3) IN ('117')
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 9125 jns, b.kd_unit, $cthnsbl thn, ISNULL(SUM(0),0) nilai
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
						WHERE YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,3) IN ('117')
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 9126 jns, kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai),0) nilai 
						FROM nilai_beban_calk WHERE kd_rek IN ('91311')
						GROUP BY kd_skpd
						UNION ALL
						SELECT 9126 jns, kd_skpd kd_unit, $cthnsbl thn, ISNULL(SUM(nilai),0) nilai 
						FROM nilai_beban_calk WHERE kd_rek IN ('91312')
						GROUP BY kd_skpd
						UNION ALL
						SELECT 9127 jns, kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai),0) nilai 
						FROM nilai_beban_calk WHERE kd_rek IN ('91313')
						GROUP BY kd_skpd
						UNION ALL
						SELECT 9128 jns, kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai),0) nilai 
						FROM nilai_beban_calk WHERE kd_rek IN ('91314')
						GROUP BY kd_skpd
						) p GROUP BY kd_unit 
					  ) y ON x.kd_skpd=y.kd_unit 
				WHERE persediaan_lra<>0 OR persediaan<>0 OR persediaan_lalu<>0 OR persediaan_lain<>0 OR persediaan_lain_lalu<>0 OR bm_tdk_aset_ttp<>0 OR persediaan_aset<>0 OR utang_persediaan<>0 OR utang_persediaan_lalu<>0 OR persediaan_blud<>0 OR persediaan_blud_lalu<>0 OR persediaan_apbn<>0 OR persediaan_apbn_lalu<>0 OR p3d_kab_kota<>0 OR p3d_prov<>0 
				ORDER BY kd_skpd";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$persediaan_lra=$row->persediaan_lra;
			$persediaan=$row->persediaan;
			$persediaan_lalu=$row->persediaan_lalu;
			$persediaan_lain=$row->persediaan_lain;
			$persediaan_lain_lalu=$row->persediaan_lain_lalu;
			$bm_tdk_aset_ttp=$row->bm_tdk_aset_ttp;
			$persediaan_aset=$row->persediaan_aset;
			$utang_persediaan=$row->utang_persediaan;
			$utang_persediaan_lalu=$row->utang_persediaan_lalu;
			$persediaan_blud=$row->persediaan_blud;
			$persediaan_blud_lalu=$row->persediaan_blud_lalu;
			$persediaan_apbn=$row->persediaan_apbn;
			$persediaan_apbn_lalu=$row->persediaan_apbn_lalu;
			$p3d_kab_kota=$row->p3d_kab_kota;
			$p3d_prov=$row->p3d_prov;
						
			$persediaan_lo = $persediaan_lra+$persediaan+$persediaan_lalu+$persediaan_lain+$persediaan_lain_lalu+$bm_tdk_aset_ttp+$persediaan_aset+$utang_persediaan+$utang_persediaan_lalu+$persediaan_blud+$persediaan_blud_lalu+$persediaan_apbn+$persediaan_apbn_lalu+$p3d_kab_kota+$p3d_prov;
						
			IF($persediaan_lra<0){$num_persediaan_lra = $persediaan_lra*-1; $a="("; $b=")";} ELSE { $num_persediaan_lra = $persediaan_lra; $a=""; $b="";}
			IF($persediaan<0){$num_persediaan = $persediaan*-1; $c="("; $d=")";} ELSE { $num_persediaan = $persediaan; $c=""; $d="";}
			IF($persediaan_lalu<0){$num_persediaan_lalu = $persediaan_lalu*-1; $e="("; $f=")";} ELSE { $num_persediaan_lalu = $persediaan_lalu; $e=""; $f="";}
			IF($persediaan_lain<0){$num_persediaan_lain = $persediaan_lain*-1; $g="("; $h=")";} ELSE { $num_persediaan_lain = $persediaan_lain; $g=""; $h="";}
			IF($persediaan_lain_lalu<0){$num_persediaan_lain_lalu = $persediaan_lain_lalu*-1; $i="("; $j=")";} ELSE { $num_persediaan_lain_lalu = $persediaan_lain_lalu; $i=""; $j="";}
			IF($bm_tdk_aset_ttp<0){$num_bm_tdk_aset_ttp = $bm_tdk_aset_ttp*-1; $k="("; $l=")";} ELSE { $num_bm_tdk_aset_ttp = $bm_tdk_aset_ttp; $k=""; $l="";}
			IF($persediaan_aset<0){$num_persediaan_aset = $persediaan_aset*-1; $m="("; $n=")";} ELSE { $num_persediaan_aset = $persediaan_aset; $m=""; $n="";}
			IF($utang_persediaan<0){$num_utang_persediaan = $utang_persediaan*-1; $o="("; $p=")";} ELSE { $num_utang_persediaan = $utang_persediaan; $o=""; $p="";}
			IF($utang_persediaan_lalu<0){$num_utang_persediaan_lalu = $utang_persediaan_lalu*-1; $q="("; $r=")";} ELSE { $num_utang_persediaan_lalu = $utang_persediaan_lalu; $q=""; $r="";}
			IF($persediaan_blud<0){$num_persediaan_blud = $persediaan_blud*-1; $s="("; $t=")";} ELSE { $num_persediaan_blud = $persediaan_blud; $s=""; $t="";}
			IF($persediaan_blud_lalu<0){$num_persediaan_blud_lalu = $persediaan_blud_lalu*-1; $u="("; $v=")";} ELSE { $num_persediaan_blud_lalu = $persediaan_blud_lalu; $u=""; $v="";}
			IF($persediaan_apbn<0){$num_persediaan_apbn = $persediaan_apbn*-1; $w="("; $x=")";} ELSE { $num_persediaan_apbn = $persediaan_apbn; $w=""; $x="";}
			IF($persediaan_apbn_lalu<0){$num_persediaan_apbn_lalu = $persediaan_apbn_lalu*-1; $y="("; $z=")";} ELSE { $num_persediaan_apbn_lalu = $persediaan_apbn_lalu; $y=""; $z="";}
			IF($p3d_kab_kota<0){$num_p3d_kab_kota = $p3d_kab_kota*-1; $aa="("; $bb=")";} ELSE { $num_p3d_kab_kota = $p3d_kab_kota; $aa=""; $bb="";}
			IF($p3d_prov<0){$num_p3d_prov = $p3d_prov*-1; $cc="("; $dd=")";} ELSE { $num_p3d_prov = $p3d_prov; $cc=""; $dd="";}
			IF($persediaan_lo<0){$num_persediaan_lo = $persediaan_lo*-1; $ee="("; $ff=")";} ELSE { $num_persediaan_lo = $persediaan_lo; $ee=""; $ff="";}
						
			$cRet .= "<tr>
						 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
						 <td align=\"right\" valign=\"top\">$a".number_format($num_persediaan_lra,"2",",",".")."$b</td>                         
						 <td align=\"right\" valign=\"top\">$c".number_format($num_persediaan,"2",",",".")."$d</td>                         
						 <td align=\"right\" valign=\"top\">$e".number_format($num_persediaan_lalu,"2",",",".")."$f</td> 
						 <td align=\"right\" valign=\"top\">$g".number_format($num_persediaan_lain,"2",",",".")."$h</td>
						 <td align=\"right\" valign=\"top\">$i".number_format($num_persediaan_lain_lalu,"2",",",".")."$j</td>
						 <td align=\"right\" valign=\"top\">$k".number_format($num_bm_tdk_aset_ttp,"2",",",".")."$l</td>
						 <td align=\"right\" valign=\"top\">$m".number_format($num_persediaan_aset,"2",",",".")."$n</td>
						 <td align=\"right\" valign=\"top\">$o".number_format($num_utang_persediaan,"2",",",".")."$p</td>
						 <td align=\"right\" valign=\"top\">$q".number_format($num_utang_persediaan_lalu,"2",",",".")."$r</td>
						 <td align=\"right\" valign=\"top\">$s".number_format($num_persediaan_blud,"2",",",".")."$t</td>
						 <td align=\"right\" valign=\"top\">$u".number_format($num_persediaan_blud_lalu,"2",",",".")."$v</td>
						 <td align=\"right\" valign=\"top\">$w".number_format($num_persediaan_apbn,"2",",",".")."$x</td>
						 <td align=\"right\" valign=\"top\">$y".number_format($num_persediaan_apbn_lalu,"2",",",".")."$z</td>
						 <td align=\"right\" valign=\"top\">$aa".number_format($num_p3d_kab_kota,"2",",",".")."$bb</td>
						 <td align=\"right\" valign=\"top\">$cc".number_format($num_p3d_prov,"2",",",".")."$dd</td>
						 <td align=\"right\" valign=\"top\">$ee".number_format($num_persediaan_lo,"2",",",".")."$ff</td>
					</tr>"; 
		} 
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_PERSEDIAAN");
        $this->template->set('title', 'LAPORAN CALK PERSEDIAAN');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_calk_beban_912_3(){
		
		//--pindah
		$sql51 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=5";
        $hasil51 = $this->db->query($sql51);
		foreach ($hasil51->result() as $row)
        {
			$kd_rek51 = $row->kd_rek;			
		}
		
		$sql91 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=9";
        $hasil91 = $this->db->query($sql91);
		foreach ($hasil91->result() as $row)
        {
			$kd_rek91 = $row->kd_rek;			
		}
		
		$sql21 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=2";
        $hasil21 = $this->db->query($sql21);
		foreach ($hasil21->result() as $row)
        {
			$kd_rek21 = $row->kd_rek;			
		}
		
		$sql52 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=5";
        $hasil52 = $this->db->query($sql52);
		foreach ($hasil52->result() as $row)
        {
			$kd_rek52 = $row->kd_rek;			
		}
		
		$sql92 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=9";
        $hasil92 = $this->db->query($sql92);
		foreach ($hasil92->result() as $row)
        {
			$kd_rek92 = $row->kd_rek;			
		}
		
		$sql22 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=2";
        $hasil22 = $this->db->query($sql22);
		foreach ($hasil22->result() as $row)
        {
			$kd_rek22 = $row->kd_rek;			
		}
		
		$sql53 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=5";
        $hasil53 = $this->db->query($sql53);
		foreach ($hasil53->result() as $row)
        {
			$kd_rek53 = $row->kd_rek;			
		}
		
		$sql93 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=9";
        $hasil93 = $this->db->query($sql93);
		foreach ($hasil93->result() as $row)
        {
			$kd_rek93 = $row->kd_rek;			
		}
		
		$sql23 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=2";
        $hasil23 = $this->db->query($sql23);
		foreach ($hasil23->result() as $row)
        {
			$kd_rek23 = $row->kd_rek;			
		}
		
		$sql54 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=5";
        $hasil54 = $this->db->query($sql54);
		foreach ($hasil54->result() as $row)
        {
			$kd_rek54 = $row->kd_rek;			
		}
		
		$sql94 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=9";
        $hasil94 = $this->db->query($sql94);
		foreach ($hasil94->result() as $row)
        {
			$kd_rek94 = $row->kd_rek;			
		}
		
		$sql24 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=2";
        $hasil24 = $this->db->query($sql24);
		foreach ($hasil24->result() as $row)
        {
			$kd_rek24 = $row->kd_rek;			
		}
		//--akhir
		
		$ctk     = $this->uri->segment(3);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;

        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">LAPORAN CALK BEBAN PEMELIHARAAN</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Pemeliharaan - LRA $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Utang Pemeliharaan $thn</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Utang Pemeliharaan $cthnsbl</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Belanja Modal yang tidak masuk sebagai kapitalisasi aset</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Belanja Pemeliharaan yang menjadi aset</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Beban Pemeliharaan - LO $thn</td>                        
					</tr>"; 		  

		$sql = "SELECT x.kd_skpd, x.nm_skpd, ISNULL(y.lra_pem,0) lra_pem,
							 ISNULL(y.utang_pem,0) utang_pem,
							 ISNULL(y.utang_pem_lalu,0) utang_pem_lalu,
							 ISNULL(y.bm_tdk_kapit,0) bm_tdk_kapit,
							 ISNULL(y.pem_aset,0) pem_aset
				FROM (SELECT kd_skpd, nm_skpd FROM ms_skpd) x
					  LEFT JOIN
					 (SELECT kd_unit,
							 SUM(CASE WHEN jns=512 AND thn=$thn THEN nilai ELSE 0 END) AS lra_pem,
							 SUM(CASE WHEN jns=912 AND thn=$thn THEN nilai ELSE 0 END) AS utang_pem,
							 SUM(CASE WHEN jns=912 AND thn=$cthnsbl THEN nilai ELSE 0 END) AS utang_pem_lalu,
							 SUM(CASE WHEN jns=9121 AND thn=$thn THEN nilai ELSE 0 END) AS bm_tdk_kapit,
							 SUM(CASE WHEN jns=9122 AND thn=$thn THEN nilai ELSE 0 END) AS pem_aset
					  FROM (
						SELECT 512 jns, b.kd_unit, $thn thn, ISNULL(SUM(b.debet-b.kredit),0) nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE b.kd_rek5 IN ($kd_rek53) 
						AND YEAR(tgl_voucher)='$thn'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 912 jns, b.kd_unit, $thn thn, ISNULL(SUM(kredit-debet),0) nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
						WHERE YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,7) IN ('2150202')
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 912 jns, b.kd_unit, $cthnsbl thn, ISNULL(SUM(kredit-debet),0)*-1 nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
						WHERE YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,7) IN ('2150202')
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 9121 jns, kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai),0) nilai 
						FROM nilai_beban_calk WHERE kd_rek='9143'
						GROUP BY kd_skpd
						UNION ALL
						SELECT 9122 jns, kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai),0) nilai 
						FROM nilai_beban_calk WHERE kd_rek='9144'
						GROUP BY kd_skpd
						) p GROUP BY kd_unit 
					  ) y ON x.kd_skpd=y.kd_unit 
				WHERE lra_pem<>0 OR utang_pem<>0 OR utang_pem_lalu<>0 OR bm_tdk_kapit<>0 OR pem_aset<>0 
				ORDER BY kd_skpd";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$lra_pem=$row->lra_pem;
			$utang_pem=$row->utang_pem;
			$utang_pem_lalu=$row->utang_pem_lalu;
			$bm_tdk_kapit=$row->bm_tdk_kapit;
			$pem_aset=$row->pem_aset;
						
			$pem_lo = $lra_pem+$utang_pem+$utang_pem_lalu+$bm_tdk_kapit+$pem_aset;
						
			IF($lra_pem<0){$num_lra_pem = $lra_pem*-1; $a="("; $b=")";} ELSE { $num_lra_pem = $lra_pem; $a=""; $b="";}
			IF($utang_pem<0){$num_utang_pem = $utang_pem*-1; $c="("; $d=")";} ELSE { $num_utang_pem = $utang_pem; $c=""; $d="";}
			IF($utang_pem_lalu<0){$num_utang_pem_lalu = $utang_pem_lalu*-1; $e="("; $f=")";} ELSE { $num_utang_pem_lalu = $utang_pem_lalu; $e=""; $f="";}
			IF($bm_tdk_kapit<0){$num_bm_tdk_kapit = $bm_tdk_kapit*-1; $g="("; $h=")";} ELSE { $num_bm_tdk_kapit = $bm_tdk_kapit; $g=""; $h="";}
			IF($pem_aset<0){$num_pem_aset = $pem_aset*-1; $i="("; $j=")";} ELSE { $num_pem_aset = $pem_aset; $i=""; $j="";}
			IF($pem_lo<0){$num_pem_lo = $pem_lo*-1; $k="("; $l=")";} ELSE { $num_pem_lo = $pem_lo; $k=""; $l="";}
						
			$cRet .= "<tr>
						 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
						 <td align=\"right\" valign=\"top\">$a".number_format($num_lra_pem,"2",",",".")."$b</td>                         
						 <td align=\"right\" valign=\"top\">$c".number_format($num_utang_pem,"2",",",".")."$d</td>                         
						 <td align=\"right\" valign=\"top\">$e".number_format($num_utang_pem_lalu,"2",",",".")."$f</td> 
						 <td align=\"right\" valign=\"top\">$g".number_format($num_bm_tdk_kapit,"2",",",".")."$h</td>
						 <td align=\"right\" valign=\"top\">$i".number_format($num_pem_aset,"2",",",".")."$j</td>
						 <td align=\"right\" valign=\"top\">$k".number_format($num_pem_lo,"2",",",".")."$l</td>
					</tr>"; 
		} 
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_PEMELIHARAAN");
        $this->template->set('title', 'LAPORAN CALK PEMELIHARAAN');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	function cetak_lap_calk_beban_912_4(){
		
		//--pindah
		$sql51 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=5";
        $hasil51 = $this->db->query($sql51);
		foreach ($hasil51->result() as $row)
        {
			$kd_rek51 = $row->kd_rek;			
		}
		
		$sql91 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=9";
        $hasil91 = $this->db->query($sql91);
		foreach ($hasil91->result() as $row)
        {
			$kd_rek91 = $row->kd_rek;			
		}
		
		$sql21 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=2";
        $hasil21 = $this->db->query($sql21);
		foreach ($hasil21->result() as $row)
        {
			$kd_rek21 = $row->kd_rek;			
		}
		
		$sql52 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=5";
        $hasil52 = $this->db->query($sql52);
		foreach ($hasil52->result() as $row)
        {
			$kd_rek52 = $row->kd_rek;			
		}
		
		$sql92 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=9";
        $hasil92 = $this->db->query($sql92);
		foreach ($hasil92->result() as $row)
        {
			$kd_rek92 = $row->kd_rek;			
		}
		
		$sql22 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=2";
        $hasil22 = $this->db->query($sql22);
		foreach ($hasil22->result() as $row)
        {
			$kd_rek22 = $row->kd_rek;			
		}
		
		$sql53 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=5";
        $hasil53 = $this->db->query($sql53);
		foreach ($hasil53->result() as $row)
        {
			$kd_rek53 = $row->kd_rek;			
		}
		
		$sql93 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=9";
        $hasil93 = $this->db->query($sql93);
		foreach ($hasil93->result() as $row)
        {
			$kd_rek93 = $row->kd_rek;			
		}
		
		$sql23 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=2";
        $hasil23 = $this->db->query($sql23);
		foreach ($hasil23->result() as $row)
        {
			$kd_rek23 = $row->kd_rek;			
		}
		
		$sql54 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=5";
        $hasil54 = $this->db->query($sql54);
		foreach ($hasil54->result() as $row)
        {
			$kd_rek54 = $row->kd_rek;			
		}
		
		$sql94 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=9";
        $hasil94 = $this->db->query($sql94);
		foreach ($hasil94->result() as $row)
        {
			$kd_rek94 = $row->kd_rek;			
		}
		
		$sql24 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=2";
        $hasil24 = $this->db->query($sql24);
		foreach ($hasil24->result() as $row)
        {
			$kd_rek24 = $row->kd_rek;			
		}
		//--akhir
		
		$ctk     = $this->uri->segment(3);
        $spasi   = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;

        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">LAPORAN CALK BEBAN PERJALANAN DINAS</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr>
				  </table>";
				  				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
		            <tr>
						<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">KODE SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"35%\" align=\"center\">NAMA SKPD</td>
						<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\">Beban Perjalanan Dinas - LRA $thn</td>
						<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\">Belanja Perjalanan dinas sebagai penambah kapitalisasi aset</td>                        
						<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\">Beban Perjalanan Dinas - LO $thn</td>
					</tr>"; 		  

		$sql = "SELECT x.kd_skpd, x.nm_skpd, ISNULL(y.lra_prj,0) lra_prj,
							 ISNULL(y.bel_tmb_kapit,0) bel_tmb_kapit
				FROM (SELECT kd_skpd, nm_skpd FROM ms_skpd) x
					  LEFT JOIN
					 (SELECT kd_unit,
							 SUM(CASE WHEN jns=512 AND thn=$thn THEN nilai ELSE 0 END) AS lra_prj,
							 SUM(CASE WHEN jns=912 AND thn=$thn THEN nilai ELSE 0 END) AS bel_tmb_kapit
					  FROM (
						SELECT 512 jns, b.kd_unit, $thn thn, ISNULL(SUM(b.debet-b.kredit),0) nilai 
						FROM trhju_calk a INNER JOIN trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						WHERE b.kd_rek5 IN ($kd_rek54) 
						AND YEAR(tgl_voucher)='$thn'
						GROUP BY b.kd_unit
						UNION ALL
						SELECT 912 jns, kd_skpd kd_unit, $thn thn, ISNULL(SUM(nilai),0) nilai 
						FROM nilai_beban_calk WHERE LEFT(kd_rek,3)='915'
						GROUP BY kd_skpd
						) p GROUP BY kd_unit 
					  ) y ON x.kd_skpd=y.kd_unit 
				WHERE lra_prj<>0 OR bel_tmb_kapit<>0 
				ORDER BY kd_skpd";
		$sqlsclient=$this->db->query($sql);
					
		foreach ($sqlsclient->result() as $row)
		{
			$kd_skpd=$row->kd_skpd;
			$nm_skpd=$row->nm_skpd;
			$lra_prj=$row->lra_prj;
			$bel_tmb_kapit=$row->bel_tmb_kapit;
						
			$brgjsa_lo = $lra_prj+$bel_tmb_kapit;
						
			IF($lra_prj<0){$num_lra_prj = $lra_prj*-1; $a="("; $b=")";} ELSE { $num_lra_prj = $lra_prj; $a=""; $b="";}
			IF($bel_tmb_kapit<0){$num_bel_tmb_kapit = $bel_tmb_kapit*-1; $c="("; $d=")";} ELSE { $num_bel_tmb_kapit = $bel_tmb_kapit; $c=""; $d="";}
			IF($brgjsa_lo<0){$num_brgjsa_lo = $brgjsa_lo*-1; $e="("; $f=")";} ELSE { $num_brgjsa_lo = $brgjsa_lo; $e=""; $f="";}
						
			$cRet .= "<tr>
						 <td align=\"center\" valign=\"top\">".$kd_skpd."</td>
						 <td align=\"left\" valign=\"top\">".$nm_skpd."</td>                         
						 <td align=\"right\" valign=\"top\">$a".number_format($num_lra_prj,"2",",",".")."$b</td>                         
						 <td align=\"right\" valign=\"top\">$c".number_format($num_bel_tmb_kapit,"2",",",".")."$d</td>                         
						 <td align=\"right\" valign=\"top\">$e".number_format($num_brgjsa_lo,"2",",",".")."$f</td> 
					</tr>"; 
		} 
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LAPORAN_CALK_PERJALANANDINAS");
        $this->template->set('title', 'LAPORAN CALK PERJALANAN DINAS');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	
	function hambatan_calk(){
        $data['page_title']= 'HAMBATAN CALK';
        $this->template->set('title', 'HAMBATAN CALK');   
        $this->template->load('template','calk/cetak_hambatan_calk',$data) ;	
	}
	
	function cetak_hambatan_skpd(){
		$ctk = $this->uri->segment(3);
        $spasi = 'line-height:1.5em;';
		$thn     = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;
        $angg    = "nilai_ubah"; //$this->get_status($dcetak,$kd_skpd);
        $lanjut  = 0;

		
	    if($angg=='nilai'){
            $jangg = 'PENYUSUNAN' ;  
            $v = '1';
	    } else{
	       if($angg=='nilai_sempurna'){
	           $jangg = 'PENYEMPURNAAN' ;
               $v = '2';
	       }else{
	           $jangg = 'PERUBAHAN' ;
               $v = '3';
	       }
	    }
		
        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">BAB   II   IKHTISAR PENCAPAIAN KINERJA KEUANGAN</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">KEGIATAN KURANG DARI 75 %</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">TAHUN $thn<br><br></td>      
                  </tr>
                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\"></td>
                    <td style=\"font-weight:bold;\" colspan=\"6\"></td>      
                  </tr></table>";
				  
				  
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\"><tr>
											  <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">Kode SKPD</td>
											  <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">Nama SKPD</td>
											  <td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Kode Kegiatan</td>                        
											  <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\">Nama Kegiatan</td>                        
                    						  <td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Anggaran</td>
                    						  <td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">Realisasi</td>
                    						  <td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">%</td>
                    						  <td  bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\">Hambatan</td>   						  
                    				</tr>"; 		  

				$sql = "SELECT * FROM (
						select '1' nomor, SUBSTRING(kode,6,10) skpd, '' kode, (select nm_skpd from trdrka where kd_skpd=SUBSTRING(kode,6,10) group by nm_skpd) nm_skpd, '' bidang, 0 angg_ubah, 0 realisasi, 0 persen, '' hambatan from(
													select nomor,kode,bidang,angg_ubah,real,selisih=[real]-angg_ubah,case when angg_ubah=0  then 0 else ([real]/angg_ubah)*100 end [persen],isnull(e.hambatan,'') [hambatan] from(
														select 8 [nomor], b.kd_kegiatan [kode],b.nm_kegiatan [bidang],sum(a.nilai_ubah) [angg_ubah],
														(select ISNULL(sum(debet-kredit),0) from trdju_calk d inner join trhju_calk c on d.kd_unit=c.kd_skpd and c.no_voucher=d.no_voucher where YEAR(c.tgl_voucher)=$thn and d.kd_kegiatan=b.kd_kegiatan) [real]
														from trdrka a join trskpd b on a.kd_kegiatan=b.kd_kegiatan and a.kd_skpd=b.kd_skpd 
														where right(b.kd_program,2) not in ('00')
														group by b.kd_kegiatan,b.nm_kegiatan
													) as keg left join calk_babII e on keg.kode=e.kd_program where angg_ubah>0                 
												)as gabung 
						where persen<=75
						group by SUBSTRING(kode,6,10)
						UNION ALL

						select '2' nomor, SUBSTRING(kode,6,10) skpd, kode, (select nm_skpd from trdrka where kd_skpd=SUBSTRING(kode,6,10) group by nm_skpd) nm_skpd, bidang, angg_ubah, real as realisasi, persen, hambatan from(
													select nomor,kode,bidang,angg_ubah,real,selisih=[real]-angg_ubah,case when angg_ubah=0  then 0 else ([real]/angg_ubah)*100 end [persen],isnull(e.hambatan,'') [hambatan] from(
														select 8 [nomor], b.kd_kegiatan [kode],b.nm_kegiatan [bidang],sum(a.nilai_ubah) [angg_ubah],
														(select ISNULL(sum(debet-kredit),0) from trdju_calk d inner join trhju_calk c on d.kd_unit=c.kd_skpd and c.no_voucher=d.no_voucher where YEAR(c.tgl_voucher)=$thn and d.kd_kegiatan=b.kd_kegiatan) [real]
														from trdrka a join trskpd b on a.kd_kegiatan=b.kd_kegiatan and a.kd_skpd=b.kd_skpd 
														where right(b.kd_program,2) not in ('00')
														group by b.kd_kegiatan,b.nm_kegiatan
													) as keg left join calk_babII e on keg.kode=e.kd_program where angg_ubah>0                 
												)as gabung 
						where persen<=75 ) x
						order by skpd,kode";
					$sqlsclient=$this->db->query($sql);
					
					$no=1;
					foreach ($sqlsclient->result() as $row)
					{
						$nomor=$row->nomor;
						$skpd=$row->skpd;
						$kode=$row->kode;
						$nm_skpd=$row->nm_skpd;
						$bidang=$row->bidang;
						$ang_ubah=$row->angg_ubah;
						$realisasi=$row->realisasi;
						$persen=$row->persen;
						$hambatan=$row->hambatan;
						
						if($persen==0){
							$persenx =  0.00; 
						}else{
							$persenx =  substr($persen,0,5); 
						}
						
						
						if($nomor=='1'){
							$cRet .= "<tr>
											 <td valign=\"top\"><b>".$skpd."</b></td>
											 <td colspan=\"7\" align=\"left\" valign=\"top\"><b>".$nm_skpd."</b></td>
                    				</tr>";
						}else{
						$cRet .= "<tr>
											 <td ></td>
											 <td ></td>
                    						 <td align=\"left\" valign=\"top\">".$kode."</td>                         
                    						 <td align=\"left\" valign=\"top\">".$bidang."</td>                         
                    						 <td align=\"right\" valign=\"top\">".number_format($ang_ubah,"2",",",".")."</td>
                    						 <td align=\"right\" valign=\"top\">".number_format($realisasi,"2",",",".")."</td>
                    						 <td align=\"center\" valign=\"top\">".$persenx."</td>
                    						 <td align=\"justify\">".$hambatan."</td>   						  
                    				</tr>"; 
						}
					}
                             
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("BAB_II");
        $this->template->set('title', 'BAB II');        
        
		$pilih=$ctk;
		switch($pilih) {       
        case 0;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 1;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
	}
	
	
    function rp_minus($nilai){
        if($nilai<0){
            $nilai = $nilai * (-1);
            $nilai = '('.number_format($nilai,"2",",",".").')';    
        }else{
            $nilai = number_format($nilai,"2",",","."); 
        }
        
        return $nilai;
    }  	

    function persen($nilai,$nilai2){
            if($nilai != 0){
                $persen = $this->rp_minus(($nilai2/$nilai)*100);
            }else{
                if($nilai2 == 0){
                    $persen = $this->rp_minus(0);
                }else{
                    $persen = $this->rp_minus(100);
                }
            } 
          return $persen;  
	 }
	
	function mapping_calk(){
        $data['page_title']= 'MAPPING CALK';
        $this->template->set('title', 'MAPPING CALK');   
        $this->template->load('template','calk/mapping_calk',$data) ;	
	}
	
	function proses_mapping(){
		$user     = $this->session->userdata('pcNama');
		$skpd     = $this->session->userdata('kdskpd');
		$thn     = $this->session->userdata('pcThang');
		$bln     = $this->input->post('bln');
		$this->db->query("exec transfer_lk_calk_skpd '$skpd',$thn,$bln");		

		echo '1';	
	}
	
	
	function lampiran_calk($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
        $data['page_title']= 'LAMPIRAN CALK';
        $this->template->set('title', 'LAMPIRAN CALK');   
        $this->template->load('template','calk/lampiran_calk',$data) ;	
	}
	
	function calk_kas_terima(){
        $data['page_title']= 'CALK KAS TERIMA';
        $this->template->set('title', 'CALK KAS TERIMA');   
        $this->template->load('template','calk/calk_kas_terima',$data) ; 
    }
	
	function no_urut($kd_rek){
		$kd_skpd = $this->session->userdata('kdskpd'); 
		$query1 = $this->db->query("select case when max(nomor+1) is null then 1 else max(nomor+1) end as nomor from (
									select RIGHT(kd_rek,1) nomor,'isi neraca' ket,kd_skpd from isi_neraca_calk where isnumeric(kd_rek)=1 and LEFT(kd_rek,4)='$kd_rek' and kd_skpd='$kd_skpd') z ");
	    $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
            $result = array(
                        'id' => $ii,        
                        'no_urut' => $resulte['nomor']
                        );
                        $ii++;
        }
		
        echo json_encode($result);
    	$query1->free_result();   
    }
	
	function no_urut_analisis($kd_rek){
		$kd_skpd = $this->session->userdata('kdskpd'); 
		$query1 = $this->db->query("select case when max(nomor+1) is null then 1 else max(nomor+1) end as nomor from (
									select RIGHT(kd_rek,1) nomor,'isi neraca' ket,kd_skpd from isi_analisis_calk where isnumeric(kd_rek)=1 and kd_rek='$kd_rek' and kd_skpd='$kd_skpd') z ");
	    $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
            $result = array(
                        'id' => $ii,        
                        'no_urut' => $resulte['nomor']
                        );
                        $ii++;
        }
		
        echo json_encode($result);
    	$query1->free_result();   
    }
	
	function calk_neraca_1312(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1312',$data) ; 
    }
	
	function calk_neraca_1313(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1313',$data) ; 
    }
	
	function calk_neraca_132(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_132',$data) ; 
    }
	
	function calk_neraca_1322(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1322',$data) ; 
    }
	
	function calk_neraca_1323(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1323',$data) ; 
    }
	
	function calk_neraca_133(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_133',$data) ; 
    }
	
	function calk_neraca_1332(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1332',$data) ; 
    }
	
	function calk_neraca_1333(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1333',$data) ; 
    }
	
	function calk_neraca_134(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_134',$data) ; 
    }
	
	function calk_neraca_1342(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1342',$data) ; 
    }
	
	function calk_neraca_1343(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1343',$data) ; 
    }
	
	
	function calk_neraca_135(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_135',$data) ; 
    }
	
	function calk_neraca_1352(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1352',$data) ; 
    }
	
	function calk_neraca_1353(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1353',$data) ; 
    }
	
	function calk_neraca_136(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_136',$data) ; 
    }
	
	function calk_neraca_1362(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1362',$data) ; 
    }
	
	function calk_neraca_1363(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1363',$data) ; 
    }
	
	function calk_neraca_141(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_141',$data) ; 
    }
	
	function calk_neraca_1421(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1421',$data) ; 
    }
	
	function calk_neraca_1422(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1422',$data) ; 
    }
	
	function calk_neraca_1423(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1423',$data) ; 
    }
	
	function calk_neraca_1424(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1424',$data) ; 
    }
	
	function calk_neraca_1432(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1432',$data) ; 
    }
	
	function calk_neraca_1433(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1433',$data) ; 
    }
	
	function calk_neraca_1442(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1442',$data) ; 
    }
	
	function calk_neraca_1443(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_1443',$data) ; 
    }
	
	function calk_neraca_211(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_211',$data) ; 
    }
	
	function calk_neraca_212(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_212',$data) ; 
    }
	
	function calk_neraca_213(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_213',$data) ; 
    }
	
	function calk_neraca_221(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_221',$data) ; 
    }
	
	function calk_neraca_231(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_231',$data) ; 
    }
	
	function calk_neraca_232(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_232',$data) ; 
    }
	
	function calk_neraca_233(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_neraca_233',$data) ; 
    }
	
	function calk_lpe_314(){
        $data['page_title']= 'CALK LPE';
        $this->template->set('title', 'CALK LPE');   
        $this->template->load('template','calk/calk_lpe_314',$data) ; 
    }
	
	function calk_pendapatan_411(){
        $data['page_title']= 'CALK LRA';
        $this->template->set('title', 'CALK LRA');   
        $this->template->load('template','calk/calk_pendapatan_411',$data) ; 
    }
	
	function calk_pendapatan_412(){
        $data['page_title']= 'CALK LRA';
        $this->template->set('title', 'CALK LRA');   
        $this->template->load('template','calk/calk_pendapatan_412',$data) ; 
    }
	
	function calk_pendapatan_414(){
        $data['page_title']= 'CALK LRA';
        $this->template->set('title', 'CALK LRA');   
        $this->template->load('template','calk/calk_pendapatan_414',$data) ; 
    }
	
	function calk_lo_811(){
        $data['page_title']= 'CALK LO';
        $this->template->set('title', 'CALK LO');   
        $this->template->load('template','calk/calk_lo_811',$data) ; 
    }
	
	function calk_lo_812(){
        $data['page_title']= 'CALK LO';
        $this->template->set('title', 'CALK LO');   
        $this->template->load('template','calk/calk_lo_812',$data) ; 
    }
	
	function calk_lo_813(){
        $data['page_title']= 'CALK LO';
        $this->template->set('title', 'CALK LO');   
        $this->template->load('template','calk/calk_lo_813',$data) ; 
    }
	
	function calk_lo_814(){
        $data['page_title']= 'CALK LO';
        $this->template->set('title', 'CALK LO');   
        $this->template->load('template','calk/calk_lo_814',$data) ; 
    }
	
	function calk_beban_911(){
        $data['page_title']= 'CALK BEBAN';
        $this->template->set('title', 'CALK BEBAN');   
        $this->template->load('template','calk/calk_beban_911',$data) ; 
    }
	
	function calk_beban_912(){
        $data['page_title']= 'CALK BEBAN';
        $this->template->set('title', 'CALK BEBAN');   
        $this->template->load('template','calk/calk_beban_912',$data) ; 
    }
	
	function calk_beban_913(){
        $data['page_title']= 'CALK BEBAN';
        $this->template->set('title', 'CALK BEBAN');   
        $this->template->load('template','calk/calk_beban_913',$data) ; 
    }
	
	function calk_beban_914(){
        $data['page_title']= 'CALK BEBAN';
        $this->template->set('title', 'CALK BEBAN');   
        $this->template->load('template','calk/calk_beban_914',$data) ; 
    }
	
	function calk_beban_915(){
        $data['page_title']= 'CALK BEBAN';
        $this->template->set('title', 'CALK BEBAN');   
        $this->template->load('template','calk/calk_beban_915',$data) ; 
    }
	
	function calk_beban_918(){
        $data['page_title']= 'CALK BEBAN';
        $this->template->set('title', 'CALK BEBAN');   
        $this->template->load('template','calk/calk_beban_918',$data) ; 
    }
	
	function calk_babiv(){
        $data['page_title']= 'CALK BABIV';
        $this->template->set('title', 'CALK BABIV');   
        $this->template->load('template','calk/calk_babiv',$data) ; 
    }
	
	function load_calk_neraca_131() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, x.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1312'
					union all
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1313')x 
LEFT JOIN
(select kd_rek, ket from isi_neraca_calk where kd_rek='1312' and kd_skpd='$skpd'
 UNION ALL
 select kd_rek, ket from isi_neraca_calk where kd_rek='1313' and kd_skpd='$skpd') z
on x.kd_rek=z.kd_rek";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_lamp1($data) {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT * FROM isi_analisis_calk WHERE kd_skpd='$skpd' AND kd_rek='$data'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],
                        'ket' => $resulte['ket'],
						'kd_rinci' => $resulte['kd_rinci']
                        );
                        $ii++;
        }
		$result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	
	function load_calk_neraca_1312(){
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1312' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_lamp2(){
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai, kd_rinci 
				FROM isi_analisis_calk 
				WHERE kd_skpd='$skpd' AND LEFT(kd_rek,2)='13'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',','),
						'kd_rinci' => $resulte['kd_rinci']
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	
	function load_calk_neraca_1313() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1313' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1322(){
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1322' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1323() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1323' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1332(){
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1332' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1333() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1333' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1342(){
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1342' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1343() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1343' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1352(){
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1352' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1353() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1353' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1362(){
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1362' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1363() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT kd_skpd, kd_rek, ket, nilai 
				FROM isi_neraca_calk 
				WHERE LEFT(kd_rek,4)='1363' AND kd_skpd='$skpd'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'ket' => $resulte['ket'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')   
                        );
                        $ii++;
        }
		
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	
	//PINDAH
	function load_calk_piutang_pendapatan_1131() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT x.kd_rek, x.nm_rek, y.ket, y.kd_rinci FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,4)='1131') x 
				LEFT JOIN (
				SELECT kd_rek, ket, kd_rinci FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek
				order by y.kd_rinci";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_piutang_pendapatan_1132() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT x.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,4)='1132') x 
				LEFT JOIN (
				SELECT kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_piutang_pendapatan_1133() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT x.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,4)='1133') x 
				LEFT JOIN (
				SELECT kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	
	function load_calk_neraca_132() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, x.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1322'
					union all
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1323')x 
LEFT JOIN
(select kd_rek, ket from isi_neraca_calk where kd_rek='1322' and kd_skpd='$skpd'
 UNION ALL
 select kd_rek, ket from isi_neraca_calk where kd_rek='1323' and kd_skpd='$skpd') z
on x.kd_rek=z.kd_rek";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_133() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, x.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1332'
					union all
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1333')x 
LEFT JOIN
(select kd_rek, ket from isi_neraca_calk where kd_rek='1332' and kd_skpd='$skpd'
 UNION ALL
 select kd_rek, ket from isi_neraca_calk where kd_rek='1333' and kd_skpd='$skpd') z
on x.kd_rek=z.kd_rek";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_134() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, x.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1342'
					union all
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1343')x 
LEFT JOIN
(select kd_rek, ket from isi_neraca_calk where kd_rek='1342' and kd_skpd='$skpd'
 UNION ALL
 select kd_rek, ket from isi_neraca_calk where kd_rek='1343' and kd_skpd='$skpd') z
on x.kd_rek=z.kd_rek";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_135() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, x.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1352'
					union all
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1353')x 
LEFT JOIN
(select kd_rek, ket from isi_neraca_calk where kd_rek='1352' and kd_skpd='$skpd'
 UNION ALL
 select kd_rek, ket from isi_neraca_calk where kd_rek='1353' and kd_skpd='$skpd') z
on x.kd_rek=z.kd_rek";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_136() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, x.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1362'
					union all
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1363')x 
LEFT JOIN
(select kd_rek, ket from isi_neraca_calk where kd_rek='1362' and kd_skpd='$skpd'
 UNION ALL
 select kd_rek, ket from isi_neraca_calk where kd_rek='1363' and kd_skpd='$skpd') z
on x.kd_rek=z.kd_rek";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_141() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, x.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1411'
					union all
					select kd_rek, nm_rek from ket_neraca_calk where kd_rek='1412')x 
LEFT JOIN
(select kd_rek, ket from isi_neraca_calk where kd_rek='1411' and kd_skpd='$skpd'
 UNION ALL
 select kd_rek, ket from isi_neraca_calk where kd_rek='1412' and kd_skpd='$skpd') z
on x.kd_rek=z.kd_rek";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1421() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, z.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where LEFT(kd_rek,4)='1421')x 
				INNER JOIN
				(select kd_rek, LEFT(kd_rek,4) kd_rek5, ket from isi_neraca_calk where LEFT(kd_rek,4)='1421' and kd_skpd='$skpd') z
				on x.kd_rek=z.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1422() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, z.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where LEFT(kd_rek,4)='1422')x 
				INNER JOIN
				(select kd_rek, LEFT(kd_rek,4) kd_rek5, ket from isi_neraca_calk where LEFT(kd_rek,4)='1422' and kd_skpd='$skpd') z
				on x.kd_rek=z.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1423() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, z.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where LEFT(kd_rek,4)='1423')x 
				INNER JOIN
				(select kd_rek, LEFT(kd_rek,4) kd_rek5, ket from isi_neraca_calk where LEFT(kd_rek,4)='1423' and kd_skpd='$skpd') z
				on x.kd_rek=z.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1424() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT '$skpd' kd_skpd, z.kd_rek, x.nm_rek, z.ket FROM (
					select kd_rek, nm_rek from ket_neraca_calk where LEFT(kd_rek,4)='1424')x 
				INNER JOIN
				(select kd_rek, LEFT(kd_rek,4) kd_rek5, ket from isi_neraca_calk where LEFT(kd_rek,4)='1424' and kd_skpd='$skpd') z
				on x.kd_rek=z.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	
	function load_calk_neraca_1432() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,4) IN ('1432')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,4) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1433() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,4) IN ('1433')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,4) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1442() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,4) IN ('1442')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,4) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_1443() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,4) IN ('1443')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,4) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_211() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,3) IN ('211')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,3) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_212() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,3) IN ('212')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,3) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_213() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,3) IN ('213')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,3) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	
	function load_calk_neraca_221() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,3) IN ('221')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,3) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_231() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,3) IN ('231')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,3) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_232() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,3) IN ('232')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,3) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_neraca_233() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT y.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,3) IN ('233')) x 
				INNER JOIN (
				SELECT LEFT(kd_rek,3) kd_rek5, kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek5";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_lpe_314() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT x.kd_rek, x.nm_rek, y.ket FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE LEFT(kd_rek,3) IN ('314')) x 
				LEFT JOIN (
				SELECT kd_rek, ket FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	//PINDAH
	function load_calk_kas_terima() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT x.kd_rek, x.nm_rek, y.ket, y.kd_rinci FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE kd_rek='111') x 
				LEFT JOIN (
				SELECT kd_rek, ket, kd_rinci FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek
				order by kd_rinci";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	//PINDAH
	function load_calk_kas_keluar() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND kd_rek LIKE '%$kriteria%' OR nm_rek LIKE '%$kriteria%'";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT x.kd_rek, x.nm_rek, y.ket, y.kd_rinci FROM (
				SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE kd_rek='112') x 
				LEFT JOIN (
				SELECT kd_rek, ket, kd_rinci FROM isi_neraca_calk where kd_skpd='$skpd') y
				on x.kd_rek=y.kd_rek
				order by kd_rinci";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	
	
	function load_calk_pendapatan_411() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT a.kd_skpd,a.kd_ang,a.kd_rek5, a.nm_rek5, b.ket1, b.ket2 FROM (
				Select kd_skpd, left(kd_ang,5) kd_ang, left(kd_rek5,5) kd_rek5,(select nm_rek4 from ms_rek4 where kd_rek4=left(kd_ang,5)) nm_rek5
				FROM (
				select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5 from
				(select a.kd_skpd, a.kd_rek5, b.kd_rek64
				from 
				(select kd_skpd, kd_rek5 from trdrka_pend where left(kd_rek5,1)=4)
				a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
				where a.kd_skpd='$skpd'
				group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
				LEFT JOIN
				(select b.kd_skpd, a.kd_rek5, a.map_real
				from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
				where left(a.kd_rek5,1)=4 and a.kd_unit='$skpd' 
				group by kd_skpd, a.kd_rek5, a.map_real)
				b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
				WHERE kd_skpd='$skpd' and LEFT(kd_rek5,3)='411'
				GROUP BY kd_skpd, left(kd_ang,5), left(kd_rek5,5) ) a
				LEFT JOIN 
				(select * from lamp_calk_at where kd_skpd='$skpd') b
				on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.kd_rek5 and a.kd_ang=b.kd_ang";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_ang' => $resulte['kd_ang'],        
                        'kd_rek5' => $resulte['kd_rek5'],        
                        'nm_rek5' => $resulte['nm_rek5'],        
                        'ket1' => $resulte['ket1'],        
                        'ket2' => $resulte['ket2']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_pendapatan_412() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT a.kd_skpd,a.kd_ang,a.kd_rek5, a.nm_rek5, b.ket1, b.ket2 FROM (
				Select kd_skpd, left(kd_ang,5) kd_ang, left(kd_rek5,5) kd_rek5,(select nm_rek4 from ms_rek4 where kd_rek4=left(kd_ang,5)) nm_rek5
				FROM (
				select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5 from
				(select a.kd_skpd, a.kd_rek5, b.kd_rek64
				from 
				(select kd_skpd, kd_rek5 from trdrka_pend where left(kd_rek5,1)=4)
				a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
				where a.kd_skpd='$skpd'
				group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
				LEFT JOIN
				(select b.kd_skpd, a.kd_rek5, a.map_real
				from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
				where left(a.kd_rek5,1)=4 and a.kd_unit='$skpd' 
				group by kd_skpd, a.kd_rek5, a.map_real)
				b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
				WHERE kd_skpd='$skpd' and LEFT(kd_rek5,3)='412'
				GROUP BY kd_skpd, left(kd_ang,5), left(kd_rek5,5) ) a
				LEFT JOIN 
				(select * from lamp_calk_at where kd_skpd='$skpd') b
				on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.kd_rek5 and a.kd_ang=b.kd_ang";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_ang' => $resulte['kd_ang'],        
                        'kd_rek5' => $resulte['kd_rek5'],        
                        'nm_rek5' => $resulte['nm_rek5'],        
                        'ket1' => $resulte['ket1'],        
                        'ket2' => $resulte['ket2']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
//baru_galih	
	function load_calk_pendapatan_414() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "SELECT a.kd_skpd,a.kd_ang,a.kd_rek5, a.nm_rek5, b.ket1, b.ket2 FROM (
				Select kd_skpd, left(kd_ang,5) kd_ang, left(kd_rek5,5) kd_rek5,(select nm_rek4 from ms_rek4 where kd_rek4=left(kd_ang,5)) nm_rek5
				FROM (
				select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5 from
				(select a.kd_skpd, a.kd_rek5, b.kd_rek64
				from 
				(select kd_skpd, kd_rek5 from trdrka_pend where left(kd_rek5,1)=4)
				a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
				where a.kd_skpd='$skpd'
				group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
				LEFT JOIN
				(select b.kd_skpd, a.kd_rek5, a.map_real
				from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
				where left(a.kd_rek5,1)=4 and a.kd_unit='$skpd' 
				group by kd_skpd, a.kd_rek5, a.map_real)
				b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
				WHERE kd_skpd='$skpd' and LEFT(kd_rek5,3)='414'
				GROUP BY kd_skpd, left(kd_ang,5), left(kd_rek5,5) ) a
				LEFT JOIN 
				(select * from lamp_calk_at where kd_skpd='$skpd') b
				on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.kd_rek5 and a.kd_ang=b.kd_ang";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],        
                        'kd_ang' => $resulte['kd_ang'],        
                        'kd_rek5' => $resulte['kd_rek5'],        
                        'nm_rek5' => $resulte['nm_rek5'],        
                        'ket1' => $resulte['ket1'],        
                        'ket2' => $resulte['ket2']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function simpan_pend_calk() {
		
            $tabel          = $this->input->post('tabel');
            $lckolom        = $this->input->post('kolom');
            $lcnilai        = $this->input->post('nilai');
            $cid            = $this->input->post('cid');
            $lcid           = $this->input->post('lcid');
            $skpd           = $this->session->userdata('kdskpd');
            $kd_ang         = $this->input->post('kd_ang');
            $kd_rek5        = $this->input->post('kd_rek5');
			
			
			
			$sql = "delete from lamp_calk_at where kd_skpd='$skpd' and kd_ang='$kd_ang' and kd_rek5='$kd_rek5'";
            $asg = $this->db->query($sql);
            if ($asg){
				$sql        = "insert into $tabel $lckolom values $lcnilai";
				$asg       	 = $this->db->query($sql);
				if ( $asg > 0 ) {
					echo '2';
				} else {
					echo '0';
					exit();
				}
			}
		
	}
	
	//PINDAH
	function get_nourut() {
		$skpd = $this->session->userdata('kdskpd');
		$kd_rek = $this->input->post('kd_rek5');
		
		$query1 = $this->db->query("select COUNT(kd_skpd)+1 nomor FROM isi_neraca_calk WHERE kd_skpd='$skpd' and kd_rek='$kd_rek'");
	    $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
            $result = array(
                        'id' => $ii,        
                        'no_urut' => $resulte['nomor']
                        );
                        $ii++;
        }
		
        echo json_encode($result);
    	$query1->free_result();  
			
	}
	
	function get_nourut_lamp() {
		$skpd = $this->session->userdata('kdskpd');
		$kd_rek = $this->input->post('kd_rek5');
		
		$query1 = $this->db->query("select COUNT(kd_skpd)+1 nomor FROM isi_analisis_calk WHERE kd_skpd='$skpd' and kd_rek='$kd_rek'");
	    $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
            $result = array(
                        'id' => $ii,        
                        'no_urut' => $resulte['nomor']
                        );
                        $ii++;
        }
		
        echo json_encode($result);
    	$query1->free_result();  
			
	}
	
	
	function simpan_neraca_calk() {
		
            $tabel          = $this->input->post('tabel');
            $kd_rek          = $this->input->post('kd_rek');
            $lckolom        = $this->input->post('kolom');
            $lcnilai        = $this->input->post('nilai');
            $skpd           = $this->session->userdata('kdskpd');

				$sql        = "insert into $tabel $lckolom values $lcnilai";
				$asg       	 = $this->db->query($sql);
				if ( $asg > 0 ) {
					echo '2';
				} else {
					echo '0';
					exit();
				}
			
		
	}
	
	
	function simpan_beban_calk() {
		
            $tabel          = $this->input->post('tabel');
            $lckolom        = $this->input->post('kolom');
            $lcnilai        = $this->input->post('nilai');
            $cid            = $this->input->post('cid');
            $lcid           = $this->input->post('lcid');
            $skpd           = $this->session->userdata('kdskpd');
            $kd_ang         = $this->input->post('kd_ang');
            $kd_rek5        = $this->input->post('kd_rek');
			
			
			
			$sql = "delete from $tabel where kd_skpd='$skpd' and kd_rek='$kd_rek5'";
            $asg = $this->db->query($sql);
            if ($asg){
				$sql        = "insert into $tabel $lckolom values $lcnilai";
				$asg       	 = $this->db->query($sql);
				if ( $asg > 0 ) {
					echo '2';
				} else {
					echo '0';
					exit();
				}
			}
		
	}
	
	function simpan_calk_babiv() {
		
            $tabel          = $this->input->post('tabel');
            $lckolom        = $this->input->post('kolom');
            $lcnilai        = $this->input->post('nilai');
            $cid            = $this->input->post('cid');
            $lcid           = $this->input->post('lcid');
            $skpd           = $this->session->userdata('kdskpd');
            $kd_rek        = $this->input->post('kd_rek');
			
			
			
			$sql = "delete from $tabel where kd_skpd='$skpd' and kd_rek='$kd_rek'";
            $asg = $this->db->query($sql);
            if ($asg){
				$sql        = "insert into $tabel $lckolom values $lcnilai";
				$asg       	 = $this->db->query($sql);
				if ( $asg > 0 ) {
					echo '2';
				} else {
					echo '0';
					exit();
				}
			}
		
	}
	
	function load_calk_beban_911() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a   
				LEFT JOIN
				(select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$skpd') b
				on a.kd_rek=b.kd_rek
				where LEFT(a.kd_rek,3)='911'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')      
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_lo_811() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_lo_calk a   
				LEFT JOIN
				(select kd_rek, nm_rek, nilai from nilai_lo_calk where kd_skpd='$skpd') b
				on a.kd_rek=b.kd_rek
				where LEFT(a.kd_rek,3)='811'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')      
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_lo_812() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_lo_calk a   
				LEFT JOIN
				(select kd_rek, nm_rek, nilai from nilai_lo_calk where kd_skpd='$skpd') b
				on a.kd_rek=b.kd_rek
				where LEFT(a.kd_rek,3)='812'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')      
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_lo_813() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_lo_calk a   
				LEFT JOIN
				(select kd_rek, nm_rek, nilai from nilai_lo_calk where kd_skpd='$skpd') b
				on a.kd_rek=b.kd_rek
				where LEFT(a.kd_rek,3)='813'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')      
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_beban_912() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
				LEFT JOIN
				(select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$skpd') b
				on a.kd_rek=b.kd_rek
				where LEFT(a.kd_rek,4) in ('9127','9128')";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')      
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_beban_913() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
				LEFT JOIN
				(select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$skpd') b
				on a.kd_rek=b.kd_rek
				where (LEFT(a.kd_rek,4) in ('9135','9136') or LEFT(a.kd_rek,5) in ('91311','91312'))";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')      
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_beban_918() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai, ISNULL(b.nilai2,0) nilai2 from ket_beban_calk a  
				LEFT JOIN
				(select kd_rek, nm_rek, nilai, nilai2 from nilai_beban_calk where kd_skpd='$skpd') b
				on a.kd_rek=b.kd_rek
				where LEFT(a.kd_rek,3)='918'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',','),      
                        'nilai2' => number_format($resulte['nilai2'])      
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_beban_914() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
				LEFT JOIN
				(select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$skpd') b
				on a.kd_rek=b.kd_rek
				where LEFT(a.kd_rek,4) in ('9143','9144')";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_beban_915() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
				LEFT JOIN
				(select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$skpd') b
				on a.kd_rek=b.kd_rek
				where LEFT(a.kd_rek,3) in ('915')";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'nilai' => number_format($resulte['nilai'],2,'.',',')
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_babiv() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select b.kd_skpd, a.kd_rek, a.nm_rek, b.ket from penjelasan_calk a  
					LEFT JOIN
					(select kd_skpd, kd_rek, ket from isi_penjelasan_calk where kd_skpd='$skpd') b
					on a.kd_rek=b.kd_rek
					WHERE LEFT(a.kd_rek,1)='4'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],         
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	function load_calk_814() {
		$skpd     = $this->session->userdata('kdskpd');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
		
		$sql = "select b.kd_skpd, a.kd_rek, a.nm_rek, b.ket from penjelasan_calk a  
					LEFT JOIN
					(select kd_skpd, kd_rek, ket from isi_penjelasan_calk where kd_skpd='$skpd') b
					on a.kd_rek=b.kd_rek
					WHERE LEFT(a.kd_rek,1)='8'";
		$query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
            $row[] = array(  
                        'id' => $ii,        
                        'kd_skpd' => $resulte['kd_skpd'],         
                        'kd_rek' => $resulte['kd_rek'],        
                        'nm_rek' => $resulte['nm_rek'],        
                        'ket' => $resulte['ket']        
                        );
                        $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
    }
	
	
	function cetak_kata_pengantar($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
        $spasi = "line-height: 1.5em;";
		
		$thn_ang = $this->session->userdata('pcThang');
        $lcskpd = $kd_skpd;
        $skpd = $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        
		$lcttd = str_replace('a',' ',$ttd);
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$lcskpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$lcskpd' and kode IN ('PA','KPA') and nip='$lcttd'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
                    <TR>
						<TD align="center" ><b>KATA PENGANTAR</TD>
					</TR>
					</TABLE><br/>';
			$cRet .='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="10" align=center> 
						<TR><TD align="justify">
						 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.$skpd.' Provinsi Kalimantan Barat adalah salah satu entitas akuntansi dari Pemerintah Provinsi Kalimantan Barat yang berkewajiban menyelenggarakan akuntansi dan menyampaikan laporan pertanggungjawaban atas pelaksanaan Anggaran Pendapatan dan Belanja Daerah dengan menyusun laporan keuangan berupa Laporan Realisasi Anggaran, Neraca, Laporan Operasional, Laporan Perubahan Ekuitas dan Catatan atas Laporan Keuangan.<br><br>
						 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Penyusunan Laporan Keuangan '.$skpd.' Provinsi Kalimantan Barat disajikan sesuai dengan peraturan pemerintah yang mengatur tentang Standar Akuntansi Pemerintah sebagaimana diamanatkan Undang-undang Nomor 17 tahun 2013 tentang Keuangan Negara, Peraturan Pemerintah Nomor 24 Tahun 2005 yang telah diubah dengan perturan Pemerintah Nomor 71 Tahun 2010 tentang Standar Akuntansi Pemerintahan, Peraturan Pemerintah Nomor 58 Tahun 2005 tentang Pengelolaan Keuangan Daerah dan Peraturan Menteri Dalam Negeri Nomor 13 Tahun 2006 tentang Pedoman Pengelolaan Keuangan Daerah, sebagaimana telah diubah beberapa kali dan terakhir dengan Peraturan Menteri Dalam Negeri Nomor 21 Tahun 2011, dan Peraturan Menteri Dalam Negeri Nomor 64 Tahun 2013 tentang Penerapan Standar Akuntansi Pemerintahan Berbasis Akrual.<br><br>
						 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Laporan Keuangan ini diharapkan dapat memberikan informasi yang berguna kepada para pengguna laporan khususnya sebagai sarana untuk meningkatkan akuntabilitas/ pertanggungjawaban dan transparansi, kami akan terus berupaya untuk dapat menyusun dan menyajikan Laporan Keuangan '.$skpd.' Provinsi Kalimantan Barat yang tepat waktu dan akurat sehingga terwujud tata kelola pemerintahan yang baik (good governance).
						</TD></TR>
			</TABLE></br>';

			$cRet.='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="1" align=center> 
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$daerah.', '.$this->tukd_model->tanggal_format_indonesia($dcetak).'</TD>
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$jabatan.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$nama.'</TD> 
					</TR>					
					</TABLE>
					';
						
			$cRet .='</TABLE>';
			$ctk=0;
			$data['prev']= 'KATA PENGANTAR';
             switch ($ctk){
				case 0;
				echo ("<title>Kata Pengantar</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
			}
		}
	
	function cetak_daftar_isi($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
			$spasi = "line-height: 1.5em;";
			
			$cRet ='<TABLE style="border-collapse:collapse;" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
                    <TR>
						<TD align="center" ><b>DAFTAR ISI</TD>
					</TR>
					</TABLE><br/>';
			$cRet .='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="1" align=center> 
						<TR>
							<TD align="left" colspan="5">Kata Pengantar</TD>
						</TR>
						<TR>
							<TD align="left" colspan="5">Daftar Isi</TD>
						</TR>
						<TR>
							<TD align="left" colspan="5">Pernyataan Tanggung Jawab</TD>
						</TR>
						<TR>
							<TD align="left" colspan="5">Ringkasan Laporan Keuangan</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">I</TD>
							<TD align="left" colspan="4">Laporan Realisasi Anggaran</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">II</TD>
							<TD align="left" colspan="4">Laporan Operasional</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">III</TD>
							<TD align="left" colspan="4">Neraca</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">IV</TD>
							<TD align="left" colspan="4">Laporan Perubahan Ekuitas</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">V</TD>
							<TD align="left" colspan="4">Catatan atas Laporan Keuangan</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="9%">Bab I</TD>
							<TD align="left" colspan="3">Pendahuluan</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="4%">&nbsp;</TD>
							<TD align="left" width="3%">1.1.</TD>
							<TD align="left" colspan="2">Maksud dan tujuan penyusunan laporan keuangan</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="4%">&nbsp;</TD>
							<TD align="left" width="3%">1.2.</TD>
							<TD align="left" colspan="2">Landasan hukum penyusunan laporan keuangan</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="4%">&nbsp;</TD>
							<TD align="left" width="3%">1.3.</TD>
							<TD align="left" colspan="2">Sistematika penulisan catatan atas laporan keuangan</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="9%">Bab II</TD>
							<TD align="left" colspan="3">Ikhtisar pencapaian kinerja keuangan</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="4%">&nbsp;</TD>
							<TD align="left" width="3%">2.1.</TD>
							<TD align="left" colspan="2">Ikhtisar realisasi pencapaian target kinerja keuangan</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="4%">&nbsp;</TD>
							<TD align="left" width="3%">2.2.</TD>
							<TD align="left" colspan="2">Hambatan dan kendala yang ada dalam pencapaian target yang telah ditetapkan.</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="9%">Bab III</TD>
							<TD align="left" colspan="3">Penjelasan pos-pos laporan keuangan</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="4%">&nbsp;</TD>
							<TD align="left" width="3%">3.1.</TD>
							<TD align="left" colspan="2">Rincian dan penjelasan masing-masing pos-pos laporan keuangan.</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="4%">&nbsp;</TD>
							<TD align="left" width="3%">&nbsp;</TD>
							<TD align="left" width="4%">3.1.1.</TD>
							<TD align="left">Laporan Realisasi Anggaran</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="4%">&nbsp;</TD>
							<TD align="left" width="3%">&nbsp;</TD>
							<TD align="left" width="4%">3.1.2.</TD>
							<TD align="left">Laporan Operasional</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="4%">&nbsp;</TD>
							<TD align="left" width="3%">&nbsp;</TD>
							<TD align="left" width="4%">3.1.3.</TD>
							<TD align="left">Neraca</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="4%">&nbsp;</TD>
							<TD align="left" width="3%">&nbsp;</TD>
							<TD align="left" width="4%">3.1.4.</TD>
							<TD align="left">Laporan Perubahan Ekuitas</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="9%">Bab IV </TD>
							<TD align="left" colspan="3">Penjelasan atas informasi-informasi non keuangan.</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="left" width="9%">Bab V </TD>
							<TD align="left" colspan="3">Penutup.</TD>
						</TR>
			</TABLE></br>';

	
			$ctk=0;
			$data['prev']= 'DAFTAR ISI';
             switch ($ctk){
				case 0;
				echo ("<title>DAFTAR ISI</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
			}
		}
	
	function cetak_pernyataan_tanggung_jawab($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
        $spasi = "line-height: 1.5em;";
		
		$thn_ang = $this->session->userdata('pcThang');
        $lcskpd = $kd_skpd;
        $skpd = $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        
		$lcttd = str_replace('a',' ',$ttd);
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$lcskpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$lcskpd' and kode IN ('PA','KPA') and nip='$lcttd'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
                    <TR>
						<TD align="center" ><b>PERNYATAAN TANGGUNG JAWAB</TD>
					</TR>
					</TABLE><br/>';
			$cRet .='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="10" align=center> 
						<TR><TD align="justify">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Laporan Keuangan '.$skpd.' Provinsi Kalimantan Barat yang terdiri dari: (a) Laporan Realisasi Anggaran, (b) Laporan Operasional, (c) Neraca, (d) Laporan Perubahan Ekuitas, dan (e) Catatan atas Laporan Keuangan Tahun Anggaran '.$thn_ang.' sebagaimana terlampir adalah merupakan tanggung jawab kami.<br><br>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Laporan Keuangan tersebut telah disusun berdasarkan sistem pengendalian intern yang memadai, dan isinya telah menyajikan informasi pelaksanaan anggaran dan posisi keuangan dan Catatan atas Laporan Keuangan secara layak sesuai dengan Standar Akuntansi Pemerintahan.
						</TD></TR>
			</TABLE></br>';

			$cRet.='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="1" align=center> 
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$daerah.', '.$this->tukd_model->tanggal_format_indonesia($dcetak).'</TD>
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$jabatan.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$nama.'</TD> 
					</TR>					
					</TABLE>
					';
						
			$cRet .='</TABLE>';
			$ctk=0;
			$data['prev']= 'PERNYATAAN TANGGUNG JAWAB';
             switch ($ctk){
				case 0;
				echo ("<title>PERNYATAAN TANGGUNG JAWAB</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
			}
		}
	
	function cetak_ringkasan_lk($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
        $spasi = "line-height: 1.5em;";
		
		$thn_ang = $this->session->userdata('pcThang');
        $skpd = $this->tukd_model->get_nama($kd_skpd,'nm_skpd','ms_skpd','kd_skpd');
		$lcttd = str_replace('a',' ',$ttd);
		
		$tanggal  =  substr($dcetak,8,2);
		$cbulan  = substr($dcetak,5,2);
        
		if($cbulan== 12){
		$sumber_data= "_at";
		$trdju = "trdju_calk";
        $trhju = "trhju_calk";
		}else{
		$sumber_data= "";
		$trdju = "trdju";
        $trhju = "trhju";
		}
		
		$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
		
		$thn_ang_1	= $thn_ang-1;
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
				
		$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 0
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 0
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 0
					   else 1 end as anggaran from trhrka where kd_skpd='$kd_skpd'";
		
		$sqlanggaran=$this->db->query($sqlanggaran1);
		foreach ($sqlanggaran->result() as $rowttd)
			{
				$anggaran=$rowttd->anggaran;
			}

		$ag_tox=$anggaran;
		
		//Untuk LRA Pendapatan
		$sql41="SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM data_realisasi_n_at($cbulan,$ag_tox,$thn_ang) WHERE left(kd_rek5,1)='4' and kd_skpd='$kd_skpd' ";
		$query41 = $this->db->query($sql41);
		$jmlp = $query41->row();
		$jmlangpend = $jmlp->angaran;
		$jmlpend = $jmlp->nilai;
		$jmlpend1= number_format($jmlp->nilai,"2",",",".");
		$jmlangpend1= number_format($jmlp->angaran,"2",",",".");
		
		$real_pend = $jmlangpend - $jmlpend;
		if ($real_pend < 0){
			$x002_pend="("; $real_pendx=$real_pend*-1; $y002_pend=")";}
		else {
			$x002_pend=""; $real_pendx=$real_pend; $y002_pend="";}
		$selisihpend = number_format($real_pendx,"2",",",".");
		if ($jmlpend==0){
			$tmp002_pend=1;
		}else{
			$tmp002_pend=$jmlpend;
		}
		
		$per002_pend     = ($jmlangpend!=0)?($jmlpend / $jmlangpend ) * 100:0; 
		$persen002_pend  = number_format($per002_pend,"2",",",".");
		
		//Untuk LRA Belanja
		$sql51="SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM data_realisasi_n_at($cbulan,$ag_tox,$thn_ang) WHERE left(kd_rek5,1)='5' and kd_skpd='$kd_skpd' ";
		$query51 = $this->db->query($sql51);
		$jmlb = $query51->row();
		$jmlangbelanja = $jmlb->angaran;
		$jmlbelanja = $jmlb->nilai;
		$jmlbelanja1= number_format($jmlb->nilai,"2",",",".");
		$jmlangbelanja1= number_format($jmlb->angaran,"2",",",".");
		
		$real_belanja = $jmlangbelanja - $jmlbelanja;
		if ($real_belanja < 0){
			$x002="("; $real_belanjax=$real_belanja*-1; $y002=")";}
		else {
			$x002=""; $real_belanjax=$real_belanja; $y002="";}
		$selisihbelanja = number_format($real_belanjax,"2",",",".");
		if ($jmlbelanja==0){
			$tmp002=1;
		}else{
			$tmp002=$jmlbelanja;
		}
		
		$per002     = ($jmlangbelanja!=0)?($jmlbelanja / $jmlangbelanja ) * 100:0; 
		$persen002  = number_format($per002,"2",",",".");
		
			
		//Untuk Neraca
		$sqllo10="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
		$querylo10= $this->db->query($sqllo10);
		$pen8 = $querylo10->row();
		$pen_lalu8 = $pen8->nilai;
		$pen_lalu81= number_format($pen8->nilai,"2",",",".");
	
		$sqllo12="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
		$querylo12= $this->db->query($sqllo12);
		$bel10 = $querylo12->row();
		$bel_lalu10 = $bel10->nilai;
		$bel_lalu101= number_format($bel10->nilai,"2",",",".");

		$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//aba			
		$hasil = $this->db->query($sql_lalu); 
		$nawal = 0 ;
		foreach ($hasil->result() as $row001)
		{
		   $kd_rek   =$row001->nor ;
		   $parent   =$row001->parent;
		   $nama     =$row001->uraian;
		   $lpe_ll1  =$row001->thn_m1;
		}
					
		$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
		$hasil = $this->db->query($sqllpe_lalu1); 
		$nawal = 0 ;
		foreach ($hasil->result() as $row002)
		{
		   $kd_rek   =$row002->nor ;
		   $parent   =$row002->parent;
		   $nama     =$row002->uraian;
		   $lpe_ll2  =$row002->thn_m1;
		}					

		$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
		$hasil = $this->db->query($sqllpe_lalu2); 
		$nawal = 0 ;
		foreach ($hasil->result() as $row003)
		{
		   $kd_rek   =$row003->nor ;
		   $parent   =$row003->parent;
		   $nama     =$row003->uraian;
		   $lpe_ll3  =$row003->thn_m1;
		}
				
		$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM $trdju a INNER JOIN $trhju b ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang' and b.tabel=1 and reev=0 and kd_skpd='$kd_skpd'");  
		foreach($query3->result_array() as $res2){
			 $debet3=$res2['debet'];
			 $kredit3=$res2['kredit'];
		}
	
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

		$sqllo9="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
		$querylo9= $this->db->query($sqllo9);
		$penlo7 = $querylo9->row();
		$pen_lo7 = $penlo7->nilai;
		$pen_lo71= number_format($penlo7->nilai,"2",",",".");
	
		$sqllo10="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
		$querylo10= $this->db->query($sqllo10);
		$penlo8 = $querylo10->row();
		$pen_lo_lalu8 = $penlo8->nilai;
		$pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
	
		$sqllo11="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
		$querylo11= $this->db->query($sqllo11);
		$bello9 = $querylo11->row();
		$bel_lo9 = $bello9->nilai;
		$bel_lo91= number_format($bello9->nilai,"2",",",".");
	
	$sqllo12="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
				$querylo12= $this->db->query($sqllo12);
				$bello10 = $querylo12->row();
				$bel_lo_lalu10 = $bello10->nilai;
				$bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

				$surplus_lo3 = $pen_lo7 - $bel_lo9;
				
				$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
				
				$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
				
		$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
				inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
						
				$hasil = $this->db->query($sql_lalu); 
				$nawal = 0 ;
				foreach ($hasil->result() as $row001)
				{
				   $kd_rek   =$row001->nor ;
				   $parent   =$row001->parent;
				   $nama     =$row001->uraian;
				   $lpe_lalu1  =$row001->thn_m1;
				}
					
		$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
				inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
						
				$hasil = $this->db->query($sqllpe_lalu1); 
				$nawal = 0 ;
				foreach ($hasil->result() as $row002)
				{
				   $kd_rek   =$row002->nor ;
				   $parent   =$row002->parent;
				   $nama     =$row002->uraian;
				   $lpe_lalu2  =$row002->thn_m1;
				}					

		$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
				inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
						
				$hasil = $this->db->query($sqllpe_lalu2); 
				$nawal = 0 ;
				foreach ($hasil->result() as $row003)
				{
				   $kd_rek   =$row003->nor ;
				   $parent   =$row003->parent;
				   $nama     =$row003->uraian;
				   $lpe_lalu3  =$row003->thn_m1;
				}

		$sal_awal = $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;					

		$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and kd_skpd='$kd_skpd'";//aba			
		$hasil = $this->db->query($sql); 
		$nawal = 0 ;
		foreach ($hasil->result() as $row001)
		{
		   $kd_rek   =$row001->nor ;
		   $parent   =$row001->parent;
		   $nama     =$row001->uraian;
		   $nilaiDR  =$row001->thn_m1;
		}
					
		$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and kd_skpd='$kd_skpd'";//Henri_TB				
		$hasil = $this->db->query($sqllpe1); 
		$nawal = 0 ;
		foreach ($hasil->result() as $row002)
		{
		   $kd_rek   =$row002->nor ;
		   $parent   =$row002->parent;
		   $nama     =$row002->uraian;
		   $nilailpe1  =$row002->thn_m1;
		}					

		$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and kd_skpd='$kd_skpd'";//Henri_TB			
		$hasil = $this->db->query($sqllpe2); 
		$nawal = 0 ;
		foreach ($hasil->result() as $row003)
		{
		   $kd_rek   =$row003->nor ;
		   $parent   =$row003->parent;
		   $nama     =$row003->uraian;
		   $nilailpe2  =$row003->thn_m1;
		}
	
		$sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

		$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher
		and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
						
				$hasil = $this->db->query($sqlutang); 
				foreach ($hasil->result() as $row)
				{
				   $nilaiutang  =$row->thn_m1;
				}					
		
		$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
		and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
						
				$hasil = $this->db->query($sqlkas); 
				foreach ($hasil->result() as $row)
				{
				   $rk_ppkd  =$row->thn_m1;
				}
		
		$sqlskpd = "select isnull(sum(debet-kredit),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
		and b.kd_unit=a.kd_skpd where kd_rek5=1180101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
						
				$hasil = $this->db->query($sqlskpd); 
				foreach ($hasil->result() as $row)
				{
				   $rk_skpd  =$row->thn_m1;
				}

		$sqllcr = "select isnull(sum(debet-kredit),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
		and b.kd_unit=a.kd_skpd where left(kd_rek5,2)=11 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
						
				$hasil = $this->db->query($sqllcr); 
				foreach ($hasil->result() as $row)
				{
				   $lcrx =$row->thn_m1;
				}
				
		$sqlast = "select isnull(sum(debet-kredit),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
		and b.kd_unit=a.kd_skpd where left(kd_rek5,1)=1 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd'";//Henri_TB
						
				$hasil = $this->db->query($sqlast); 
				foreach ($hasil->result() as $row)
				{
				   $astx  =$row->thn_m1;
				}		
		
		$lcr		= $lcrx-$rk_skpd;
		$ast		= $astx-$rk_skpd;
		$eku 		= $sal_akhir + $rk_ppkd;					
		$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;					

				if ($sal_akhir < 0)
				{
					$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
				} else
				{
					$c = ""; $sal_akhir; $d = "";
				}
				
				$sal_akhir1= number_format($sal_akhir,"2",",",".");
			
				if ($sal_awal < 0)
				{
					$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
				} else
				{
					$c1 = ""; $sal_awal; $d1 = "";
				}		
				
				$sal_awal1= number_format($sal_awal,"2",",",".");
	
	
	$eku1=number_format($eku,"2",",",".");
	$eku_tang1=number_format($eku_tang,"2",",",".");		
	$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
	$lcr1=number_format($lcr,"2",",",".");
	
	if ($ast < 0){
					$min019="("; $ast=$ast*-1; $min020=")";
					}else {
					$min019=""; $ast; $min020="";
					}			

	$ast1=number_format($ast,"2",",",".");
		
		//--aset lancar--			
		$q = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
								and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd' and
									(kd_rek5 like '111%' or kd_rek5 like '112%'  or 
									kd_rek5 like '113%' or kd_rek5 like '114%'  or 
									kd_rek5 like '115%' or kd_rek5 like '116%'  or 
									kd_rek5 like '117%' or kd_rek5 like '118%') ");  

			 foreach($q->result_array() as $r){
				$debet=$r['debet'];
				$kredit=$r['kredit'];
			 }
			
			if ($debet=='') $debet=0;
			if ($kredit=='') $kredit=0;

			
			$nl=$debet-$kredit;
			
			if ($nl=='') $nl=0;
			
			$aset_lancar= number_format($nl,"2",",",".");
   
		//--aset tetap--
		$q2 = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
								and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd' and
									(kd_rek5 like '13%') ");  

			 foreach($q2->result_array() as $r2){
				$debet2=$r2['debet'];
				$kredit2=$r2['kredit'];
			 }
			
			if ($debet2=='') $debet2=0;
			if ($kredit2=='') $kredit2=0;

			
			$nl2=$debet2-$kredit2;
			
			if ($nl2=='') $nl2=0;

			
		$aset_tetap= number_format($nl2,"2",",",".");
		   
		//--aset lainnya--
		$q3 = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
								and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd' and
									(kd_rek5 like '15%') ");  

			 foreach($q3->result_array() as $r3){
				$debet3=$r3['debet'];
				$kredit3=$r3['kredit'];
			 }
			
			if ($debet3=='') $debet3=0;
			if ($kredit3=='') $kredit3=0;

			
			$nl3=$debet3-$kredit3;
			
			if ($nl3=='') $nl3=0;

			
		$aset_lainnya= number_format($nl3,"2",",",".");	
				
		//--kewajiban--
		$q4 = $this->db->query(" SELECT SUM(b.debet) AS debet,SUM(b.kredit) AS kredit from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
								and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and kd_skpd='$kd_skpd' and
									(kd_rek5 like '2%') ");  

			 foreach($q4->result_array() as $r4){
				$debet4=$r4['debet'];
				$kredit4=$r4['kredit'];
			 }
			
			if ($debet4=='') $debet4=0;
			if ($kredit4=='') $kredit4=0;

			
			$nl4=$kredit4-$debet4;
			
			if ($nl4=='') $nl4=0;

			
		$kewajiban= number_format($nl4,"2",",",".");	
		
		//LO
		//--pend--
		$quelo01   = "SELECT SUM(kredit-debet) as nilai FROM $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ('811','812','813','814','831','832','833')) and year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and kd_skpd='$kd_skpd'";
		$quelo02 = $this->db->query($quelo01);
		$quelo03 = $quelo02->row();
		$nil     = $quelo03->nilai;
		
		if($nil>0){
			$rp = "Rp. ";
			$jml_pend_lo    = number_format($quelo03->nilai,"2",",",".");
		}else{
			$rp = "";
			$jml_pend_lo    = number_format(0,"2",",",".");;
		}
		
		//--beban--
		$quelo012   = "SELECT SUM(debet-kredit) as nilai FROM $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ('911','912','913','914','915','916','917','918','919','921','922','923','924','925','926')) and year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and kd_skpd='$kd_skpd'";
		$quelo022 = $this->db->query($quelo012);
		$quelo032 = $quelo022->row();
		$nil2     = $quelo032->nilai;
				
		$jml_beban_lo    = number_format($quelo032->nilai,"2",",",".");
				
		//--surplus+defisit--
		$quelo013   = "SELECT SUM(kredit-debet) as nilai FROM $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ('811','812','813','814','831','832','833','911','912','913','914','915','916','917','918','919','921','922','923','924','925','926') OR left(kd_rek5,5) in ('82101','82102','82103','82104','82201','82203')) and year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and kd_skpd='$kd_skpd'";
		$quelo023 = $this->db->query($quelo013);
		$quelo033 = $quelo023->row();
		$nil3     = $quelo033->nilai;
		
		$jml_surdef_lo    = number_format($quelo033->nilai,"2",",",".");
		
		//LPE   		        
			$sqllo10="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM $trdju a INNER JOIN $trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0 and kd_skpd='$kd_skpd'");  
	        foreach($query3->result_array() as $res2){
				 $debet=$res2['debet'];
				 $kredit=$res2['kredit'];
                 				 
			 }
			 
		$real=$kredit-$debet+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

		$sqllo9="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$xbulan and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$xbulan and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;
					
            $sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$xbulan and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$xbulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$xbulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;
					
					
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3,"2",",",".");
					
                    $surplus_lo31 = number_format($surplus_lo3,"2",",",".");
					
					
			$ast_num = number_format($astx,"2",",",".");			
						
			
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
                    <TR>
						<TD align="center" ><b>RINGKASAN LAPORAN KEUANGAN</TD>
					</TR>
					</TABLE><br/>';
			$cRet .='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="10" align=center> 
						<TR><TD align="justify">
						 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Laporan Keuangan  '.$skpd.' Provinsi Kalimantan Barat Tahun Anggaran '.$thn.'  ini telah disusun dan disajikan sesuai dengan Peraturan Pemerintah Nomor 71 Tahun 2010 tentang Standar Akuntansi Pemerintahan (SAP) dan berdasarkan kaidah-kaidah pengelolaan keuangan di lingkungan Pemerintahan Provinsi Kalimantan Barat. :<br><br>
						 Laporan Keuangan ini meliputi:
						</TD></TR>
			</TABLE><br>';
			
			$cRet .='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="0" align=center> 
						<TR>
							<TD align="left" width="2%"><b>I.</TD>
							<TD align="left"><b>Laporan Realisasi Anggaran</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify">Laporan Realisasi Anggaran menggambarkan perbandingan antara anggaran dengan realisasinya, yang mencakup unsur-unsur Pendapatan-LRA dan Belanja selama periode 1 Januari sampai dengan '.$this->tukd_model->tanggal_format_indonesia($dcetak).'.</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify">Realisasi Pendapatan Daerah Tahun Anggaran '.$thn_ang.' ditargetkan sebesar Rp. '.$jmlangpend1.' terealisasi sebesar Rp. '.$jmlpend1.' atau mencapai '.$persen002_pend.'% dan Realisasi Belanja Daerah pada Tahun Anggaran '.$thn_ang.' adalah sebesar Rp. '.$jmlbelanja1.' atau mencapai '.$persen002.'% dari alokasi anggaran sebesar Rp. '.$jmlangbelanja1.'</TD>
						</TR>
						<TR>
							<TD align="left" width="2%"><b>&nbsp;</TD>
							<TD align="left">&nbsp;</TD>
						</TR>
						<TR>
							<TD align="left" width="2%"><b>II.</TD>
							<TD align="left"><b>Laporan Operasional</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify">Laporan Operasional menyajikan berbagai unsur pendapatan-LO, beban, surplus/defisit dari operasi, surplus/defisit dari kegiatan nonoperasional, dan  surplus/defisit-LO, yang diperlukan untuk penyajian yang wajar.</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify">Laporan Operasional untuk tahun yang berakhir sampai dengan  '.$this->tukd_model->tanggal_format_indonesia($dcetak).' terdiri dari Pendapatan-LO sebesar '.$jml_pend_lo.', beban sebesar  '.$jml_beban_lo.' sehingga terdapat Surplus/Defisit Kegiatan Operasional sebesar '.$jml_surdef_lo.'. </TD>
						</TR>
						<TR>
							<TD align="left" width="2%"><b>&nbsp;</TD>
							<TD align="left">&nbsp;</TD>
						</TR>
						<TR>
							<TD align="left" width="2%"><b>III.</TD>
							<TD align="left"><b>Neraca</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify">Neraca menggambarkan posisi keuangan entitas mengenai aset, kewajiban, dan ekuitas pada '.$this->tukd_model->tanggal_format_indonesia($dcetak).'</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify">Nilai Aset per  '.$this->tukd_model->tanggal_format_indonesia($dcetak).' dicatat dan disajikan sebesar Rp. '.$ast_num.' yang terdiri dari: Aset Lancar sebesar Rp. '.$aset_lancar.' Aset Tetap sebesar Rp. '.$aset_tetap.' Aset Lainnya sebesar Rp. '.$aset_lainnya.'.</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify">Nilai Kewajiban sebesar Rp. '.$kewajiban.' dan Nilai Ekuitas sebesar Rp. '.$eku1.', sehingga jumlah kewajiban dan ekuitas adalah sebesar Rp. '.$eku_tang1.'</TD>
						</TR>
						<TR>
							<TD align="left" width="2%"><b>&nbsp;</TD>
							<TD align="left">&nbsp;</TD>
						</TR>
						<TR>
							<TD align="left" width="2%"><b>IV.</TD>
							<TD align="left"><b>Laporan Perubahan Ekuitas</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify">Laporan Perubahan Ekuitas menyajikan informasi kenaikan atau penurunan ekuitas tahun pelaporan dibandingkan dengan tahun sebelumnya.</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify">Ekuitas per 1 Januari '.$thn_ang.' adalah sebesar Rp. '.number_format($sal_awal,"2",",",".").' ditambah Defisit-LO sebesar   Rp. '.number_format($surplus_lo3,"2",",",".").' kemudian ditambah/dikurangi dengan Lain-lain sebesar Rp. '.number_format($nilailpe2,"2",",",".").' sehingga Ekuitas Akhir entitas '.$skpd.' Provinsi Kalimantan Barat per  '.$this->tukd_model->tanggal_format_indonesia($dcetak).' adalah sebesar Rp. '.number_format($sal_akhir,"2",",",".").'.</TD>
						</TR>
						<TR>
							<TD align="left" width="2%"><b>&nbsp;</TD>
							<TD align="left">&nbsp;</TD>
						</TR>
						<TR>
							<TD align="left" width="2%"><b>V.</TD>
							<TD align="left"><b>Catatan atas Laporan Keuangan</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify">Catatan atas Laporan Keuangan (CaLK) menyajikan informasi tentang penjelasan atau daftar terinci atau analisis atas nilai suatu pos yang disajikan dalam Laporan Realisasi Anggaran, Neraca, Laporan Operasional, dan Laporan Perubahan Ekuitas. Termasuk pula dalam CaLK adalah penyajian informasi yang diharuskan dan dianjurkan oleh Standar Akuntansi Pemerintahan serta pengungkapan-pengungkapan lainnya yang diperlukan untuk penyajian yang wajar atas laporan keuangan.</TD>
						</TR>
						<TR>
							<TD align="left" width="2%">&nbsp;</TD>
							<TD align="justify"><BR>Dalam penyajian Laporan Realisasi Anggaran untuk tahun yang berakhir sampai dengan '.$this->tukd_model->tanggal_format_indonesia($dcetak).' disusun dan disajikan berdasarkan basis kas. Sedangkan Neraca, Laporan Operasional, dan Laporan Perubahan Ekuitas untuk Tahun '.$thn_ang.' disusun dan disajikan dengan menggunakan basis akrual.
							</TD>
						</TR>
						
			</TABLE></br>';

			/* $cRet.='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center> 
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$daerah.', '.$this->tukd_model->tanggal_format_indonesia($dcetak).'</TD>
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$jabatan.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$nama.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">NIP: '.$nip.'</TD> 
					</TR>					
					</TABLE>
					'; */
						
			$cRet .='</TABLE>';
			$ctk=0;
			$data['prev']= 'RINGKASAN LAPORAN KEUANGAN';
             switch ($ctk){
				case 0;
				echo ("<title>RINGKASAN LAPORAN KEUANGAN</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
			}
		}
	
	function cetak_Ilra($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
	$spasi = "line-height: 1.5em;";	
    $thn = $this->session->userdata('pcThang');
	$cbulan  = substr($dcetak,5,2);
	$cbulan2  = 12;
	$cthnsbl  = $thn-1;
	$kd_unit = "kd_skpd";
	
	if($cbulan== 12){
	$sumber_data= "_at";
	}else{
	$sumber_data= "";
	}
	
	$lcttd = str_replace('a',' ',$ttd);
	$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    //$thn     = $rowsc->thn_ang;
                 }
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama_ttd= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
	
	$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 1
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 1
					   else 1 end as anggaran from trhrka where kd_skpd='$kd_skpd'";
    $sqlanggaran=$this->db->query($sqlanggaran1);
	foreach ($sqlanggaran->result() as $rowttd)
        {
            $anggaran=$rowttd->anggaran;
        }

	$ag_tox=$anggaran;
	
	//tlalu
        $sql41_tlalu="SELECT SUM(real_spj) as nilai FROM data_realisasi_tlalu_n$sumber_data($cbulan2,$ag_tox,$cthnsbl) WHERE left(kd_rek5,1)='4' and $kd_unit='$kd_skpd' ";
                    $query41_tlalu = $this->db->query($sql41_tlalu);
                    $jmlp_tlalu = $query41_tlalu->row();
                    $jmlpendapatan_tlalu = $jmlp_tlalu->nilai;
                    
                   
                    $jmlpendapatan1_tlalu= number_format($jmlp_tlalu->nilai,"2",",",".");
                    
					$real_pend_tlalu = $jmlpendapatan_tlalu;
                    if ($real_pend_tlalu < 0){
                    	$x001_tlalu="("; $real_pendx_tlalu=$real_pend_tlalu*-1; $y001_tlalu=")";}
                    else {
                    	$x001_tlalu=""; $real_pendx_tlalu=$real_pend_tlalu; $y001_tlalu="";}
                    $selisihpend_tlalu = number_format($real_pendx_tlalu,"2",",",".");
                    if ($jmlpendapatan_tlalu==0){
                        $tmp001_tlalu=1;
                    }else{
                        $tmp001_tlalu=$jmlpendapatan_tlalu;
                    }
					
        $sql51_tlalu="SELECT SUM(real_spj)as nilai FROM data_realisasi_tlalu_n$sumber_data($cbulan2,$ag_tox,$cthnsbl) WHERE left(kd_rek5,1) in ('5','6') and $kd_unit='$kd_skpd' ";
                    $query51_tlalu = $this->db->query($sql51_tlalu);
                    $jmlb_tlalu = $query51_tlalu->row();
                    
                    $jmlbelanja_tlalu = $jmlb_tlalu->nilai;
                    $jmlbelanja1_tlalu= number_format($jmlb_tlalu->nilai,"2",",",".");
                   
					
					$real_belanja_tlalu = $jmlbelanja_tlalu;
                    if ($real_belanja_tlalu < 0){
                    	$x002_tlalu="("; $real_belanjax_tlalu=$real_belanja_tlalu*-1; $y002_tlalu=")";}
                    else {
                    	$x002_tlalu=""; $real_belanjax_tlalu=$real_belanja_tlalu; $y002_tlalu="";}
                    $selisihbelanja_tlalu = number_format($real_belanjax_tlalu,"2",",",".");
                    if ($jmlbelanja_tlalu==0){
                        $tmp002_tlalu=1;
                    }else{
                        $tmp002_tlalu=$jmlbelanja_tlalu;
                    }
					
                   
					
        $sql523_tlalu="SELECT SUM(real_spj) as nilai FROM data_realisasi_tlalu_n$sumber_data($cbulan2,$ag_tox,$cthnsbl) WHERE left(kd_rek5,3)='523' and $kd_unit='$kd_skpd' ";
                    $query523_tlalu = $this->db->query($sql523_tlalu);
                    $jmlbm_tlalu = $query523_tlalu->row();
                    $jmlbmbelanja_tlalu = $jmlbm_tlalu->nilai;
                    
                    $jmlbmbelanja1_tlalu= number_format($jmlbmbelanja_tlalu,"2",",",".");
                    
        $sql61_tlalu="SELECT SUM(real_spj) as nilai FROM data_realisasi_tlalu_n$sumber_data($cbulan2,$ag_tox,$cthnsbl) WHERE left(kd_rek5,2)='71' and $kd_unit='$kd_skpd' ";
                    $query61_tlalu = $this->db->query($sql61_tlalu);
                    $jmlpm_tlalu = $query61_tlalu->row();
                    $jmlpmasuk_tlalu = $jmlpm_tlalu->nilai;
                    
        $sql62_tlalu="SELECT SUM(real_spj) as nilai FROM data_realisasi_tlalu_n$sumber_data($cbulan2,$ag_tox,$cthnsbl) WHERE left(kd_rek5,2)='72' and $kd_unit='$kd_skpd' ";
                    $query62_tlalu = $this->db->query($sql62_tlalu);
                    $jmlpk_tlalu = $query62_tlalu->row();
                    $jmlpkeluar_tlalu = $jmlpk_tlalu->nilai;
                    
        $surplus_tlalu =  $jmlpendapatan_tlalu- $jmlbelanja_tlalu;
           
        if ($surplus_tlalu < 0){
                    	$x_tlalu="("; $surplusx_tlalu=$surplus_tlalu*-1; $y_tlalu=")";
                        }else {
                    	$x_tlalu=""; $surplusx_tlalu=$surplus_tlalu; $y_tlalu="";
                        }
        
        $surplus1_tlalu= number_format($surplusx_tlalu,"2",",",".");
        
		
		$real_surplus_tlalu = $surplus_tlalu;
                    if ($real_surplus_tlalu < 0){
                    	$x003_tlalu="("; $real_surplusx_tlalu=$real_surplus_tlalu*-1; $y003_tlalu=")";}
                    else {
                    	$x003_tlalu=""; $real_surplusx_tlalu=$real_surplus_tlalu; $y003_tlalu="";}
        $selisihsurplus_tlalu = number_format($real_surplusx_tlalu,"2",",",".");
                    if ($surplus_tlalu==0){
                        $tmp003_tlalu=1;
                    }else{
                        $tmp003_tlalu=$surplus_tlalu;
                    }
					
                  
        $biaya_net_tlalu =  $jmlpmasuk_tlalu- $jmlpkeluar_tlalu;
             
        if ($biaya_net_tlalu < 0){
                    	$a_tlalu="("; $biaya_netx_tlalu=$biaya_net_tlalu*-1; $b_tlalu=")";
                        }else {
                    	$a_tlalu=""; $biaya_netx_tlalu=$biaya_net_tlalu; $b_tlalu="";
                        }
        
        $biaya_net1_tlalu =   number_format($biaya_netx_tlalu,"2",",",".");
        
        $silpa_tlalu= ($jmlpendapatan_tlalu+$jmlpmasuk_tlalu)-($jmlbelanja_tlalu+$jmlpkeluar_tlalu);
                   
        if ($silpa_tlalu < 0){
                    	$c_tlalu="("; $silpax_tlalu=$silpa_tlalu*-1; $d_tlalu=")";
                        }else {
                    	$c_tlalu=""; $silpax_tlalu=$silpa_tlalu; $d_tlalu="";
                        }
       
        $silpa1_tlalu =number_format($silpax_tlalu,"2",",","."); 
	
	//skrg
        $sql41="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='4' and kd_skpd='$kd_skpd' ";
                    $query41 = $this->db->query($sql41);
                    $jmlp = $query41->row();
                    $jmlpendapatan = $jmlp->nilai;
                    $jmlangpendapatan = $jmlp->anggaran;
                    $jmlangpendapatan1= number_format($jmlp->anggaran,"2",",",".");
                    $jmlpendapatan1= number_format($jmlp->nilai,"2",",",".");
                    
					$real_pend = $jmlangpendapatan - $jmlpendapatan;
                    if ($real_pend < 0){
                    	$x001="("; $real_pendx=$real_pend*-1; $y001=")";}
                    else {
                    	$x001=""; $real_pendx=$real_pend; $y001="";}
                    $selisihpend = number_format($real_pendx,"2",",",".");
                    if ($jmlpendapatan==0){
                        $tmp001=1;
                    }else{
                        $tmp001=$jmlpendapatan;
                    }
					
                    $per001     = ($jmlangpendapatan!=0)?($jmlpendapatan / $jmlangpendapatan ) * 100:0; 
                    $persen001  = number_format($per001,"2",",",".");
					
        $sql51="SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,1)='5' and kd_skpd='$kd_skpd' ";
                    $query51 = $this->db->query($sql51);
                    $jmlb = $query51->row();
                    $jmlangbelanja = $jmlb->angaran;
                    $jmlbelanja = $jmlb->nilai;
                    $jmlbelanja1= number_format($jmlb->nilai,"2",",",".");
                    $jmlangbelanja1= number_format($jmlb->angaran,"2",",",".");
					
					$real_belanja = $jmlangbelanja - $jmlbelanja;
                    if ($real_belanja < 0){
                    	$x002="("; $real_belanjax=$real_belanja*-1; $y002=")";}
                    else {
                    	$x002=""; $real_belanjax=$real_belanja; $y002="";}
                    $selisihbelanja = number_format($real_belanjax,"2",",",".");
                    if ($jmlbelanja==0){
                        $tmp002=1;
                    }else{
                        $tmp002=$jmlbelanja;
                    }
					
                    $per002     = ($jmlangbelanja!=0)?($jmlbelanja / $jmlangbelanja ) * 100:0; 
                    $persen002  = number_format($per002,"2",",",".");
					
        $sql523="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,3)='523' and kd_skpd='$kd_skpd' ";
                    $query523 = $this->db->query($sql523);
                    $jmlbm = $query523->row();
                    $jmlbmbelanja = $jmlbm->nilai;
                    $jmlangbmbelanja = $jmlbm->anggaran;
                    $jmlbmbelanja1= number_format($jmlbmbelanja,"2",",",".");
                    $jmlangbmbelanja1= number_format($jmlangbmbelanja,"2",",",".");
        $sql61="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='61' and kd_skpd='$kd_skpd' ";
                    $query61 = $this->db->query($sql61);
                    $jmlpm = $query61->row();
                    $jmlpmasuk = $jmlpm->nilai;
                    $jmlangpmasuk = $jmlpm->anggaran;
        $sql62="SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) WHERE left(kd_rek5,2)='62' and kd_skpd='$kd_skpd' ";
                    $query62 = $this->db->query($sql62);
                    $jmlpk = $query62->row();
                    $jmlpkeluar = $jmlpk->nilai;
                    $jmlangpkeluar = $jmlpk->anggaran;
        $surplus =  $jmlpendapatan- $jmlbelanja;
        $angsurplus = $jmlangpendapatan- $jmlangbelanja;        
        if ($surplus < 0){
                    	$x="("; $surplusx=$surplus*-1; $y=")";
                        }else {
                    	$x=""; $surplusx=$surplus; $y="";
                        }
        if ($angsurplus < 0){
                    	$e="("; $angsurplusx=$angsurplus*-1; $f=")";
                        }else {
                    	$e=""; $angsurplusx=$angsurplus; $f="";
                        }
        $surplus1= number_format($surplusx,"2",",",".");
        $angsurplus1= number_format($angsurplusx,"2",",",".");
		
		$real_surplus = $angsurplus - $surplus;
                    if ($real_surplus < 0){
                    	$x003="("; $real_surplusx=$real_surplus*-1; $y003=")";}
                    else {
                    	$x003=""; $real_surplusx=$real_surplus; $y003="";}
        $selisihsurplus = number_format($real_surplusx,"2",",",".");
                    if ($surplus==0){
                        $tmp003=1;
                    }else{
                        $tmp003=$surplus;
                    }
					
                    $per003     = ($angsurplus!=0)?($surplus / $angsurplus ) * 100:0; 
                    $persen003  = number_format($per003,"2",",",".");
		
        $biaya_net =  $jmlpmasuk- $jmlpkeluar;
        $angbiaya_net =  $jmlangpmasuk- $jmlangpkeluar;        
        if ($biaya_net < 0){
                    	$a="("; $biaya_netx=$biaya_net*-1; $b=")";
                        }else {
                    	$a=""; $biaya_netx=$biaya_net; $b="";
                        }
        if ($angbiaya_net < 0){
                    	$g="("; $angbiaya_netx=$angbiaya_net*-1; $h=")";
                        }else {
                    	$g=""; $angbiaya_netx=$angbiaya_net; $h="";
                        }
        $biaya_net1 =   number_format($biaya_netx,"2",",",".");
        $angbiaya_net1 =   number_format($angbiaya_netx,"2",",",".");
        $silpa= ($jmlpendapatan+$jmlpmasuk)-($jmlbelanja+$jmlpkeluar);
        $angsilpa= ($jmlangpendapatan+$jmlangpmasuk)-($jmlangbelanja+$jmlangpkeluar);                
        if ($silpa < 0){
                    	$c="("; $silpax=$silpa*-1; $d=")";
                        }else {
                    	$c=""; $silpax=$silpa; $d="";
                        }
        if ($angsilpa < 0){
                    	$i="("; $angsilpax=$angsilpa*-1; $j=")";
                        }else {
                    	$i=""; $angsilpax=$angsilpa; $j="";
                        }
        $silpa1 =number_format($silpax,"2",",","."); 
        $angsilpa1 =number_format($angsilpax,"2",",",".");
       $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
		$nm_skpd	= strtoupper ($nmskpd);
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
	 $modtahun= $thn%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>I. LAPORAN REALISASI ANGGARAN (LRA)</strong></td>                         
                    </tr></table><br>";
					
		$cRet .="<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>					
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA DAERAH</strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan2] $thn DAN $cthnsbl</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
					<tr>
                         <td align=\"right\">(dalam rupiah)</td>
                    </tr>
                  </table>";        
        
				
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>                           
                            <td  bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN $thn</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI $thn</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>%</b></td>   
                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>REALISASI $cthnsbl</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>";
               
                   $sql4="SELECT a.seq,a.nor,a.uraian,isnull(a.kode_1,'-') as kode_1,isnull(a.kode_2,'-') as kode_2,isnull(a.kode_3,'-') as kode_3,thn_m1 AS lalu FROM map_lra_skpd a 
				   GROUP BY a.seq,a.nor,a.uraian,isnull(a.kode_1,'-'),isnull(a.kode_2,'-'),isnull(a.kode_3,'-'),thn_m1 ORDER BY a.seq";
                
                $query4 = $this->db->query($sql4);
                $no     = 0;                                  
                
                foreach ($query4->result() as $row4)
                {
                    
                    $nama      = $row4->uraian;   
                    $real_lalu = number_format($row4->lalu,"2",",",".");
                    $n         = $row4->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2         = $row4->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3         = $row4->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);

					//tlalu
					 $sql5_tlalu   = "SELECT SUM(b.real_spj) as nilai FROM data_realisasi_tlalu_n$sumber_data($cbulan2,$ag_tox,$cthnsbl) b WHERE $kd_unit='$kd_skpd' and (left(b.kd_rek5,3) in ($n) or left(b.kd_rek5,5) in ($n2) or left(b.kd_rek5,7) in ($n3))";

                    $query5_tlalu = $this->db->query($sql5_tlalu);
                    $trh_tlalu    = $query5_tlalu->row();
                    $nil_tlalu    = $trh_tlalu->nilai;
                   
                    
                    $real_s_tlalu = $trh_tlalu->nilai;
                    if ($real_s_tlalu < 0){
                    	$x1_tlalu="("; $real_sx_tlalu=$real_s_tlalu*-1; $y1_tlalu=")";}
                    else {
                    	$x1_tlalu=""; $real_sx_tlalu=$real_s_tlalu; $y1_tlalu="";}
                    $selisih_tlalu = number_format($real_sx_tlalu,"2",",",".");
                    if ($trh_tlalu->nilai==0){
                        $tmp_tlalu=1;
                    }else{
                        $tmp_tlalu=$trh_tlalu->nilai;
                    }
                    $nilai_tlalu    = number_format($trh_tlalu->nilai,"2",",",".");
					
					//skrg
                    $sql5   = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM data_realisasi_n$sumber_data($cbulan,$ag_tox,$thn) b WHERE kd_skpd='$kd_skpd' and (left(b.kd_rek5,3) in ($n) or left(b.kd_rek5,5) in ($n2) or left(b.kd_rek5,7) in ($n3))";

                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $angnil = $trh->anggaran;
                    
                    $real_s = $trh->anggaran - $trh->nilai;
                    if ($real_s < 0){
                    	$x1="("; $real_sx=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $real_sx=$real_s; $y1="";}
                    $selisih = number_format($real_sx,"2",",",".");
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    $nilai    = number_format($trh->nilai,"2",",",".");
                    $angnilai = number_format($trh->anggaran,"2",",",".");
                    $per1     = ($angnil!=0)?($nil / $angnil ) * 100:0; 
                    $persen1  = number_format($per1,"2",",",".");
                    $no       = $no + 1;
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr>                                
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\"><b>$nama&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr>                            
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
                        break;	
					 case 33:
                         $cRet    .= "<tr hidden>                                     
                                     <td style=\"border: none;\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
									 <td style=\"border: none;\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 35:
                         $cRet    .= "<tr hidden>                                   
                                     <td style=\"border: none;\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
									 <td style=\"border: none;\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 36:
                         $cRet    .= "<tr>                               
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 40:
                        $cRet    .= "<tr>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" ><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$jmlangpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$jmlpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$persen001</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$jmlpendapatan1_tlalu</td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr hidden>                                   
                                     <td style=\"border: none;\" ></td>
                                     <td style=\"border: none;\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
									 <td style=\"border: none;\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 50:
                         $cRet    .= "<tr>                             
                                     <td	 style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" ><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 55:
                         $cRet    .= "<tr>                               
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" ><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr hidden>                                 
                                     <td style=\"border: none;\" ></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
									 <td style=\"border: none;\" align=\"right\"></td>
                                 </tr>";
                        break;						
					case 75:
                         $cRet    .= "<tr hidden>                                 
                                     <td style=\"border: none;\" ></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
									 <td style=\"border: none;\" align=\"right\"></td>
                                 </tr>";
                        break;	
					case 80:
                         $cRet    .= "<tr>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" ><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr hidden>                                   
                                     <td style=\"border: none;\" ></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
									 <td style=\"border: none;\" align=\"right\"></td>
                                 </tr>";
                        break;							
					case 115:
                         $cRet    .= "<tr hidden>                              
                                     <td style=\"border: none;\" ></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
									 <td style=\"border: none;\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 120:
                        $cRet    .= "<tr>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" ><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$jmlangbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$jmlbelanja1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$persen002</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$nilai_tlalu</td>
                                 </tr>";
                        break;
					case 125:
                         $cRet    .= "<tr hidden>                               
                                     <td style=\"border: none;\" ></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
                                     <td style=\"border: none;\" align=\"right\"></td>
									 <td style=\"border: none;\" align=\"right\"></td>
                                 </tr>";
                        break;	
                    case 130:
                        $cRet    .= "<tr>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$e$angsurplus1$f</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$x$surplus1$y</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$persen003</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$c_tlalu$silpa1_tlalu$d_tlalu</td>
                                 </tr>";
                        break;
                   
                    default:
                    $cRet    .= "<tr>                          
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" >$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\">$persen1</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\">$nilai_tlalu</td>
                                 </tr>";
                }
                }
        $cRet .=       " </table><br>";
		
		$cRet.='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="1" align=center> 
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$daerah.', '.$this->tukd_model->tanggal_format_indonesia($dcetak).'</TD>
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$jabatan.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$nama_ttd.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">NIP: '.$nip.'</TD> 
					</TR>					
					</TABLE>
					'; 
		
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LRA UNIT $kd_skpd / $cbulan");
        $this->template->set('title', 'LRA UNIT $kd_skpd / $cbulan');        
        
		$pilih=1;
		switch($pilih) {       
        case 1;
			echo ("<title>I LRA</title>");
			 echo $cRet;
        break;
       /*  case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; */
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }
	
	function cetak_IIneraca($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
		$spasi = "line-height: 1.5em;";		
			
			$thn_ang	= $this->session->userdata('pcThang');
			$thn_ang_1	= $thn_ang-1;
			$cbulan  = substr($dcetak,5,2);
			$cbulan2  = 12;
			$cbulan<10 ? $xbulan = "0$cbulan" : $xbulan=$cbulan;
			
			if($cbulan== 12){
			$sumber_data= "_at";
			$trdju = "trdju_calk";
			$trhju = "trhju_calk";
			}else{
			$sumber_data= "";
			$trdju = "trdju";
			$trhju = "trhju";
			}
			
			$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd' ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $nmskpd  = $rowsc->nm_skpd;
                } 
        
			$nm_skpd	= strtoupper ($nmskpd);
			
	$lcttd = str_replace('a',' ',$ttd);
	$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama_ttd= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
				
			$modtahun= $thn_ang%4;
	 
			if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			$arraybulan=explode(".",$nilaibulan);
			$cRet='';
			
			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>III. NERACA </strong></td>                         
                    </tr></TABLE><br>";
			
			$cRet .="<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>
					<TR>
						<td align=\"center\"><strong>NERACA</strong></td>
					</TR>
					<TR>
						<td align=\"center\"><strong>PER $arraybulan[$cbulan2] $thn_ang DAN $thn_ang_1 </strong></td>
					</TR>
					<TR>
						<td align=\"right\">&nbsp;</td>
					</TR>
					<TR>
						<td align=\"right\">(dalam rupiah)</td>
					</TR>
					</TABLE>";

					  $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							
                            <td bgcolor=\"#CCCCCC\" width=\"55%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$arraybulan[$cbulan2] $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$arraybulan[$cbulan2] $thn_ang_1</b></td>                            
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
							
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                                             
                         </tr>
                     </tfoot>";
			
			
			//level 1

// Created by Henri_TB

			$sqllo10="select isnull(sum(kredit-debet),0) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select isnull(sum(debet-kredit),0) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT isnull(SUM(a.debet),0) AS debet, isnull(SUM(a.kredit),0) AS kredit FROM $trdju a INNER JOIN $trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0");  
	        foreach($query3->result_array() as $res2){
				 $debet3=$res2['debet'];
				 $kredit3=$res2['kredit'];
                 				 
			 }
		
		$sqlrkpp="select isnull(sum(kredit-debet),0) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<'$thn_ang_1' and left(kd_rek5,3) in ('313') and b.kd_skpd='$kd_skpd'";
                    $rkpp= $this->db->query($sqlrkpp);
                    $rkpp1 = $rkpp->row();
                    $rkpp_lalu = $rkpp1->nilai;
                    $rkpp_lalu1= number_format($rkpp1->nilai,"2",",",".");
			
		$real=$kredit3-$debet3+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select isnull(sum(kredit-debet),0) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select isnull(sum(kredit-debet),0) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and b.kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select isnull(sum(debet-kredit),0) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select isnull(sum(debet-kredit),0) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and b.kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    
					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
					
			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}
			
			$sqlrkpp2="select isnull(sum(kredit-debet),0) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)='$thn_ang_1' and left(kd_rek5,3) in ('313') and b.kd_skpd='$kd_skpd'";
                    $rkpp2= $this->db->query($sqlrkpp2);
                    $rkpp12 = $rkpp2->row();
                    $rkpp_lalu2 = $rkpp12->nilai;
                    	
			
		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;		

			$sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		
			$sqlrkpp3="select isnull(sum(kredit-debet),0) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)='$thn_ang' and left(kd_rek5,3) in ('313') and b.kd_skpd='$kd_skpd'";
                    $rkpp3= $this->db->query($sqlrkpp3);
                    $rkpp13 = $rkpp3->row();
                    $rkpp = $rkpp13->nilai;
                    
		
        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;

			$sqlutang_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang_lalu  =$row->thn_m1;
					}					

			$sqlkas_lalu = "select isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and year(a.tgl_voucher)<=$thn_ang_1 and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas_lalu); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd_lalu  =$row->thn_m1;
					}

			$eku_lalu 		= $sal_awal + $rk_ppkd_lalu;					
			$eku_tang_lalu 	= $sal_awal + $nilaiutang_lalu + $rk_ppkd_lalu;
		
			$sqlutang = "select isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher
			and b.kd_unit=a.kd_skpd where left(b.kd_rek5,1)=2 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlutang); 
                    foreach ($hasil->result() as $row)
                    {
                       $nilaiutang  =$row->thn_m1;
					}					
			
			$sqlkas = "select isnull(sum(kredit-debet),0) thn_m1 from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
			and b.kd_unit=a.kd_skpd where kd_rek5=3130101 and left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqlkas); 
                    foreach ($hasil->result() as $row)
                    {
                       $rk_ppkd  =$row->thn_m1;
					}
					
			$eku 		= $sal_akhir + $rk_ppkd;					
			$eku_tang 	= $sal_akhir + $nilaiutang + $rk_ppkd;			

					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}
					
					$sal_akhir1= number_format($sal_akhir,"2",",",".");
				
					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}		
					
					$sal_awal1= number_format($sal_awal,"2",",",".");
								
			
		if ($eku_lalu < 0){
                    	$min001="("; $eku_lalu=$eku_lalu*-1; $min002=")";
                        }else {
                    	$min001=""; $eku_lalu; $min002="";
                        }			
		
		$eku_lalu1=number_format($eku_lalu,"2",",",".");

		if ($eku < 0){
                    	$min003="("; $eku=$eku*-1; $min004=")";
                        }else {
                    	$min003=""; $eku; $min004="";
                        }			
		
		$eku1=number_format($eku,"2",",",".");
			
		if ($eku_tang_lalu < 0){
                    	$min005="("; $eku_tang_lalu=$eku_tang_lalu*-1; $min006=")";
                        }else {
                    	$min005=""; $eku_tang_lalu; $min006="";
                        }			
		
		$eku_tang_lalu1=number_format($eku_tang_lalu,"2",",",".");

		if ($eku_tang < 0){
                    	$min007="("; $eku_tang=$eku_tang*-1; $min008=")";
                        }else {
                    	$min007=""; $eku_tang; $min008="";
                        }			
		
		$eku_tang1=number_format($eku_tang,"2",",",".");		

		if ($rk_ppkd_lalu < 0){
                    	$min009="("; $rk_ppkd_lalu=$rk_ppkd_lalu*-1; $min010=")";
                        }else {
                    	$min009=""; $rk_ppkd_lalu; $min010="";
                        }			
		
		$rk_ppkd_lalu1=number_format($rk_ppkd_lalu,"2",",",".");

		if ($rk_ppkd < 0){
                    	$min013="("; $rk_ppkd=$rk_ppkd*-1; $min014=")";
                        }else {
                    	$min013=""; $rk_ppkd; $min014="";
                        }			

		$rk_ppkd1=number_format($rk_ppkd,"2",",",".");
		
		if ($rkpp_lalu2 < 0){
                    	$pp1="("; $rkpp_lalu2=$rkpp_lalu2*-1; $pp2=")";}
                    else {
                    	$pp1=""; $rkpp_lalu2; $pp2="";}	
						
		$rkpp_lalu12= number_format($rkpp_lalu2,"2",",",".");
		
		if ($rkpp < 0){
                    	$pp3="("; $rkpp=$rkpp*-1; $pp4=")";}
                    else {
                    	$pp3=""; $rkpp; $pp4="";}
		
		$rkpp1= number_format($rkpp,"2",",",".");
		
			$queryneraca = " SELECT kode, uraian, seq, isnull(normal,'') as normal, isnull(kode_1,'xxx') as kode_1, isnull(kode_2,'xxx')  as kode_2, isnull(kode_3,'xxx') as kode_3, 
										isnull(kode_4,'xxx') as kode_4, isnull(kode_5,'xxx') as kode_5, isnull(kode_6,'xxx') as kode_6, isnull(kode_7,'xxx') as kode_7, 
										isnull(kode_8,'xxx') as kode_8, isnull(kode_9,'xxx') as kode_9, isnull(kode_10,'xxx') as kode_10, isnull(kode_11,'xxx') as kode_11,
										isnull(kode_12,'xxx') as kode_12, isnull(kode_13,'xxx') as kode_13, isnull(kode_14,'xxx') as kode_14, isnull(kode_15,'xxx') as kode_15 
										FROM map_neraca_skpd ORDER BY seq ";  
		
			$query10 = $this->db->query($queryneraca);
			
			$no     = 0;
			
			foreach($query10->result_array() as $res){
				$uraian=$res['uraian'];
				$normal=$res['normal'];
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);
											
				
			$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where left(CONVERT(char(15),tgl_voucher, 112),6)<='$thn_ang$xbulan' and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nl=$debet-$kredit;
				}else{
					$nl=$kredit-$debet;				
				}
				if ($nl=='') $nl=0;
	
				// Jurnal Tahun lalu
				$q = $this->db->query(" SELECT isnull(SUM(b.debet),0) AS debet,isnull(SUM(b.kredit),0) AS kredit from $trhju a inner join $trdju b on a.no_voucher=b.no_voucher 
									and b.kd_unit=a.kd_skpd where year(tgl_voucher)<=$thn_ang_1 and a.kd_skpd ='$kd_skpd' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') ");  

				 foreach($q->result_array() as $rx){
					$debet_lalu=$rx['debet'];
					$kredit_lalu=$rx['kredit'];
				 }
				
				if ($debet_lalu=='') $debet_lalu=0;
				if ($kredit_lalu=='') $kredit_lalu=0;

				if ($normal=='D'){
					$sblm=$debet_lalu-$kredit_lalu;
				}else{
					$sblm=$kredit_lalu-$debet_lalu;				
				}
				if ($sblm=='') $sblm=0;

				if ($nl < 0){
                    	$nl001="("; $nl=$nl*-1; $ln001=")";
                        }else {
                    	$nl001=""; $ln001="";
                        }
				if ($sblm < 0){
                    	$sblm001="("; $sblm=$sblm*-1; $mlbs001=")";
                        }else {
                    	$sblm001=""; $mlbs001="";
                        }
        $nl1= number_format($nl,"2",",",".");
        $sblm1= number_format($sblm,"2",",",".");
				
				$no       = $no + 1;

				switch ($res['seq']) {
                    case 5:
                         $cRet    .= "<tr>                           
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 65:
                         $cRet    .= "<tr>                            
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 70:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 170:
                         $cRet    .= "<tr>                          
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr>                        
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 320:
                         $cRet    .= "<tr hidden>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 340:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 370:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 375:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 378:
                         $cRet    .= "<tr hidden>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 380:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 410:
                         $cRet    .= "<tr>                        
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					case 415:
                         $cRet    .= "<tr hidden>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;
					case 420:
                         $cRet    .= "<tr hidden>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 460:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 465:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c$sal_akhir1$d</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$c1$sal_awal1$d1</td>

								 </tr>";
                        break;
					case 470:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
						break;		 
					case 475:
                         $cRet    .= "<tr>                          
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$min003$eku1$min004</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$min001$eku_lalu1$min002</td>
								 </tr>";
                        break;
					case 485:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\"><b>$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$min007$eku_tang1$min008</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$min005$eku_tang_lalu1$min006</td>
                                 </tr>";
                        break;	
					default:	
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"55%\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nl001$nl1$ln001</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$sblm001$sblm1$mlbs001</td>
                                 </tr>";
                        break;	
					}
				
			}

			
        $cRet .='</table><br>';
		
		$cRet.='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="1" align=center> 
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$daerah.', '.$this->tukd_model->tanggal_format_indonesia($dcetak).'</TD>
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$jabatan.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$nama_ttd.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">NIP: '.$nip.'</TD> 
					</TR>					
					</TABLE>
					'; 
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("NERACA UNIT $kd_skpd / $cbulan2");
        $this->template->set('title', ("NERACA UNIT $kd_skpd / $cbulan2"));  
         $pilih=1;
		 switch ($pilih)
        {
            case 1;
				echo ("<title>II NERACA</title>");
				echo $cRet;
				break;
            case 4;
               $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
	}
	
	function cetak_IIIlo($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
        $spasi = "line-height: 1.5em;";	
		
		$cetak='2'; 
        $thn_ang = $this->session->userdata('pcThang');
        $thn_ang_1= $thn_ang-1;  
		$cbulan  = substr($dcetak,5,2);
		$cbulan2  = 12;
		
		if($cbulan== 12){
		$sumber_data= "_at";
		$trdju = "trdju_calk";
        $trhju = "trhju_calk";
		}else{
		$sumber_data= "";
		$trdju = "trdju";
        $trhju = "trhju";
		}
               
           $skpd = "AND kd_skpd='$kd_skpd'";
           $skpd1 = "AND b.kd_skpd='$kd_skpd'"; 
     
       $y123=")";
	   $x123="(";       
	    $sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $nmskpd     = $rowsc->nm_skpd;
                } 
		$nm_skpd = strtoupper($nmskpd);		
	   
	   $lcttd = str_replace('a',' ',$ttd);
	$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama_ttd= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
				
	   
	   // INSERT DATA
	   
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$kd_skpd'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
// created by henri_tb
			
		$sqllo1="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('81','82','83') and kd_skpd='$kd_skpd'";
                    $querylo1= $this->db->query($sqllo1);
                    $penlo = $querylo1->row();
                    $pen_lo = $penlo->nilai;
                    $pen_lo1= number_format($penlo->nilai,"2",",",".");
        
		$sqllo2="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83') and kd_skpd='$kd_skpd'";
                    $querylo2= $this->db->query($sqllo2);
                    $penlo2 = $querylo2->row();
                    $pen_lo_lalu = $penlo2->nilai;
                    $pen_lo_lalu1= number_format($penlo2->nilai,"2",",",".");
		
		$sqllo3="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('91','92') and kd_skpd='$kd_skpd'";
                    $querylo3= $this->db->query($sqllo3);
                    $bello = $querylo3->row();
                    $bel_lo = $bello->nilai;
                    $bel_lo1= number_format($bello->nilai,"2",",",".");
        
		$sqllo4="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92') and kd_skpd='$kd_skpd'";
                    $querylo4= $this->db->query($sqllo4);
                    $bello2 = $querylo4->row();
                    $bel_lo_lalu = $bello2->nilai;
                    $bel_lo_lalu1= number_format($bello2->nilai,"2",",",".");		

					$surplus_lo = $pen_lo - $bel_lo;
                    if ($surplus_lo < 0){
                    	$lo1="("; $surplus_lox=$surplus_lo*-1; $lo2=")";}
                    else {
                    	$lo1=""; $surplus_lox=$surplus_lo; $lo2="";}		
                    $surplus_lo1 = number_format($surplus_lox,"2",",",".");
                    
					$surplus_lo_lalu = $pen_lo_lalu - $bel_lo_lalu;
                    if ($surplus_lo_lalu < 0){
                    	$lo3="("; $surplus_lo_lalux=$surplus_lo_lalu*-1; $lo4=")";}
                    else {
                    	$lo3=""; $surplus_lo_lalux=$surplus_lo_lalu; $lo4="";}						
                    $surplus_lo_lalu1 = number_format($surplus_lo_lalux,"2",",",".");

					$selisih_surplus_lo = $surplus_lo - $surplus_lo_lalu;
                    if ($selisih_surplus_lo < 0){
                    	$lo5="("; $selisih_surplus_lox=$selisih_surplus_lo*-1; $lo6=")";}
                    else {
                    	$lo5=""; $selisih_surplus_lox=$selisih_surplus_lo; $lo6="";}
                    $selisih_surplus_lo1 = number_format($selisih_surplus_lox,"2",",",".");
                    
					if( $surplus_lo_lalu=='' or $surplus_lo_lalu==0){
					$persen2 = '0,00';
					}else{
					$persen2 = ($surplus_lo/$surplus_lo_lalu)*100;
					$persen2 = number_format($persen2,"2",",",".");
					}
					
		$sqllo5="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('81','82','83','84') and kd_skpd='$kd_skpd'";
                    $querylo5= $this->db->query($sqllo5);
                    $penlo3 = $querylo5->row();
                    $pen_lo3 = $penlo3->nilai;
                    $pen_lo31= number_format($penlo3->nilai,"2",",",".");
        
		$sqllo6="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('81','82','83','84') and kd_skpd='$kd_skpd'";
                    $querylo6= $this->db->query($sqllo6);
                    $penlo4 = $querylo6->row();
                    $pen_lo_lalu4 = $penlo4->nilai;
                    $pen_lo_lalu41= number_format($penlo4->nilai,"2",",",".");
		
		$sqllo7="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('91','92','93') and kd_skpd='$kd_skpd'";
                    $querylo7= $this->db->query($sqllo7);
                    $bello5 = $querylo7->row();
                    $bel_lo5 = $bello5->nilai;
                    $bel_lo51= number_format($bello5->nilai,"2",",",".");
		
		$sqllo8="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('91','92','93') and kd_skpd='$kd_skpd'";
                    $querylo8= $this->db->query($sqllo8);
                    $bello6 = $querylo8->row();
                    $bel_lo_lalu6 = $bello6->nilai;
                    $bel_lo_lalu61= number_format($bello6->nilai,"2",",",".");		

					$surplus_lo2 = $pen_lo3 - $bel_lo5;
                    if ($surplus_lo2 < 0){
                    	$lo7="("; $surplus_lo2x=$surplus_lo2*-1; $lo8=")";}
                    else {
                    	$lo7=""; $surplus_lo2x=$surplus_lo2; $lo8="";}		
                    $surplus_lo21 = number_format($surplus_lo2x,"2",",",".");
                    
					$surplus_lo_lalu2 = $pen_lo_lalu4 - $bel_lo_lalu6;
                    if ($surplus_lo_lalu2 < 0){
                    	$lo9="("; $surplus_lo_lalu2x=$surplus_lo_lalu2*-1; $lo10=")";}
                    else {
                    	$lo9=""; $surplus_lo_lalu2x=$surplus_lo_lalu2; $lo10="";}						
                    $surplus_lo_lalu21 = number_format($surplus_lo_lalu2x,"2",",",".");

					$selisih_surplus_lo2 = $surplus_lo2 - $surplus_lo_lalu2;
                    if ($selisih_surplus_lo2 < 0){
                    	$lo11="("; $selisih_surplus_lo2x=$selisih_surplus_lo2*-1; $lo12=")";}
                    else {
                    	$lo11=""; $selisih_surplus_lo2x=$selisih_surplus_lo2; $lo12="";}
                    $selisih_surplus_lo21 = number_format($selisih_surplus_lo2x,"2",",",".");
                    
					if( $surplus_lo_lalu2=='' or $surplus_lo_lalu2==0){
					$persen3 = '0,00';
					}else{
					$persen3 = ($surplus_lo2/$surplus_lo_lalu2)*100;
					$persen3 = number_format($persen3,"2",",",".");
					}
		
		$sqllo9="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3x=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $surplus_lo3x=$surplus_lo3; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3x,"2",",",".");
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;
                    if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3x=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $surplus_lo_lalu3x=$surplus_lo_lalu3; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3x,"2",",",".");

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3x=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $selisih_surplus_lo3x=$selisih_surplus_lo3; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3x,"2",",",".");
                    
					if( $surplus_lo_lalu3=='' or $surplus_lo_lalu3==0){
					$persen4 = '0,00';
					}else{
					$persen4 = ($surplus_lo3/$surplus_lo_lalu3)*100;
					$persen4 = number_format($persen4,"2",",",".");
					}

					
		$sqllo13="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('84') and kd_skpd='$kd_skpd'";
                    $querylo13= $this->db->query($sqllo13);
                    $penlo11 = $querylo13->row();
                    $pen_lo11 = $penlo11->nilai;
                    $pen_lo111= number_format($penlo11->nilai,"2",",",".");
        
		$sqllo14="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('84') and kd_skpd='$kd_skpd'";
                    $querylo14= $this->db->query($sqllo14);
                    $penlo12 = $querylo14->row();
                    $pen_lo_lalu12 = $penlo12->nilai;
                    $pen_lo_lalu121= number_format($penlo12->nilai,"2",",",".");
		
		$sqllo15="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('93') and kd_skpd='$kd_skpd'";
                    $querylo15= $this->db->query($sqllo15);
                    $bello13 = $querylo15->row();
                    $bel_lo13 = $bello13->nilai;
                    $bel_lo131= number_format($bello13->nilai,"2",",",".");
		
		$sqllo16="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('93') and kd_skpd='$kd_skpd'";
                    $querylo16= $this->db->query($sqllo16);
                    $bello14 = $querylo16->row();
                    $bel_lo_lalu14 = $bello14->nilai;
                    $bel_lo_lalu141= number_format($bello14->nilai,"2",",",".");		

					$surplus_lo4 = $pen_lo11 - $bel_lo13;
                    if ($surplus_lo4 < 0){
                    	$lo19="("; $surplus_lo4x=$surplus_lo4*-1; $lo20=")";}
                    else {
                    	$lo19=""; $surplus_lo4x=$surplus_lo4; $lo20="";}		
                    $surplus_lo41 = number_format($surplus_lo4x,"2",",",".");
                    
					$surplus_lo_lalu4 = $pen_lo_lalu12 - $bel_lo_lalu14;
                    if ($surplus_lo_lalu4 < 0){
                    	$lo21="("; $surplus_lo_lalu4x=$surplus_lo_lalu4*-1; $lo22=")";}
                    else {
                    	$lo21=""; $surplus_lo_lalu4x=$surplus_lo_lalu4; $lo22="";}						
                    $surplus_lo_lalu41 = number_format($surplus_lo_lalu4x,"2",",",".");

					$selisih_surplus_lo4 = $surplus_lo4 - $surplus_lo_lalu4;
                    if ($selisih_surplus_lo4 < 0){
                    	$lo23="("; $selisih_surplus_lo4x=$selisih_surplus_lo4*-1; $lo24=")";}
                    else {
                    	$lo23=""; $selisih_surplus_lo4x=$selisih_surplus_lo4; $lo24="";}
                    $selisih_surplus_lo41 = number_format($selisih_surplus_lo4x,"2",",",".");
                    
					if( $surplus_lo_lalu4=='' or $surplus_lo_lalu4==0){
					$persen5 = '0,00';
					}else{
					$persen5 = ($surplus_lo4/$surplus_lo_lalu4)*100;
					$persen5 = number_format($persen5,"2",",",".");
					}
					
					
		$sqllo17="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('85') and kd_skpd='$kd_skpd'";
                    $querylo17= $this->db->query($sqllo17);
                    $penlo15 = $querylo17->row();
                    $pen_lo15 = $penlo15->nilai;
                    $pen_lo151= number_format($penlo15->nilai,"2",",",".");
        
		$sqllo18="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('85') and kd_skpd='$kd_skpd'";
                    $querylo18= $this->db->query($sqllo18);
                    $penlo16 = $querylo18->row();
                    $pen_lo_lalu16 = $penlo16->nilai;
                    $pen_lo_lalu161= number_format($penlo16->nilai,"2",",",".");
		
		$sqllo19="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and left(kd_rek5,2) in ('94') and kd_skpd='$kd_skpd'";
                    $querylo19= $this->db->query($sqllo19);
                    $bello17 = $querylo19->row();
                    $bel_lo17 = $bello17->nilai;
                    $bel_lo171= number_format($bello17->nilai,"2",",",".");
		
		$sqllo20="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,2) in ('94') and kd_skpd='$kd_skpd'";
                    $querylo20= $this->db->query($sqllo20);
                    $bello18 = $querylo20->row();
                    $bel_lo_lalu18 = $bello18->nilai;
                    $bel_lo_lalu181= number_format($bello18->nilai,"2",",",".");		

					$surplus_lo5 = $pen_lo15 - $bel_lo17;
                    if ($surplus_lo5 < 0){
                    	$lo25="("; $surplus_lo5x=$surplus_lo5*-1; $lo26=")";}
                    else {
                    	$lo25=""; $surplus_lo5x=$surplus_lo5; $lo26="";}		
                    $surplus_lo51 = number_format($surplus_lo5x,"2",",",".");
                    
					$surplus_lo_lalu5 = $pen_lo_lalu16 - $bel_lo_lalu18;
                    if ($surplus_lo_lalu5 < 0){
                    	$lo27="("; $surplus_lo_lalu5x=$surplus_lo_lalu5*-1; $lo28=")";}
                    else {
                    	$lo27=""; $surplus_lo_lalu5x=$surplus_lo_lalu5; $lo28="";}						
                    $surplus_lo_lalu51 = number_format($surplus_lo_lalu5x,"2",",",".");

					$selisih_surplus_lo5 = $surplus_lo5 - $surplus_lo_lalu5;
                    if ($selisih_surplus_lo5 < 0){
                    	$lo29="("; $selisih_surplus_lo5x=$selisih_surplus_lo5*-1; $lo30=")";}
                    else {
                    	$lo29=""; $selisih_surplus_lo5x=$selisih_surplus_lo5; $lo30="";}
                    $selisih_surplus_lo51 = number_format($selisih_surplus_lo5x,"2",",",".");
                    
					if( $surplus_lo_lalu5=='' or $surplus_lo_lalu5==0){
					$persen6 = '0,00';
					}else{
					$persen6 = ($surplus_lo5/$surplus_lo_lalu5)*100;
					$persen6 = number_format($persen6,"2",",",".");
					}			
					
		
        $modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);

        $cRet='';
        
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>II. LAPORAN OPERASIONAL (LO) </strong></td>                         
                    </tr></TABLE><br>";
	   
        $cRet .="<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					 <tr>
						<td align=\"center\"><strong>$nm_skpd</strong></td>
					</tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan2] $thn_ang DAN $thn_ang_1</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
					<tr>
                         <td align=\"right\">(dalam rupiah)</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>                         
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$arraybulan[$cbulan2] $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$arraybulan[$cbulan2] $thn_ang_1</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Kenaikan</br>(Penurunan)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                           
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr>                           
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" colspan=\"5\"><B>KEGIATAN OPERASIONAL</td>
                        </tr>";

        $sqlmaplo="SELECT seq, nor, uraian, isnull(kode_1,'-') as kode_1, isnull(kode_2,'-') as kode_2, isnull(kode_3,'-') as kode_3, isnull(cetak,'debet-debet') as cetak FROM map_lo_prov 
				   GROUP BY seq, nor, uraian, isnull(kode_1,'-'), isnull(kode_2,'-'), isnull(kode_3,'-'), isnull(cetak,'debet-debet') ORDER BY seq";
				   
                $querymaplo = $this->db->query($sqlmaplo);
                $no     = 0;                                  
               
                foreach ($querymaplo->result() as $loquery)
                {
                    
                    $nama      = $loquery->uraian;   
                    $n         = $loquery->kode_1;
					$n		   = ($n=="-"?"'-'":$n);
					$n2        = $loquery->kode_2;
					$n2		   = ($n2=="-"?"'-'":$n2);
					$n3        = $loquery->kode_3;
					$n3		   = ($n3=="-"?"'-'":$n3);
					$normal    = $loquery->cetak;
					
		$quelo01   = "SELECT SUM($normal) as nilai FROM $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ($n) or left(kd_rek5,5) in ($n2) or left(kd_rek5,7) in ($n3)) and year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$cbulan and kd_skpd='$kd_skpd'";
                    $quelo02 = $this->db->query($quelo01);
                    $quelo03 = $quelo02->row();
                    $nil     = $quelo03->nilai;
                    $nilai    = number_format($quelo03->nilai,"2",",",".");
					
		$quelo04   = "SELECT SUM($normal) as nilai FROM $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd WHERE (left(kd_rek5,3) in ($n) or left(kd_rek5,5) in ($n2) or left(kd_rek5,7) in ($n3)) and year(tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";
                    $quelo05 = $this->db->query($quelo04);
                    $quelo06 = $quelo05->row();
                    $nil_lalu     = $quelo06->nilai;
                    $nilai_lalu    = number_format($quelo06->nilai,"2",",",".");
					
                    $real_nilai = $nil - $nil_lalu;
                    if ($real_nilai < 0){
                    	$lo0="("; $real_nilaix=$real_nilai*-1; $lo00=")";}
                    else {
                    	$lo0=""; $real_nilaix=$real_nilai; $lo00="";}
                    $real_nilai1 = number_format($real_nilaix,"2",",",".");
                    
					if( $nil_lalu=='' or $nil_lalu==0){
					$persen1 = '0,00';
					}else{
					$persen1 = ($nil/$nil_lalu)*100;
					$persen1 = number_format($persen1,"2",",",".");
					}
                    $no       = $no + 1;
                    switch ($loquery->seq) {
                    case 5:
                         $cRet    .= "<tr>                                
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" colspan=\"5\"><b>$nama</td>
                                 </tr>";
                        break;
					case 10:
                         $cRet    .= "<tr>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" colspan=\"5\"><b>$nama</td>
                                 </tr>";
                        break;
					case 35:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</td>
                                 </tr>";
                        break;
					case 40:
                         $cRet    .= "<tr hidden>                               
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 45:
                         $cRet    .= "<tr>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" colspan=\"5\"><b>$nama</td>
                                 </tr>";
                        break;
                    case 50:
                         $cRet    .= "<tr>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" colspan=\"5\"><b>$nama</td>
                                 </tr>";
                        break;
					case 75:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</td>
                                 </tr>";
                        break;
					case 80:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					 case 85:
                         $cRet    .= "<tr>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" colspan=\"5\"><b>$nama</td>
                                 </tr>";
                        break;
					case 100:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</td>
                                 </tr>";
                        break;
					case 105:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</td>
                                 </tr>";
                        break;
					case 110:
                         $cRet    .= "<tr hidden>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					 case 115:
                         $cRet    .= "<tr>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" colspan=\"5\"><b>$nama</td>
                                 </tr>";
                        break;
					case 135:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</td>
                                 </tr>";
                        break;
					case 140:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					 case 145:
                         $cRet    .= "<tr>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" colspan=\"5\"><b>$nama</td>
                                 </tr>";
                        break;
					case 150:
                         $cRet    .= "<tr>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" colspan=\"5\"><b>$nama</td>
                                 </tr>";
                        break;
					case 195:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</td>
                                 </tr>";
                        break;
					case 200:
                         $cRet    .= "<tr hidden>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 205:
                         $cRet    .= "<tr>                              
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" colspan=\"5\"><b>$nama</td>
                                 </tr>";
                        break;
					case 235:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</td>
                                 </tr>";
                        break;
					case 240:
                         $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</td>
                                 </tr>";
                        break;
					case 245:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 250:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 255:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 260:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 265:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 270:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 275:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 280:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 285:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 290:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 295:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 300:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 305:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 310:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 315:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 320:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 325:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 330:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 335:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 340:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 345:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 350:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 355:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 360:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 365:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 370:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 375:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 380:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 385:
                         $cRet    .= "<tr hidden>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					case 390:
                         $cRet    .= "<tr>                             
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$lo13$surplus_lo31$lo14</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$lo15$surplus_lo_lalu31$lo16</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$lo17$selisih_surplus_lo31$lo18</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen4</td>
                                 </tr>";
                        break;
					default:
                    $cRet    .= "<tr>                         
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai_lalu</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$lo0$real_nilai1$lo00</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";

                }
                              
                    
                }
               
              
        
        $cRet .=       " </table><br>";
		
		$cRet.='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="1" align=center> 
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$daerah.', '.$this->tukd_model->tanggal_format_indonesia($dcetak).'</TD>
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$jabatan.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$nama_ttd.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">NIP: '.$nip.'</TD> 
					</TR>					
					</TABLE>
					'; 
		
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("LO UNIT $cbulan2");
        $this->template->set('title', 'LO UNIT $cbulan2');        
        $pilih=1;
		switch($pilih) {       
        case 1;
            // $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
			echo "<title>III. LAPORAN OPERASIONAL</title>";
			echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        }    
                 
    }
    
	function cetak_IVlpe($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
		$spasi = "line-height: 1.5em;";	
		
        $thn_ang = $this->session->userdata('pcThang');
		$cbulan  = substr($dcetak,5,2);
		$bulan	 = $cbulan;
        $id1     = $this->session->userdata('kdskpd');
        $nmskpd = $this->tukd_model->get_nama($kd_skpd,'nm_skpd','ms_skpd','kd_skpd');
        $nm_skpd =strtoupper($nmskpd);
        $thn_ang_1= $thn_ang-1;   
        
		if($cbulan== 12){
		$sumber_data= "_at";
		$trdju = "trdju_calk";
        $trhju = "trhju_calk";
		}else{
		$sumber_data= "";
		$trdju = "trdju";
        $trhju = "trhju";
		}
		
	
        $skpd = "AND kd_skpd='$id1'";
        $skpd1 = "AND b.kd_skpd='$id1'"; 

		
		 $lcttd = str_replace('a',' ',$ttd);
	$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama_ttd= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
				
		
// UPDATE LPE TAHUN LALU
    		        
			$sqllo10="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $pen8 = $querylo10->row();
                    $pen_lalu8 = $pen8->nilai;
                    $pen_lalu81= number_format($pen8->nilai,"2",",",".");
		
			$sqllo12="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)<$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bel10 = $querylo12->row();
                    $bel_lalu10 = $bel10->nilai;
                    $bel_lalu101= number_format($bel10->nilai,"2",",",".");

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_ll1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_ll2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN-LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)<$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_ll3  =$row003->thn_m1;
					}
					
			
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet, SUM(a.kredit) AS kredit FROM $trdju a INNER JOIN $trhju b 
			ON a.no_voucher = b.no_voucher and a.kd_unit=b.kd_skpd WHERE a.kd_rek5='3110101' AND YEAR(b.tgl_voucher)<'$thn_ang'
			and b.tabel=1 and reev=0 and kd_skpd='$kd_skpd'");  
	        foreach($query3->result_array() as $res2){
				 $debet=$res2['debet'];
				 $kredit=$res2['kredit'];
                 				 
			 }
			 
		$real=$kredit-$debet+$pen_lalu8-$bel_lalu10+$lpe_ll1+$lpe_ll2+$lpe_ll3;

//		created by henri_tb
		$sqllo9="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo9= $this->db->query($sqllo9);
                    $penlo7 = $querylo9->row();
                    $pen_lo7 = $penlo7->nilai;
                    $pen_lo71= number_format($penlo7->nilai,"2",",",".");
        
		$sqllo10="select sum(kredit-debet) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('8') and kd_skpd='$kd_skpd'";
                    $querylo10= $this->db->query($sqllo10);
                    $penlo8 = $querylo10->row();
                    $pen_lo_lalu8 = $penlo8->nilai;
                    $pen_lo_lalu81= number_format($penlo8->nilai,"2",",",".");
		
		$sqllo11="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo11= $this->db->query($sqllo11);
                    $bello9 = $querylo11->row();
                    $bel_lo9 = $bello9->nilai;
                    $bel_lo91= number_format($bello9->nilai,"2",",",".");
		
		$sqllo12="select sum(debet-kredit) as nilai from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd where year(tgl_voucher)=$thn_ang_1 and left(kd_rek5,1) in ('9') and kd_skpd='$kd_skpd'";
                    $querylo12= $this->db->query($sqllo12);
                    $bello10 = $querylo12->row();
                    $bel_lo_lalu10 = $bello10->nilai;
                    $bel_lo_lalu101= number_format($bello10->nilai,"2",",",".");		

					$surplus_lo3 = $pen_lo7 - $bel_lo9;
                    
					$surplus_lo_lalu3 = $pen_lo_lalu8 - $bel_lo_lalu10;

					$selisih_surplus_lo3 = $surplus_lo3 - $surplus_lo_lalu3;
                    

			$sql_lalu = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql_lalu); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $lpe_lalu1  =$row001->thn_m1;
					}
				        
			$sqllpe_lalu1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $lpe_lalu2  =$row002->thn_m1;
					}					

			$sqllpe_lalu2 = "select 6 nor,'LAIN-LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang_1 and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe_lalu2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $lpe_lalu3  =$row003->thn_m1;
					}

		$sal_awal	= $real + $surplus_lo_lalu3 + $lpe_lalu1 + $lpe_lalu2 + $lpe_lalu3;
						
            $sql = "select 5 nor,'SELISIH REVALUASI ASET TETAP' uraian,3 parent,25 seq,'413'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='1' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//aba
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row001)
                    {
                       $kd_rek   =$row001->nor ;
                       $parent   =$row001->parent;
                       $nama     =$row001->uraian;
                       $nilaiDR  =$row001->thn_m1;
					}
				        
			$sqllpe1 = "select 4 nor,'KOREKSI NILAI PERSEDIAAN' uraian,3 parent,20 seq,'412'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='2' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe1); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row002)
                    {
                       $kd_rek   =$row002->nor ;
                       $parent   =$row002->parent;
                       $nama     =$row002->uraian;
                       $nilailpe1  =$row002->thn_m1;
					}					

			$sqllpe2 = "select 6 nor,'LAIN-LAIN' uraian,3 parent,30 seq,'414'kode_1,isnull(sum(kredit-debet),0) thn_m1 from $trhju a
					inner join $trdju b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_unit where  reev='3' and kd_rek5=3110101 and year(a.tgl_voucher)=$thn_ang and month(tgl_voucher)<=$bulan and kd_skpd='$kd_skpd'";//Henri_TB
                            
                    $hasil = $this->db->query($sqllpe2); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row003)
                    {
                       $kd_rek   =$row003->nor ;
                       $parent   =$row003->parent;
                       $nama     =$row003->uraian;
                       $nilailpe2  =$row003->thn_m1;
					}
		

        $sal_akhir=$sal_awal+$surplus_lo3+$nilaiDR+$nilailpe1+$nilailpe2;
					
					if ($surplus_lo_lalu3 < 0){
                    	$lo15="("; $surplus_lo_lalu3=$surplus_lo_lalu3*-1; $lo16=")";}
                    else {
                    	$lo15=""; $lo16="";}						
                    $surplus_lo_lalu31 = number_format($surplus_lo_lalu3,"2",",",".");
					
					if ($selisih_surplus_lo3 < 0){
                    	$lo17="("; $selisih_surplus_lo3=$selisih_surplus_lo3*-1; $lo18=")";}
                    else {
                    	$lo17=""; $lo18="";}
                    $selisih_surplus_lo31 = number_format($selisih_surplus_lo3,"2",",",".");
					
					if ($lpe_lalu1 < 0){
                    	$lalu1="("; $lpe_lalu1=$lpe_lalu1*-1; $lalu2=")";}
                    else {
                    	$lalu1=""; $lpe_lalu1; $lalu2="";}				

					if ($lpe_lalu2 < 0){
                    	$lalu3="("; $lpe_lalu2=$lpe_lalu2*-1; $lalu4=")";}
                    else {
                    	$lalu3=""; $lpe_lalu2; $lalu4="";}

					if ($lpe_lalu3 < 0){
                    	$lalu5="("; $lpe_lalu3=$lpe_lalu3*-1; $lalu6=")";}
                    else {
                    	$lalu5=""; $lpe_lalu3; $lalu6="";}
						
					if ($nilaiDR < 0){
                    	$l000="("; $nilaiDR=$nilaiDR*-1; $p000=")";}
                    else {
                    	$l000=""; $nilaiDR; $p000="";}		

					if ($nilailpe1 < 0){
                    	$l001="("; $nilailpe1=$nilailpe1*-1; $p001=")";}
                    else {
                    	$l001=""; $nilailpe1; $p001="";}

					if ($nilailpe2 < 0){
                    	$l002="("; $nilailpe2=$nilailpe2*-1; $p002=")";}
                    else {
                    	$l002=""; $nilailpe2; $p002="";}

                    if ($surplus_lo3 < 0){
                    	$lo13="("; $surplus_lo3=$surplus_lo3*-1; $lo14=")";}
                    else {
                    	$lo13=""; $lo14="";}		
                    $surplus_lo31 = number_format($surplus_lo3,"2",",",".");
					
					if ($sal_akhir < 0)
					{
						$c = "("; $sal_akhir = $sal_akhir * -1; $d = ")";
					} else
					{
						$c = ""; $sal_akhir; $d = "";
					}

					if ($sal_awal < 0)
					{
						$c1 = "("; $sal_awal = $sal_awal * -1; $d1 = ")";
					} else
					{
						$c1 = ""; $sal_awal; $d1 = "";
					}

					if ($real < 0)
					{
						$cx = "("; $real = $real * -1; $dx = ")";
					} else
					{
						$cx = ""; $real; $dx = "";
					}

	 $modtahun= $thn_ang%4;
	 
	 if ($modtahun = 0){
        $nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
            else {
        $nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
	 
	 $arraybulan=explode(".",$nilaibulan);

    
         $cRet = '';
         
		  $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>IV. LAPORAN PERUBAHAN EKUITAS (LPE) </strong></td>                         
                    </tr></table><br>";
		 
		 $cRet .="<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                         <td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS</strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN $arraybulan[$cbulan] $thn_ang DAN $thn_ang_1</strong></td>
                    </tr>
					<tr>
                         <td align=\"center\"><strong>&nbsp</strong></td>
                    </tr>
					<tr>
                         <td align=\"right\">(dalam rupiah)</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>KODE</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>$arraybulan[$cbulan] $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"25%\" align=\"center\"><b>$arraybulan[$cbulan] $thn_ang_1</b></td>
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                        
                         </tr>
                     </tfoot>
                   
                     <tr>                          
                            <td style=\"vertical-align:top;\" ><b>PENDAPATAN</td>
                            <td style=\"vertical-align:top;\" >&nbsp;</td>
                            <td style=\"vertical-align:top;\" >&nbsp;</td>
                            <td style=\"vertical-align:top;\" >&nbsp;</td>
                        </tr>";
                
                     $sql = "SELECT * FROM map_lpe_skpd  ORDER BY seq";
                            
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       
					   
/*        if ($nilai_1 < 0)
        {
            $tx = "(";
            $nilai_1 = $nilai_1 * -1;
            $ty = ")";
        } else
        {
            $tx = "";
            $ty = "";
        }
*/
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      
                                                      <td valign=\"top\" align=\"left\" style=\"font-size:14px;\">$nama</td>
                                                      <td valign=\"top\" align=\"left\" style=\"font-size:14px;\"></td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\"> $c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\">$cx".number_format($real,"2",",",".")."$dx</td>
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                     
                                                      <td valign=\"top\" align=\"left\" style=\"font-size:14px;\">$nama</td>
													  <td valign=\"top\" align=\"left\" style=\"font-size:14px;\"></td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\"> $lo13".number_format($surplus_lo3,"2",",",".")."$lo14</td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\">$lo15".number_format($surplus_lo_lalu3,"2",",",".")."$lo16</td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                     
                                                      <td valign=\"top\" align=\"left\" style=\"font-size:14px;\"><b>$nama</td>
													  <td valign=\"top\" align=\"left\" style=\"font-size:14px;\"></td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\"></td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\"></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 4: 
                                            $cRet .="<tr>
                                                      
                                                      <td valign=\"top\" align=\"left\" style=\"font-size:14px;\">$nama</td>
													  <td valign=\"top\" align=\"left\" style=\"font-size:14px;\"></td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\">$l001".number_format($nilailpe1,"2",",",".")."$p001</td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\">$lalu1".number_format($lpe_lalu2,"2",",",".")."$lalu2</td>
                                                     </tr>";
									break;
                                    case 5:
                                            $cRet .="<tr>
                                                      
                                                      <td valign=\"top\" align=\"left\" style=\"font-size:14px;\">$nama</td>
													  <td valign=\"top\" align=\"left\" style=\"font-size:14px;\"></td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\">$l000".number_format($nilaiDR,"2",",",".")."$p000</td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\">$lalu3".number_format($lpe_lalu1,"2",",",".")."$lalu4</td>
                                                     </tr>";
									break;
                                    case 6:
                                            $cRet .="<tr>
                                                      
                                                      <td valign=\"top\" align=\"left\" style=\"font-size:14px;\">$nama</td>
													  <td valign=\"top\" align=\"left\" style=\"font-size:14px;\"></td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\">$l002".number_format($nilailpe2,"2",",",".")."$p002</td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;\">$lalu5".number_format($lpe_lalu3,"2",",",".")."$lalu6</td>
                                                     </tr>";
									break;
                                    case 7:
                                            $cRet .="<tr>
                                                     
                                                      <td valign=\"top\" align=\"center\" style=\"font-size:14px;border-bottom:none;\"><b>$nama</td>
													  <td valign=\"top\" align=\"left\" style=\"font-size:14px;border-bottom:none;\"></td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;border-bottom:none;\"><b>$c".number_format($sal_akhir,"2",",",".")."$d</td>
                                                      <td valign=\"top\" align=\"right\" style=\"font-size:14px;border-bottom:none;\"><b>$c1".number_format($sal_awal,"2",",",".")."$d1</td>
                                                     </tr>";
                                } 
                       
                    }                           

        $cRet .=       " </table><br>";
		
		$cRet.='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="1" align=center> 
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$daerah.', '.$this->tukd_model->tanggal_format_indonesia($dcetak).'</TD>
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$jabatan.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$nama_ttd.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">NIP: '.$nip.'</TD> 
					</TR>					
					</TABLE>
					'; 
		
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = ("LPE UNIT $cbulan");
        $this->template->set('title', 'LPE UNIT $cbulan');  
         $cetak=1;
		 switch ($cetak)
        {
            case 4;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				echo $cRet;
				break;
            case 1;
				echo "<title>IV LPE</title>";
				echo $cRet;
               break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

    }
	
	function cetak_babIII_pend($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
		$spasi = "line-height: 1.5em;";
		$thn     = $this->session->userdata('pcThang');
			
		$arraytgl=explode("-",$dcetak);		
			
			
		$tgl   = $arraytgl[2];
		$bln   = $arraytgl[1];
		$thn   = $arraytgl[0];
		
		$cbulan  = 12;
		
		$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 0
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 0
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 0
					   else 1 end as anggaran from trhrka where kd_skpd='$kd_skpd'";
		
		$sqlanggaran=$this->db->query($sqlanggaran1);
		foreach ($sqlanggaran->result() as $rowttd)
			{
				$anggaran=$rowttd->anggaran;
			}
		
		$ang = $anggaran;
		$cthnsbl = $thn-1;
		
		if($cbulan== 12){
		$sumber_data= "_at";
		$trdju = "trdju_calk";
        $trhju = "trhju_calk";
		}else{
		$sumber_data= "";
		$trdju = "trdju";
        $trhju = "trhju";
		}
		
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd'";
        $sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$nmskpd = $rowsc->nm_skpd;
		} 
		$nm_skpd = strtoupper($nmskpd);	
	
		$lcttd = str_replace('a',' ',$ttd);
		$sqlsc ="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc){
			$kab     = $rowsc->kab_kota;
			$prov    = $rowsc->provinsi;
			$daerah  = $rowsc->daerah;
			//$thn     = $rowsc->thn_ang;
		}
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd){
			$nip      =$rowttd->nip;                    
			$nama_ttd = $rowttd->nm;
			$jabatan  = $rowttd->jab;
		}
		
		if($jnsctk==1){
			$bg_color = "bgcolor=\"yellow\"";
			$tombol = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_pendapatan_411\" methode=\"get\" target=\"blank\">
						 <input type=\"submit\" value=\"Edit\">
						 <input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol2 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_pendapatan_412\" methode=\"get\" target=\"blank\">
						 <input type=\"submit\" value=\"Edit\">
						 <input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol3 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_pendapatan_414\" methode=\"get\" target=\"blank\">
						 <input type=\"submit\" value=\"Edit\">
						 <input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		}else{
			$bg_color = "";
			$tombol = "";
			$tombol2 = "";
			$tombol3 = "";
		}
		$cRet = '';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                        <td align=\"center\"><strong>BAB III  PENJELASAN POS-POS LAPORAN KEUANGAN</strong></td>                         
                    </tr>
				 </table><br>";

        $cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\"><strong>3.1</strong></td>                         
						 <td align=\"left\" colspan=\"2\"><strong>Rincian dan Penjelasan masing-masing pos-pos laporan Keuangan.</strong></td>                         
					</tr>
					<tr>
						 <td align=\"left\" width=\"2%\"><strong>&nbsp;</strong></td>                         
						 <td align=\"left\" width=\"4%\"><strong>3.1.1.</strong></td>                         
						 <td align=\"left\"><strong>Laporan Realisasi Anggaran</strong></td>                         
					</tr>
				  </table><br>";
				  
		$cRet .= "<table style=\"".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\" rowspan=\"2\"><strong>&nbsp;</strong></td>                         
						 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"center\" width=\"10%\" rowspan=\"2\"><strong>Reff</strong></td>                         
						 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"center\" width=\"30%\" rowspan=\"2\"><strong>Uraian</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"15%\"><strong>Anggaran $thn</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"15%\"><strong>Realisasi $thn</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"10%\"><strong>Lebih / (Kurang)</strong></td>   						  
						 <td style=\"border-top:solid;border-bottom:solid;\" align=\"center\" width=\"5%\" rowspan=\"2\"><strong>%</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"13%\"><strong>Realisasi $cthnsbl</strong></td>
					</tr>
					<tr>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>                                               
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>                                               
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
			
			$prv = $this->db->query("select case when ($ang=0) then ISNULL(sum(a.nilai),0) when ($ang=1) then ISNULL(sum(a.nilai_sempurna),0) else ISNULL(sum(a.nilai_ubah),0) end as anggaran
										from 
										(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
										a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
										where a.kd_skpd='$kd_skpd'");
			$prvn = $prv->row();          
			$cek = $prvn->anggaran; 
			
			
			if($cek==0){
				$sql_4 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
						select b.kd_skpd, LEFT(a.kd_rek5,1) kd_rek5, (select nm_rek1 from ms_rek1 where kd_rek1=LEFT(a.kd_rek5,1)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)='4' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,1)
						) x
						UNION ALL
						SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
						select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, (select nm_rek2 from ms_rek2 where kd_rek2=LEFT(a.kd_rek5,2)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)='4' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,2)
						) x";
			}else{
				$sql_4 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, y.real_tlalu FROM (
						Select kd_skpd, LEFT(kd_rek5,1) kd_rek5,(select nm_rek1 from ms_rek1 where kd_rek1=LEFT(kd_rek5,1)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn' 
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,1)='4'
						GROUP BY kd_skpd, LEFT(kd_rek5,1) ) x
						LEFT JOIN
						(select b.kd_skpd, LEFT(a.kd_rek5,1) kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)='4' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,1)) y
						on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
						 
						UNION ALL
						SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, y.real_tlalu FROM (
						Select kd_skpd, LEFT(kd_rek5,2) kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(kd_rek5,2)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn' 
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,1)='4'
						GROUP BY kd_skpd, LEFT(kd_rek5,2)) x
						LEFT JOIN
						(select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)='4' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,2)) y
						on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
			}
        $sql_44=$this->db->query($sql_4);
		
		foreach ($sql_44->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_pend  = $rowsc->anggaran;
			$realisasi_pend = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_pend-$anggaran_pend;
			$banding         = $realisasi_pend - $realisasi_tlalu;
			$persen_pen     = ($anggaran_pend!=0)?($realisasi_pend / $anggaran_pend ) * 100:0; 
			
			$ang_pen  = empty($anggaran_pend) || $anggaran_pend == 0 ? number_format(0,"2",",",".") :number_format($anggaran_pend,"2",",",".");
			$real_pen = empty($realisasi_pend) || $realisasi_pend == 0 ? number_format(0,"2",",",".") :number_format($realisasi_pend,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			$per_pen  = empty($persen_pen) || $persen_pen == 0 ? number_format(0,"2",",",".") :number_format($persen_pen,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_bel = $banding*-1;
					$banding_bel = empty($ban_bel) || $ban_bel == 0 ? number_format(0,"2",",",".") :number_format($ban_bel,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$naik_turun = "tidak mencapai target";
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else if($lebih_kurang==0){
					$naik_turun = "mencapai target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}else{
					$naik_turun = "melebihi target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
	
			
			if($panjang=='1'){
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$kd_rek5."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$ang_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_pen."</strong></td>
							 <td align=\"right\"><strong>".$a."".$leb_kur."".$b."</strong></td>   						  
							 <td align=\"center\"><strong>".$per_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
						</tr>
						<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." - LRA pada ".$nm_skpd." Tahun Anggaran  ".$thn."  sampai dengan  ".$this->tukd_model->tanggal_format_indonesia($dcetak)." memiliki Target sebesar Rp. ".$ang_pen." dan realisasi sebesar Rp. ".$real_pen." maka $naik_turun sebesar Rp. ".$a."".$leb_kur."".$b." atau ".$per_pen."<strong>&nbsp;%</strong>.</td>                         
						</tr>
						<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
			}else{
				$cRet .= "
						 <tr>
							 <td align=\"left\">&nbsp;</td> 
							 <td align=\"right\">&nbsp;</td>
							 <td align=\"left\">".$this->dotrek($kd_rek5)." ".$nm_rek5."</td>
							 <td align=\"right\">".$ang_pen."</td>
							 <td align=\"right\">".$real_pen."</td>
							 <td align=\"right\">".$a."".$leb_kur."".$b."</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\">".$real_tlalu."</td>
						  </tr>";
			}
		
		}
		
		
		//41
		if($cek==0){
			$sql_41 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
						select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, (select nm_rek2 from ms_rek2 where kd_rek2=LEFT(a.kd_rek5,2)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,2)='41' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,2)
						) x
						UNION ALL
						SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
						select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, (select nm_rek3 from ms_rek3 where kd_rek3=LEFT(a.kd_rek5,3)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,2)='41' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,3)
						) x";
		}else{
		
		$sql_41 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, y.real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,2) kd_rek5,(select nm_rek2 from ms_rek2 where kd_rek2=LEFT(kd_rek5,2)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)=$thn
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,2)='41'
						GROUP BY kd_skpd, LEFT(kd_rek5,2))x
						LEFT JOIN
						(select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,2)='41' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,2)) y
						on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
						
						UNION ALL
						SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, y.real_tlalu FROM (
						Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)=$thn
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,2)='41'
						GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
						LEFT JOIN
						(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,2)='41' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
						on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
        }
		$sql_441=$this->db->query($sql_41);
		
		foreach ($sql_441->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_pend  = $rowsc->anggaran;
			$realisasi_pend = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_pend-$anggaran_pend;
			$banding         = $realisasi_pend - $realisasi_tlalu;
			$persen_pen     = ($anggaran_pend!=0)?($realisasi_pend / $anggaran_pend ) * 100:0; 
			
			$ang_pen  = empty($anggaran_pend) || $anggaran_pend == 0 ? number_format(0,"2",",",".") :number_format($anggaran_pend,"2",",",".");
			$real_pen = empty($realisasi_pend) || $realisasi_pend == 0 ? number_format(0,"2",",",".") :number_format($realisasi_pend,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_pen = $banding*-1;
					$banding_pen = empty($ban_pen) || $ban_pen == 0 ? number_format(0,"2",",",".") :number_format($ban_pen,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			$per_pen  = empty($persen_pen) || $persen_pen == 0 ? number_format(0,"2",",",".") :number_format($persen_pen,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($lebih_kurang<0){
					$naik_turun = "tidak mencapai target";
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else if($lebih_kurang==0){
					$naik_turun = "mencapai target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}else{
					$naik_turun = "melebihi target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			if($panjang=='2'){
				$cRet .= "	<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>
							<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$ang_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_pen."</strong></td>
							 <td align=\"right\"><strong>".$a."".$leb_kur."".$b."</strong></td>   						  
							 <td align=\"center\"><strong>".$per_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
						</tr>";
			}else{
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td> 
							 <td align=\"right\">&nbsp;</td>
							 <td align=\"left\">".$this->dotrek($kd_rek5)." ".$nm_rek5."</td>
							 <td align=\"right\">".$ang_pen."</td>
							 <td align=\"right\">".$real_pen."</td>
							 <td align=\"right\">".$a."".$leb_kur."".$b."</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\">".$real_tlalu."</td>
						  </tr>
						  ";
			}
		
		}
		
		//411
		if($cek==0){
			$sql_411 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
						select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, (select nm_rek3 from ms_rek3 where kd_rek3=LEFT(a.kd_rek5,3)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,3)='411' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,3)
						) x";
		}else{
		$sql_411 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='411'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3)='411' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
        }
		$sql_4411=$this->db->query($sql_411);
		
		$no=1;
		foreach ($sql_4411->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			//$kd_ang         = $rowsc->kd_ang;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_pend  = $rowsc->anggaran;
			$realisasi_pend = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_pend-$anggaran_pend;
			$banding         = $realisasi_pend - $realisasi_tlalu;
			$persen_pen     = ($anggaran_pend!=0)?($realisasi_pend / $anggaran_pend ) * 100:0; 
			
			$ang_pen  = empty($anggaran_pend) || $anggaran_pend == 0 ? number_format(0,"2",",",".") :number_format($anggaran_pend,"2",",",".");
			$real_pen = empty($realisasi_pend) || $realisasi_pend == 0 ? number_format(0,"2",",",".") :number_format($realisasi_pend,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			$per_pen  = empty($persen_pen) || $persen_pen == 0 ? number_format(0,"2",",",".") :number_format($persen_pen,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_pend = $banding*-1;
					$banding_pend = empty($ban_pend) || $ban_pend == 0 ? number_format(0,"2",",",".") :number_format($ban_pend,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_pend = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$naik_turun = "tidak mencapai target";
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else if($lebih_kurang==0){
					$naik_turun = "mencapai target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}else{
					$naik_turun = "melebihi target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			if($lebih_kurang<0){
				$naik_turun = "selisih";
			}else{
				$naik_turun = "kenaikan";
			} 
			
				$cRet .= "
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$ang_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_pen."</strong></td>
							 <td align=\"right\"><strong>".$a."".$leb_kur."".$b."</strong></td>   						  
							 <td align=\"center\"><strong>".$per_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
						</tr>
						";
		}
		
		//411_det
		if($cek==0){
			$sql_411_det="SELECT m.*,  x.ket1, x.ket2 FROM (
							select b.kd_skpd, LEFT(a.map_real,5) kd_ang, LEFT(a.kd_rek5,5) kd_rek5, (select nm_rek4 from ms_rek4 where kd_rek4=LEFT(a.map_real,5)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
							from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
							where left(a.kd_rek5,3)='411' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
							group by b.kd_skpd, LEFT(a.map_real,5), LEFT(a.kd_rek5,5)
							UNION ALL
							select b.kd_skpd, a.map_real kd_ang, a.kd_rek5, (select nm_rek5 from ms_rek5 where kd_rek5=a.map_real) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
							from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
							where left(a.kd_rek5,3)='411' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
							group by b.kd_skpd, a.map_real, a.kd_rek5
							) m
							LEFT JOIN
							(select * from lamp_calk_at where kd_skpd='$kd_skpd') x
							on m.kd_skpd=x.kd_skpd and m.kd_rek5=x.kd_rek5 
							order by kd_ang";
		}else{
		$sql_411_det="SELECT m.*, x.ket1, x.ket2 FROM (
						Select kd_skpd, LEFT(kd_ang,5) kd_ang, LEFT(kd_rek5,5) kd_rek5,(select nm_rek4 from ms_rek4 where kd_rek4=LEFT(kd_ang,5)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi , sum(real_tlalu) real_tlalu
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj, isnull(c.real_tlalu,0) as real_tlalu from
						(select a.kd_skpd, LEFT(a.kd_rek5,5) kd_rek5 , LEFT(b.kd_rek64,5) kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, LEFT(a.kd_rek5,5), LEFT(b.kd_rek64,5)) a
						LEFT JOIN
						(select b.kd_skpd, LEFT(a.kd_rek5,5) kd_rek5, LEFT(a.map_real,5) map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
						from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)=$thn
						group by kd_skpd, LEFT(a.kd_rek5,5), LEFT(a.map_real,5))
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5
						LEFT JOIN
						(select b.kd_skpd, LEFT(a.kd_rek5,5) kd_rek5 , LEFT(a.map_real,5) map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)=$cthnsbl
						group by kd_skpd, LEFT(a.kd_rek5,5), LEFT(a.map_real,5)) c on b.kd_rek5=c.kd_rek5 and b.kd_skpd=c.kd_skpd) z
						WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='411'
						GROUP BY kd_skpd, LEFT(kd_ang,5), LEFT(kd_rek5,5)
						) m
						LEFT JOIN
						(select * from lamp_calk_at where kd_skpd='$kd_skpd') x
						on m.kd_skpd=x.kd_skpd and m.kd_rek5=x.kd_rek5 and m.kd_ang=x.kd_ang
						order by kd_ang";
		}
		$sql_411_det2=$this->db->query($sql_411_det);
		
		$no=1;
		foreach ($sql_411_det2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_ang         = $rowsc->kd_ang;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_pend  = $rowsc->anggaran;
			$realisasi_pend = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$ket1           = $rowsc->ket1;
			$ket2           = $rowsc->ket2;
			$lebih_kurang   = $realisasi_pend-$anggaran_pend;
			$persen_pen     = ($anggaran_pend!=0)?($realisasi_pend / $anggaran_pend ) * 100:0; 
			
			$ang_pen  = empty($anggaran_pend) || $anggaran_pend == 0 ? number_format(0,"2",",",".") :number_format($anggaran_pend,"2",",",".");
			$real_pen = empty($realisasi_pend) || $realisasi_pend == 0 ? number_format(0,"2",",",".") :number_format($realisasi_pend,"2",",",".");
			$per_pen  = empty($persen_pen) || $persen_pen == 0 ? number_format(0,"2",",",".") :number_format($persen_pen,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			$real_banding = $realisasi_pend-$realisasi_tlalu;
			
			if($lebih_kurang<0){
					$naik_turun = "tidak mencapai target";
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else if($lebih_kurang==0){
					$naik_turun = "mencapai target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}else{
					$naik_turun = "melebihi target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
			if($real_banding<0){
					$x = "(";
					$y = ")";
					$hitung_banding = $real_banding*-1;
					$leb_kur_banding  = empty($hitung_banding) || $hitung_banding == 0 ? number_format(0,"2",",",".") :number_format($hitung_banding,"2",",",".");
				}else if($real_banding==0){
					$x = "";
					$y = "";
					$leb_kur_banding  = empty($real_banding) || $real_banding == 0 ? number_format(0,"2",",",".") :number_format($real_banding,"2",",",".");
				}else{
					$x = "";
					$y = "";
					$leb_kur_banding  = empty($real_banding) || $real_banding == 0 ? number_format(0,"2",",",".") :number_format($real_banding,"2",",",".");
				} 
			
			if($realisasi_tlalu<$realisasi_pend){
				$naik_turun_banding = "kenaikan";
			}else if($realisasi_tlalu==$realisasi_pend){
				$naik_turun_banding = "tidak terjadi perubahan";
			}else{
				$naik_turun_banding = "penurunan";
			}
			
			if($ket1==''){
				$edit ="&nbsp;";
				$ket1="";
			}else{
				$ket1=$ket1;
				$edit ="";
			}
			
			if($ket2==''){
				$ket2="";
				$edit ="&nbsp;";
			}else{
				$ket2=$ket2;
				$edit ="";
			}
			
			
				$cRet .= "
						<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\">- ".$nm_rek5."</td>
							 <td align=\"right\">".$ang_pen."</td>
							 <td align=\"right\">".$real_pen."</td>
							 <td align=\"right\">".$a."".$leb_kur."".$b."</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\">".$real_tlalu."</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">Target ".$nm_rek5." pada tahun ".$thn." sebesar Rp. ".$ang_pen." terealisasi sebesar Rp. ".$real_pen." atau ".$per_pen." maka ".$naik_turun." sebesar Rp. ".$a."".$leb_kur."".$b."</td>                         
						</tr>
						
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">Realisasi ".$nm_rek5." pada tahun ".$thn." sebesar Rp. ".$real_pen." dan realisasi tahun ".$cthnsbl." sebesar Rp. ".$real_tlalu." terjadi  ".$naik_turun_banding." sebesar Rp. ".$x."".$leb_kur_banding."".$y."</td>                         
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" $bg_color colspan=\"7\">".$edit."".$ket1."</td>                         
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol
							</td>                         
						</tr>";
				
		}
		
		$cRet .= "<tr>
					 <td align=\"left\"><strong>&nbsp;</strong></td>                         
					 <td align=\"center\"><strong>&nbsp;</strong></td>                         
					 <td align=\"center\"><strong>&nbsp;</strong></td>
					 <td align=\"center\"><strong>&nbsp;</strong></td>
					 <td align=\"center\"><strong>&nbsp;</strong></td>
					 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
					 <td align=\"center\"><strong></strong>&nbsp;</td>
					 <td align=\"center\"><strong></strong>&nbsp;</td>
				</tr>";
		
		//412
		$sql_412 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='412'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3)='412' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
        $sql_4412=$this->db->query($sql_412);
		
		$no=1;
		foreach ($sql_4412->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			//$kd_ang         = $rowsc->kd_ang;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_pend  = $rowsc->anggaran;
			$realisasi_pend = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_pend-$anggaran_pend;
			$banding         = $realisasi_pend - $realisasi_tlalu;
			$persen_pen     = ($anggaran_pend!=0)?($realisasi_pend / $anggaran_pend ) * 100:0; 
			
			$ang_pen  = empty($anggaran_pend) || $anggaran_pend == 0 ? number_format(0,"2",",",".") :number_format($anggaran_pend,"2",",",".");
			$real_pen = empty($realisasi_pend) || $realisasi_pend == 0 ? number_format(0,"2",",",".") :number_format($realisasi_pend,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			$per_pen  = empty($persen_pen) || $persen_pen == 0 ? number_format(0,"2",",",".") :number_format($persen_pen,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_pend = $banding*-1;
					$banding_pend = empty($ban_pend) || $ban_pend == 0 ? number_format(0,"2",",",".") :number_format($ban_pend,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_pend = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			
			if($lebih_kurang<0){
					$naik_turun = "tidak mencapai target";
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else if($lebih_kurang==0){
					$naik_turun = "mencapai target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}else{
					$naik_turun = "melebihi target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$ang_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_pen."</strong></td>
							 <td align=\"right\"><strong>".$a."".$leb_kur."".$b."</strong></td>   						  
							 <td align=\"center\"><strong>".$per_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
						</tr>";
		}
		
		if($kd_skpd=='2.01.01.03'){
			$khusus = "UNION ALL
						select b.kd_skpd, a.map_real kd_ang, a.kd_rek5, (select nm_rek5 from ms_rek5 where kd_rek5=a.map_real) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu, '' ket1, '' ket2 
						from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,3)='412' and a.kd_unit='2.01.01.03' and YEAR(b.tgl_voucher)='2016'
						group by b.kd_skpd, a.kd_rek5, a.map_real";
		}else{
			$khusus = "";
		}
		
		//412_det
		$sql_412_det="SELECT m.* , n.real_tlalu , x.ket1, x.ket2 FROM (
						Select kd_skpd, LEFT(kd_ang,5) kd_ang, LEFT(kd_rek5,5) kd_rek5,(select nm_rek4 from ms_rek4 where kd_rek4=LEFT(kd_ang,5)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)=$thn
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='412'
						GROUP BY kd_skpd, LEFT(kd_ang,5), LEFT(kd_rek5,5)
						) m
						LEFT JOIN
						(select * from lamp_calk_at where kd_skpd='$kd_skpd') x
						on m.kd_skpd=x.kd_skpd and m.kd_rek5=x.kd_rek5 and m.kd_ang=x.kd_ang
						LEFT JOIN (
						select b.kd_skpd, LEFT(a.kd_rek5,5) kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,3)='412' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,5)
						UNION ALL
						select b.kd_skpd, a.kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,3)='412' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, a.kd_rek5 ) n
						on m.kd_skpd=n.kd_skpd and m.kd_rek5=n.kd_rek5
						$khusus
						order by kd_ang";
		$sql_4412_det=$this->db->query($sql_412_det);
		
		$no=1;
		foreach ($sql_4412_det->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_ang         = $rowsc->kd_ang;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_pend  = $rowsc->anggaran;
			$realisasi_pend = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$ket1           = $rowsc->ket1;
			$ket2           = $rowsc->ket2;
			$lebih_kurang   = $realisasi_pend-$anggaran_pend;
			$banding         = $realisasi_pend - $realisasi_tlalu;
			$persen_pen     = ($anggaran_pend!=0)?($realisasi_pend / $anggaran_pend ) * 100:0; 
			
			$ang_pen  = empty($anggaran_pend) || $anggaran_pend == 0 ? number_format(0,"2",",",".") :number_format($anggaran_pend,"2",",",".");
			$real_pen = empty($realisasi_pend) || $realisasi_pend == 0 ? number_format(0,"2",",",".") :number_format($realisasi_pend,"2",",",".");
			
			$per_pen  = empty($persen_pen) || $persen_pen == 0 ? number_format(0,"2",",",".") :number_format($persen_pen,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			
			$panjang = strlen($kd_rek5);
			
			if($lebih_kurang<0){
					$naik_turun = "tidak mencapai target";
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else if($lebih_kurang==0){
					$naik_turun = "mencapai target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}else{
					$naik_turun = "melebihi target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			if($ket1==''){
				$edit ="&nbsp;";
				$ket1="";
			}else{
				$ket1=$ket1;
				$edit ="";
			}
			
			if($ket2==''){
				$ket2="";
				$edit ="&nbsp;";
			}else{
				$ket2=$ket2;
				$edit ="";
			}
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_pend = $banding*-1;
					$banding_pend = empty($ban_pend) || $ban_pend == 0 ? number_format(0,"2",",",".") :number_format($ban_pend,"2",",",".");
					$naik_turun_banding = "penurunan";
				}else{
					$c = "";
					$d = "";
					$banding_pend = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
					$naik_turun_banding = "kenaikan";
				}
			
			
				$cRet .= "
						<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\">- ".$nm_rek5."</td>
							 <td align=\"right\">".$ang_pen."</td>
							 <td align=\"right\">".$real_pen."</td>
							 <td align=\"right\">".$a."".$leb_kur."".$b."</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\">".$real_tlalu."</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">Target ".$nm_rek5." pada tahun ".$thn." sebesar Rp. ".$ang_pen." terealisasi sebesar Rp. ".$real_pen." atau ".$per_pen." maka ".$naik_turun." sebesar Rp. ".$a."".$leb_kur."".$b."</td>                         
						</tr>
						
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">Realisasi ".$nm_rek5." pada tahun ".$thn." sebesar Rp. ".$real_pen." dan realisasi tahun ".$cthnsbl." sebesar Rp. ".$real_tlalu." terjadi  ".$naik_turun_banding." sebesar Rp. ".$c."".$banding_pend."".$d."</td>                         
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" $bg_color colspan=\"7\">".$edit."".$ket1."</td>                         
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol2
							</td>                         
						</tr>";
				
		}
		
		
		//414
		
		if($cek==0){
			$sql_411 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
						select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, (select nm_rek3 from ms_rek3 where kd_rek3=LEFT(a.kd_rek5,3)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,3)='414' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,3)
						) x";
		}else{
		$sql_411 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='414'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3)='414' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
        }
		$sql_4411=$this->db->query($sql_411);
		
		$no=1;
		foreach ($sql_4411->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			//$kd_ang         = $rowsc->kd_ang;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_pend  = $rowsc->anggaran;
			$realisasi_pend = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_pend-$anggaran_pend;
			$banding         = $realisasi_pend - $realisasi_tlalu;
			$persen_pen     = ($anggaran_pend!=0)?($realisasi_pend / $anggaran_pend ) * 100:0; 
			
			$ang_pen  = empty($anggaran_pend) || $anggaran_pend == 0 ? number_format(0,"2",",",".") :number_format($anggaran_pend,"2",",",".");
			$real_pen = empty($realisasi_pend) || $realisasi_pend == 0 ? number_format(0,"2",",",".") :number_format($realisasi_pend,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			$per_pen  = empty($persen_pen) || $persen_pen == 0 ? number_format(0,"2",",",".") :number_format($persen_pen,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_pend = $banding*-1;
					$banding_pend = empty($ban_pend) || $ban_pend == 0 ? number_format(0,"2",",",".") :number_format($ban_pend,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_pend = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$naik_turun = "tidak mencapai target";
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else if($lebih_kurang==0){
					$naik_turun = "mencapai target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}else{
					$naik_turun = "melebihi target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			
				$cRet .= "
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$ang_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_pen."</strong></td>
							 <td align=\"right\"><strong>".$a."".$leb_kur."".$b."</strong></td>   						  
							 <td align=\"center\"><strong>".$per_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
						</tr>
						";
		}
		
		//414_det
		if($cek==0){
			$sql_411_det="SELECT m.*,  x.ket1, x.ket2 FROM (
							select b.kd_skpd, LEFT(a.map_real,5) kd_ang, LEFT(a.kd_rek5,5) kd_rek5, (select nm_rek4 from ms_rek4 where kd_rek4=LEFT(a.map_real,5)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
							from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
							where left(a.kd_rek5,3)='414' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
							group by b.kd_skpd, LEFT(a.map_real,5), LEFT(a.kd_rek5,5)
							UNION ALL
							select b.kd_skpd, a.map_real kd_ang, a.kd_rek5, (select nm_rek5 from ms_rek5 where kd_rek5=a.map_real) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
							from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
							where left(a.kd_rek5,3)='414' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
							group by b.kd_skpd, a.map_real, a.kd_rek5
							) m
							LEFT JOIN
							(select * from lamp_calk_at where kd_skpd='$kd_skpd') x
							on m.kd_skpd=x.kd_skpd and m.kd_rek5=x.kd_rek5 
							order by kd_ang";
		}else{
		$sql_411_det="SELECT m.*, x.ket1, x.ket2 FROM (
						Select kd_skpd, LEFT(kd_ang,5) kd_ang, LEFT(kd_rek5,5) kd_rek5,(select nm_rek4 from ms_rek4 where kd_rek4=LEFT(kd_ang,5)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi , sum(real_tlalu) real_tlalu
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj, isnull(c.real_tlalu,0) as real_tlalu from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)=$thn
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)=$cthnsbl
						group by kd_skpd, a.kd_rek5, a.map_real)
						c on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5  and b.map_real=c.map_real and b.kd_rek5=c.kd_rek5) z
						WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='414'
						GROUP BY kd_skpd, LEFT(kd_ang,5), LEFT(kd_rek5,5)
						) m
						LEFT JOIN
						(select * from lamp_calk_at where kd_skpd='$kd_skpd') x
						on m.kd_skpd=x.kd_skpd and m.kd_rek5=x.kd_rek5 and m.kd_ang=x.kd_ang
						order by kd_ang";
		}
		$sql_411_det2=$this->db->query($sql_411_det);
		
		$no=1;
		foreach ($sql_411_det2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_ang         = $rowsc->kd_ang;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_pend  = $rowsc->anggaran;
			$realisasi_pend = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$ket1           = $rowsc->ket1;
			$ket2           = $rowsc->ket2;
			$lebih_kurang   = $realisasi_pend-$anggaran_pend;
			$banding         = $realisasi_pend - $realisasi_tlalu;
			$persen_pen     = ($anggaran_pend!=0)?($realisasi_pend / $anggaran_pend ) * 100:0; 
			
			$ang_pen  = empty($anggaran_pend) || $anggaran_pend == 0 ? number_format(0,"2",",",".") :number_format($anggaran_pend,"2",",",".");
			$real_pen = empty($realisasi_pend) || $realisasi_pend == 0 ? number_format(0,"2",",",".") :number_format($realisasi_pend,"2",",",".");
			$per_pen  = empty($persen_pen) || $persen_pen == 0 ? number_format(0,"2",",",".") :number_format($persen_pen,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($lebih_kurang<0){
					$naik_turun = "tidak mencapai target";
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else if($lebih_kurang==0){
					$naik_turun = "mencapai target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}else{
					$naik_turun = "melebihi target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			if($ket1==''){
				$edit ="&nbsp;";
				$ket1="";
			}else{
				$ket1=$ket1;
				$edit ="";
			}
			
			if($ket2==''){
				$ket2="";
				$edit ="&nbsp;";
			}else{
				$ket2=$ket2;
				$edit ="";
			}
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_pend = $banding*-1;
					$banding_pend = empty($ban_pend) || $ban_pend == 0 ? number_format(0,"2",",",".") :number_format($ban_pend,"2",",",".");
					$naik_turun_banding = "penurunan";
				}else{
					$c = "";
					$d = "";
					$banding_pend = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
					$naik_turun_banding = "kenaikan";
				}
			
			
			
				$cRet .= "
						<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\">- ".$nm_rek5."</td>
							 <td align=\"right\">".$ang_pen."</td>
							 <td align=\"right\">".$real_pen."</td>
							 <td align=\"right\">".$a."".$leb_kur."".$b."</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\">".$real_tlalu."</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">Target ".$nm_rek5." pada tahun ".$thn." sebesar Rp. ".$ang_pen." terealisasi sebesar Rp. ".$real_pen." atau ".$per_pen." maka ".$naik_turun." sebesar Rp. ".$a."".$leb_kur."".$b."</td>                         
						</tr>
						
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">Realisasi ".$nm_rek5." pada tahun ".$thn." sebesar Rp. ".$real_pen." dan realisasi tahun ".$cthnsbl." sebesar Rp. ".$real_tlalu." terjadi  ".$naik_turun_banding." sebesar Rp. ".$a."".$leb_kur."".$b."</td>                         
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" $bg_color colspan=\"7\">".$edit."".$ket1."</td>                         
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol3
							</td>                         
						</tr>";
				
		}
		
		//43
		if($cek==0){
			$sql_41 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
						select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, (select nm_rek2 from ms_rek2 where kd_rek2=LEFT(a.kd_rek5,2)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,2)='43' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,2)
						) x
						UNION ALL
						SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
						select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, (select nm_rek3 from ms_rek3 where kd_rek3=LEFT(a.kd_rek5,3)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,2)='43' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,3)
						) x";
		}else{
		
		$sql_41 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, y.real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,2) kd_rek5,(select nm_rek2 from ms_rek2 where kd_rek2=LEFT(kd_rek5,2)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)=$thn
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,2)='43'
						GROUP BY kd_skpd, LEFT(kd_rek5,2))x
						LEFT JOIN
						(select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,2)='43' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,2)) y
						on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
						
						UNION ALL
						SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, y.real_tlalu FROM (
						Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka_pend where left(kd_rek5,1)=4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=4 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)=$thn
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,2)='43'
						GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
						LEFT JOIN
						(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.kredit,0)-isnull(a.debet,0)) as real_tlalu 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,2)='43' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
						group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
						on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
        }
		$sql_441=$this->db->query($sql_41);
		
		foreach ($sql_441->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_pend  = $rowsc->anggaran;
			$realisasi_pend = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_pend-$anggaran_pend;
			$banding         = $realisasi_pend - $realisasi_tlalu;
			$persen_pen     = ($anggaran_pend!=0)?($realisasi_pend / $anggaran_pend ) * 100:0; 
			
			$ang_pen  = empty($anggaran_pend) || $anggaran_pend == 0 ? number_format(0,"2",",",".") :number_format($anggaran_pend,"2",",",".");
			$real_pen = empty($realisasi_pend) || $realisasi_pend == 0 ? number_format(0,"2",",",".") :number_format($realisasi_pend,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_pen = $banding*-1;
					$banding_pen = empty($ban_pen) || $ban_pen == 0 ? number_format(0,"2",",",".") :number_format($ban_pen,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			$per_pen  = empty($persen_pen) || $persen_pen == 0 ? number_format(0,"2",",",".") :number_format($persen_pen,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($lebih_kurang<0){
					$naik_turun = "tidak mencapai target";
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else if($lebih_kurang==0){
					$naik_turun = "mencapai target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}else{
					$naik_turun = "melebihi target";
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			if($panjang=='2'){
				$cRet .= "	<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>
							<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$ang_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_pen."</strong></td>
							 <td align=\"right\"><strong>".$a."".$leb_kur."".$b."</strong></td>   						  
							 <td align=\"center\"><strong>".$per_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
						</tr>";
			}else{
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td> 
							 <td align=\"right\">&nbsp;</td>
							 <td align=\"left\">".$this->dotrek($kd_rek5)." ".$nm_rek5."</td>
							 <td align=\"right\">".$ang_pen."</td>
							 <td align=\"right\">".$real_pen."</td>
							 <td align=\"right\">".$a."".$leb_kur."".$b."</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\">".$real_tlalu."</td>
						  </tr>
						  ";
			}
		
		}
		
		$cRet .= "</table><br>";
		
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("BAB III $kd_skpd /");
        $this->template->set('title', 'BAB III $kd_skpd / $cbulan');        
        
		$pilih=1;
		switch($pilih) {       
        case 1;
			echo ("<title>BAB III</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }
	
	function cetak_penutup($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
        $spasi = "line-height: 1.5em;";
		$thn_ang = $this->session->userdata('pcThang');
        $lcskpd = $kd_skpd;
        $skpd = $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        
		$lcttd = str_replace('a',' ',$ttd);
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$lcskpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$lcskpd' and kode IN ('PA','KPA') and nip='$lcttd'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
                    <TR>
						<TD align="center" ><b>BAB V. PENUTUP</TD>
					</TR>
					</TABLE><br/>';
			$cRet .='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="10" align=center> 
						<TR><TD align="justify">
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Catatan atas Laporan Keuangan '.$skpd.' Provinsi Kalimantan Barat tahun anggaran '.$thn_ang.' ini disusun sebagai tindaklanjut dari Peraturan Pemerintah Nomor 71 Tahun 2010 tentang Standar Akuntansi Pemerintah; Peraturan Menteri Dalam Negeri Nomor 64 Tahun 2013 tentang Penerapan Standar Akuntansi Berbasis Akrual pada Pemerintah Daerah dan Peraturan Gubernur Kalimantan Barat Nomor 15 tahun 2014 tentang  Kebijakan Akuntansi Berbasis Akrual pada Pemerintah Provinsi Kalimantan Barat.<br><br>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Berdasarkan Peraturan Menteri Dalam Negeri nomor 64 tahun 2013 tentang Penerapan Standar Akuntansi Berbasis Akrual pada Pemerintah Daerah setiap SKPD wajib menyampaikan laporan keuangan akhir tahun terdiri : Laporan Realisasi Anggaran, Neraca, Laporan Operasional, Laporan Perubahan Ekuitas dan Catatan atas Laporan Keuangan.<br><br>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Demikian laporan keuangan ini kami susun dengan harapan semoga dapat memenuhi kewajiban akuntabilitas kepada para pihak yang terkait dan semoga dapat menjadi sumber informasi dalam penyusunan laporan keuangan di tingkat Pemerintah Provinsi Kalimantan Barat tahun anggaran '.$thn_ang.'.
						</TD></TR>
			</TABLE></br><br><br>';

			$cRet.='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center> 
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$daerah.', '.$this->tukd_model->tanggal_format_indonesia($dcetak).'</TD>
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$jabatan.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$nama.'</TD> 
					</TR>					
					<!--<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">NIP: '.$nip.'</TD> 
					</TR>-->					
					</TABLE>
					';
						
			$cRet .='</TABLE>';
			$ctk=0;
			$data['prev']= 'PENUTUP';
             switch ($ctk){
				case 0;
				echo ("<title>PENUTUP</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
			}
		}
	
	function cetak_pendahuluan($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
        $spasi = "line-height: 1.5em;";
        $peraturan   = "Peraturan Pemerintah Nomor 71 Tahun 2010";
        $permendagri = "Permendagri Nomor 64 Tahun 2013";
		
		$thn_ang = $this->session->userdata('pcThang');
        $lcskpd = $this->session->userdata('kdskpd');
        $skpd = $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        
		$lcttd = str_replace('a',' ',$ttd);
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$lcskpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$lcskpd' and kode IN ('PA','KPA') and nip='$lcttd'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
		
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
                    <TR>
						<TD align="center" ><b>BAB I PENDAHULUAN</TD>
					</TR>
					</TABLE><br/>';
			$cRet .='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="0" align=center> 
						<TR>
							<TD width="2%"><b>1.1</b>&nbsp;</TD>
							<TD align="justify" colspan="3"><b>Maksud dan Tujuan penyusunan Laporan Keuangan</b></TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD align="justify" colspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Laporan keuangan '.$skpd.' Provinsi Kalimantan Barat disusun berdasarkan standar akuntansi pemerintah mencakup komponen-komponen pokok yaitu Laporan Realisasi Anggaran, Laporan Operasional, Neraca, Laporan Perubahan Ekuitas dan Catatan atas Laporan Keuangan.</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD align="justify" colspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Penyusunan laporan keuangan pada intinya bertujuan untuk menyajikan informasi yang relevan mengenai posisi keuangan dan seluruh transaksi yang dilakukan oleh Satuan Kerja Perangkat Daerah (SKPD) selama periode tertentu. Laporan Keuangan SKPD terutama digunakan untuk membandingkan realisasi pendapatan dan belanja dengan anggaran yang telah ditetapkan, menilai kondisi keuangan, menilai efektivitas dan efisiensi, membantu menentukan ketaatannya terhadap peraturan perundang-undangan dan bermanfaat bagi para pengguna anggaran dalam membuat dan mengevaluasi kebijakan mengenai alokasi sumber daya dan keputusan ekonomi, sosial, maupun politik serta merupakan perwujudan pertanggungjawaban atas penggunaan anggaran dan/atau barang pada tingkat satuan kerja.</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD align="justify" colspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Laporan Keuangan '.$skpd.' Provinsi Kalimantan Barat Tahun  '.$thn_ang.'  ini telah disusun serta disajikan sesuai dengan  '.$peraturan.' tentang Standar Akuntansi Pemerintah (SAP) dan '.$permendagri.' tentang Penerapan Standar Akuntansi Pemerintahan Berbasis Akrual serta kaidah-kaidah pengelolaan keuangan dilingkungan Pemerintahan Provinsi Kalimantan Barat.</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD align="justify" colspan="3">&nbsp;</TD>
						</TR>
						<TR>
							<TD width="2%"><b>1.2</b></TD>
							<TD align="justify" colspan="3"><b>Landasan Hukum penyusunan Laporan Keuangan.</b></TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD align="justify" colspan="3">Laporan keuangan SKPD '.$skpd.' Provinsi Kalimantan Barat Tahun  '.$thn_ang.' ini diselenggarakan berdasarkan peraturan perundang-undangan yang mengatur keuangan daerah, antara lain :</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="4%">1.</TD>
							<TD align="justify" colspan="2">Pasal 18 ayat (6) Undang-Undang Dasar Negara Republik Indonesia Tahun 1945 (Lembaran Negara Republik Indonesia Tahun 1945 Nomor 45, Tambahan Lembaran Negara Republik Indonesia Nomor 10001);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">2.</TD>
							<TD align="justify" colspan="2">Undang-undang Nomor 25 Tahun 1956 tentang Pembentukan Daerah-Daerah Otonom Provinsi Kalimantan Barat, Kalimantan  Selatan  dan Kalimantan Timur (Lembaran Negara Republik Indonesia Tahun 1956 Nomor 65, Tambahan  Lembaran Negara Republik Indonesia Nomor  1106);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">3.</TD>
							<TD align="justify" colspan="2">Undang-Undang Nomor 17 Tahun 2003 tentang Keuangan Negara (Lembaran Negara Republik Indonesia Tahun 2003 Nomor 47, Tambahan Lembaran Negara Republik Indonesia Nomor 4286) ;</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">4.</TD>
							<TD align="justify" colspan="2">Undang-Undang  Nomor 1 Tahun  2004  tentang  Perbendaharaan Negara (Lembaran Negara Republik Indonesia Tahun 2004 Nomor  5, Tambahan Lembaran Negara Republik Indonesia Nomor 4355);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">5.</TD>
							<TD align="justify" colspan="2">Undang-Undang Nomor 15 Tahun 2004 tentang Pemeriksaan Pengelolaan dan Tanggungjawab Keuangan Negara (Lembaran Negara Republik Indonesia Tahun 2004 Nomor 66, Tambahan Lembaran Negara Republik Indonesia Nomor 4400);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">6.</TD>
							<TD align="justify" colspan="2">Undang-Undang Nomor 33 Tahun 2004 tentang Perimbangan Keuangan Antara Pemerintah Pusat Dan Pemerintah Daerah (Lembaran Negara Republik Indonesia Tahun 2004 Nomor 126, Tambahan Lembaran Negara Republik Indonesia Nomor 4438);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">7.</TD>
							<TD align="justify" colspan="2">Undang-Undang Nomor 23 Tahun 2014 tentang Pemerintahan Daerah sebagaimana telah diubah beberapa kali dan terakhir dengan Undang-Undang Nomor 9 Tahun 2015 tentang Perubahan Kedua Atas Undang-Undang Nomor 23 Tahun 2014 tentang Pemerintahan Daerah (Lembaran Negara Republik Indonesia Tahun 2015  Nomor 58, Tambahan  Lembaran Negara Republik Indonesia Nomor 5679);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">8.</TD>
							<TD align="justify" colspan="2">Peraturan Pemerintah  Nomor 109 Tahun 2000 tentang Kedudukan Keuangan Kepala Daerah dan Wakil Kepala Daerah (Lembaran Negara Republik Indonesia Tahun 2000 Nomor 210 Tambahan  Lembaran  Negara  Republik  Indonesia  Nomor 4028);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">9.</TD>
							<TD align="justify" colspan="2">Peraturan  Pemerintah  Nomor  54 Tahun  2005 tentang  Pinjaman Daerah (Lembaran Negara Republik Indonesia Tahun 2005 Nomor 136, Tambahan Lembaran Negara Republik Indonesia Nomor 4574);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">10.</TD>
							<TD align="justify" colspan="2">Peraturan Pemerintah  Nomor  55 Tahun 2005 tentang Dana Perimbangan (Lembaran Negara Republik Indonesia Tahun 2005 Nomor 137, Tambahan Lembaran Negara Republik Indonesia Nomor 4575);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">11.</TD>
							<TD align="justify" colspan="2">Peraturan Pemerintah Nomor  56 Tahun 2005  tentang  Sistem  Informasi  Keuangan Daerah  (Lembaran  Negara Republik Indonesia Tahun  2005 Nomor 138, Tambahan Lembaran Negara Republik Indonesia Nomor 4576);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">12.</TD>
							<TD align="justify" colspan="2">Peraturan Pemerintah Nomor 57 Tahun 2005 tentang  Hibah Kepada Daerah (Lembaran Negara Republik Indonesia Tahun 2005 Nomor 139, Tambahan Lembaran Negara Republik Indonesia Nomor 4577);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">13.</TD>
							<TD align="justify" colspan="2">Peraturan Pemerintah  Nomor 58 Tahun 2005 tentang Pengelolaan Keuangan Daerah  (Lembaran  Negara Republik  Indonesia Tahun 2005 Nomor 140, Tambahan Lembaran Negara Republik Indonesia Nomor  4578);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">14.</TD>
							<TD align="justify" colspan="2">Peraturan Pemerintah Nomor 8 Tahun 2006 tentang Pelaporan Keuangan dan Kinerja Instansi Pemerintah (Lembaran Negara Republik Indonesia Tahun 2006 Nomor 25, Tambahan Lembaran Negara Republik Indonesia  Nomor 4614);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">15.</TD>
							<TD align="justify" colspan="2">Peraturan Pemerintah Nomor 71 Tahun 2010 tentang Standar Akuntansi Pemerintahan (Lembaran Negara Republik Indonesia Tahun 2010 Nomor 123, Tambahan Lembaran Negara Republik Indonesia Nomor 5165); </TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">16.</TD>
							<TD align="justify" colspan="2">Peraturan Pemerintah Nomor 12 Tahun 2017 tentang Pembinaan dan Pengawasan Penyelenggaraan Pemeintah Daerah (Lembran Negara Republik Indonesia Tahun 2017 Nomor 73, Tambahan Lembaran Negara Republik Indonesia Nomor 6041); </TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">17.</TD>
							<TD align="justify" colspan="2">Peraturan Menteri Dalam Negeri Nomor 13 Tahun 2006 tentang Pedoman Pengelolaan Keuangan Daerah, sebagaimana telah diubah beberapa kali dan terakhir dengan Peraturan Menteri Dalam Negeri Nomor 21 Tahun 2011 tentang Perubahan Kedua Atas Peraturan Menteri Dalam Negeri Nomor 13 Tahun 2006 tentang Pedoman Pengelolaan Keuangan Daerah (Berita Negara Republik Indonesia Tahun 2011 Nomor 310);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">18.</TD>
							<TD align="justify" colspan="2">Peraturan Menteri Dalam Negeri Nomor 64 Tahun 2013 tentang Penerapan Standar Akuntansi Berbasis Akrual pada Pemerintah Daerah (Berita Negara Republik Indonesia Tahun 2013 Tahun 2013 Nomor 1425);</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">19.</TD>
							<TD align="justify" colspan="2">Peraturan Daerah Nomor 4 Tahun 2008 tentang Pokok-Pokok Pengelolaan Keuangan Daerah (Lembaran Daerah Provinsi Kalimantan Barat Tahun 2008 Nomor 4, Tambahan Lembaran Daerah Provinsi Kalimantan Barat Nomor 3 );</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="2%">20.</TD>
							<TD align="justify" colspan="2">Peraturan Gubernur Kalimantan Barat Nomor 15 Tahun 2014 tentang Kebijakan Akuntansi Brbasis Akrual pada Pemerintah Provinsi Kalimantan Barat (Berita Daerah Provinsi Kalimantan Barat Tahun 2014 Nomor 15);</TD>
						</TR>
					</TABLE>';
			
			$cRet .='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="0" align=center>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD align="justify" colspan="3">&nbsp;</TD>
						</TR>
						<TR>
							<TD width="2%"><b>1.3</b>&nbsp;</TD>
							<TD align="justify" colspan="3"><b>Sistematika penulisan catatan atas laporan keuangan</b></TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD align="justify" colspan="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setiap Pos dalam Laporan Realisasi Anggaran dan Neraca mempunyai referensi silang dengan informasi terkait dalam Catatan atas Laporan Keuangan. Dalam realisasinya mengacu pada kebijakan akuntansi yang mengatur penyusunan dan penyajian pelaporan keuangan daerah dan penggunaan sumber daya ekonomis yang dipercayakan, dengan pengungkapan-pengungkapan dan informasi tambahan lainnya yang diharapkan mempermudah para pengguna untuk memahami penjelasan pos-pos laporan keuangan SKPD 
							'.$skpd.' Provinsi Kalimantan Barat. </TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD align="justify" colspan="3">Karena itu penyusunan Catatan atas Laporan Keuangan (CaLK) '.$skpd.' Provinsi Kalimantan Barat tahun anggaran '.$thn_ang.', terdiri dari :</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD align="justify" colspan="3">&nbsp;</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">Bab I</TD>
							<TD align="justify" colspan="2">Pendahuluan</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">&nbsp;</TD>
							<TD valign="top" width="4%">1.1.</TD>
							<TD align="justify">Maksud dan tujuan penyusunan laporan keuangan SKPD</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">&nbsp;</TD>
							<TD valign="top" width="4%">1.2.</TD>
							<TD align="justify">Landasan hukum penyusunan laporan keuangan SKPD</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">&nbsp;</TD>
							<TD valign="top" width="4%">1.3.</TD>
							<TD align="justify">Sistematika penulisan catatan atas laporan keuangan SKPD</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">Bab II</TD>
							<TD align="justify" colspan="2">Ikhtisar pencapaian kinerja keuangan</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">&nbsp;</TD>
							<TD valign="top" width="4%">2.1.</TD>
							<TD align="justify">Ikhtisar realisasi pencapaian target kinerja keuangan</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">&nbsp;</TD>
							<TD valign="top" width="4%">2.2.</TD>
							<TD align="justify">Hambatan dan kendala yang ada dalam pencapaian target.</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">Bab III</TD>
							<TD align="justify" colspan="2">Penjelasan pos-pos laporan keuangan.</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">&nbsp;</TD>
							<TD valign="top" width="4%">3.1</TD>
							<TD align="justify">Rincian  dan  penjelasan  masing - masing  pos-pos pelaporan  keuangan.</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">&nbsp;</TD>
							<TD valign="top" width="4%">3.1.1.&nbsp;</TD>
							<TD align="justify">Laporan Realisasi Anggaran</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">&nbsp;</TD>
							<TD valign="top" width="4%">3.1.2.&nbsp;</TD>
							<TD align="justify">Laporan Operasional</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">&nbsp;</TD>
							<TD valign="top" width="4%">3.1.3.&nbsp;</TD>
							<TD align="justify">Neraca</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">&nbsp;</TD>
							<TD valign="top" width="4%">3.1.4.&nbsp;</TD>
							<TD align="justify">Laporan Perubahan Ekuitas</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">Bab IV</TD>
							<TD align="justify" colspan="2">Penjelasan atas informasi-informasi non keuangan.</TD>
						</TR>
						<TR>
							<TD width="2%">&nbsp;</TD>
							<TD valign="top" width="8%">Bab V</TD>
							<TD align="justify" colspan="2">Penutup.</TD>
						</TR>
						</TABLE></br>';

			$ctk=0;
			$data['prev']= 'BAB I PENDAHULUAN';
             switch ($ctk){
				case 0;
				echo ("<title>BAB I PENDAHULUAN</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
			}
		}
	
	function cetak_babiv($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
        $spasi = "line-height: 1.5em;";
		$thn_ang = $this->session->userdata('pcThang');
        $lcskpd = $kd_skpd;
        $skpd = $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        
		$lcttd = str_replace('a',' ',$ttd);
		
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$lcskpd'";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $prov     = $rowsc->provinsi;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$lcskpd' and kode IN ('PA','KPA') and nip='$lcttd'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
		
		if($jnsctk==1){
				$bg_color = 'bgcolor="Yellow"';
				$tombol_babiv = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_babiv\" methode=\"get\" target=\"blank\">
									<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
									<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
							     </form>";
			}else{
				$bg_color = "";
				$tombol_babiv = "";
				
			}	
			
			
			$cRet ='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center>
                    <TR>
						<TD align="center" ><b>BAB IV. PENJELASAN ATAS INFORMASI-INFORMASI NON KEUANGAN</TD>
					</TR>
					</TABLE><br/>';

			$cRet .='<TABLE style="border-collapse:collapse;'.$spasi.'" width="100%" border="0" cellspacing="0" cellpadding="0" align=center> 
						<TR>
							<TD align="justify" colspan="2">'.$skpd.' Provinsi Kalimantan Barat Tahun '.$thn_ang.' untuk Informasi Non Keuangan dapat dijelaskan sebagai berikut :</TD>
						</TR>
						<TR>
								<TD valign="top" colspan="2">&nbsp;</TD>
							</TR>';
			
			
			
			$sql="select b.kd_skpd, a.kd_rek, a.nm_rek, b.ket from penjelasan_calk a
									LEFT JOIN
									(select kd_skpd, kd_rek, ket from isi_penjelasan_calk where kd_skpd='$lcskpd') b
									on a.kd_rek=b.kd_rek";
			 $sql_2=$this->db->query($sql);
			 foreach ($sql_2->result() as $rowttd)
			{
				$kd_skpd=$rowttd->kd_skpd;                    
				$kd_rek= $rowttd->kd_rek;
				$ket  = $rowttd->ket;
				
				
			if($jnsctk==1){	
				if($ket==''){
					$text = "Penjelasan";
				}else{
					$text = $ket;
				}
			}else{
				if($ket==''){
					$text = " ";
				}else{
					$text = $ket;
				}
			}	
				switch ($kd_rek){
					case '4.1';
						$cRet .='<TR>
								<TD valign="top" width="2%">4.1</TD>
								<TD align="justify">Gambaran Umum</TD>
							</TR>
							<TR>
								<TD valign="top" width="2%">&nbsp;</TD>
								<TD align="justify" '.$bg_color.'>'.$text.'</TD>
							</TR>
							<TR>
								<TD valign="top" width="2%">&nbsp;</TD>
								<TD valign="top">&nbsp;</TD>
							</TR>';
					break;		
					case '4.2';
						$cRet .='<TR>
								<TD valign="top" width="2%">4.2</TD>
								<TD align="justify">Tugas Pokok dan Fungsi</TD>
							</TR>
							<TR>
								<TD valign="top" width="2%">&nbsp;</TD>
								<TD align="justify" '.$bg_color.'>'.$text.'</TD>
							</TR>
							<TR>
								<TD valign="top" width="2%">&nbsp;</TD>
								<TD valign="top">&nbsp;</TD>
							</TR>';
					break;
					case '4.3';
						$cRet .='<TR>
									<TD valign="top" width="2%">4.3</TD>
									<TD align="justify">Struktur Organisasi</TD>
								</TR>
								<TR>
									<TD valign="top" width="2%">&nbsp;</TD>
									<TD align="justify" '.$bg_color.'>'.$text.'</TD>
								</TR>
								<TR>
									<TD valign="top" width="2%">&nbsp;</TD>
									<TD valign="top">&nbsp;</TD>
								</TR>';
					break;
					case '4.4';
						$cRet .='<TR>
							<TD valign="top" width="2%">4.4</TD>
							<TD align="justify">Visi dan Misi</TD>
						</TR>
						<TR>
							<TD valign="top" width="2%">&nbsp;</TD>
							<TD align="justify" '.$bg_color.'>'.$text.'</TD>
						</TR>
						<TR>
							<TD valign="top" width="2%">&nbsp;</TD>
							<TD valign="top">&nbsp;</TD>
						</TR>';
					break;
				}
			}        
						
				$cRet .= "<tr>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_babiv
							</td>                         
						</tr>";

			$cRet.='<TABLE style="border-collapse:collapse" width="100%" border="0" cellspacing="0" cellpadding="1" align=center> 
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$daerah.', '.$this->tukd_model->tanggal_format_indonesia($dcetak).'</TD>
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$jabatan.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center">&nbsp;</TD>
						<TD width="50%" align="center">&nbsp;</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">'.$nama.'</TD> 
					</TR>					
					<TR>
						<TD width="50%" align="center"></TD>
						<TD width="50%" align="center">NIP: '.$nip.'</TD> 
					</TR>					
					</TABLE>
					';
						
			$cRet .='</TABLE>';
			$ctk=0;
			$data['prev']= 'BAB IV';
             switch ($ctk){
				case 0;
				echo ("<title>BAB IV</title>");
				echo $cRet;
				break;
				case 1;
				$this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
				break;
			}
		}
	
	function cetak_babIII_belanja($dcetak='',$ttd='',$kd_skpd='',$jnsctk='',$judul=''){
		$spasi = "line-height: 1.5em;";
		
		$thn     = $this->session->userdata('pcThang');
		$cbulan  = substr($dcetak,5,2);
		$cthnsbl = $thn-1;
		
		if($cbulan== 12){
		$sumber_data= "_at";
		$trdju = "trdju_calk";
        $trhju = "trhju_calk";
		}else{
		$sumber_data= "";
		$trdju = "trdju";
        $trhju = "trhju";
		}
		
		$sqlanggaran1="select case when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_ubah) then 2 
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan>=month(tgl_dpa_sempurna) and $cbulan<month(tgl_dpa_ubah) then 1
					   when statu=1 and status_sempurna=1 and status_ubah=1 and $cbulan<month(tgl_dpa_sempurna) then 0
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan>=month(tgl_dpa_sempurna) then 1 
					   when statu=1 and status_sempurna=1 and status_ubah=0 and $cbulan<month(tgl_dpa_sempurna) then 0
					   when statu=1 and status_sempurna=0 and status_ubah=0 and $cbulan>=month(tgl_dpa) then 0
					   else 1 end as anggaran from trhrka where kd_skpd='$kd_skpd'";
		
		$sqlanggaran=$this->db->query($sqlanggaran1);
		foreach ($sqlanggaran->result() as $rowttd)
			{
				$anggaran=$rowttd->anggaran;
			}
		
		$ang = $anggaran;
	
	
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd'";
        $sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$nmskpd = $rowsc->nm_skpd;
		} 
		$nm_skpd = strtoupper($nmskpd);	
	
		$lcttd = str_replace('a',' ',$ttd);
		$sqlsc ="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc){
			$kab     = $rowsc->kab_kota;
			$prov    = $rowsc->provinsi;
			$daerah  = $rowsc->daerah;
			$thn     = $rowsc->thn_ang;
		}
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd){
			$nip      =$rowttd->nip;                    
			$nama_ttd = $rowttd->nm;
			$jabatan  = $rowttd->jab;
		}
		
		$cRet = '';
		
		//mulai	
		if($judul=='2'){
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                        <td align=\"center\"><strong>BAB III  PENJELASAN POS-POS LAPORAN KEUANGAN</strong></td>                         
                    </tr>
				 </table><br>";

        $cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\"><strong>3.1</strong></td>                         
						 <td align=\"left\" colspan=\"2\"><strong>Rincian dan Penjelasan masing-masing pos-pos laporan Keuangan SKPD.</strong></td>                         
					</tr>
					<tr>
						 <td align=\"left\" width=\"2%\"><strong>&nbsp;</strong></td>                         
						 <td align=\"left\" width=\"4%\"><strong>3.1.1.</strong></td>                         
						 <td align=\"left\"><strong>Laporan Realisasi Anggaran</strong></td>                         
					</tr>
				  </table><br>";
		}
		
		$cRet .= "<table style=\"".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\" rowspan=\"2\"><strong>&nbsp;</strong></td>                         
						 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"center\" width=\"10%\" rowspan=\"2\"><strong>Reff</strong></td>                         
						 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"center\" width=\"30%\" rowspan=\"2\"><strong>Uraian</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"15%\"><strong>Anggaran $thn</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"15%\"><strong>Realisasi $thn</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"10%\"><strong>Lebih / (Kurang)</strong></td>   						  
						 <td style=\"border-top:solid;border-bottom:solid;\" align=\"center\" width=\"5%\" rowspan=\"2\"><strong>%</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"13%\"><strong>Realisasi $cthnsbl</strong></td>
					</tr>
					<tr>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>                                               
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>                                               
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
		$prv = $this->db->query("select case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
from 
(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
where a.kd_skpd='$kd_skpd'");
			$prvn = $prv->row();          
			$cek = $prvn->anggaran; 			
					
					
		//digit 1 dan 2
		if($cek==0){
				$sql_12 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
				select b.kd_skpd, LEFT(a.kd_rek5,1) kd_rek5, (select nm_rek1 from ms_rek1 where kd_rek1=LEFT(a.kd_rek5,1)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
				from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
				where left(a.kd_rek5,1)='5' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
				group by b.kd_skpd, LEFT(a.kd_rek5,1)
				) x
				UNION ALL
				SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
				select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, (select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(a.kd_rek5,2)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
				from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
				where left(a.kd_rek5,1)='5' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
				group by b.kd_skpd, LEFT(a.kd_rek5,2)
				) x order by kd_rek5";
			}else{
		$sql_12 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, y.real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,1) kd_rek5,(select nm_rek1 from ms_rek1 where kd_rek1=LEFT(kd_rek5,1)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn' 
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,1)='5'
					GROUP BY kd_skpd, LEFT(kd_rek5,1) ) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,1) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)='5' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,1)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
					 
					UNION ALL
					SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, y.real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,2) kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(kd_rek5,2)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn' 
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,1)='5'
					GROUP BY kd_skpd, LEFT(kd_rek5,2)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)='5' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,2)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
					order by x.kd_rek5";
			}
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$kd_skpd         = $rowsc->kd_skpd;
			$kd_rek5         = $rowsc->kd_rek5;
			$nm_rek5         = $rowsc->nm_rek5;
			$anggaran_bel    = $rowsc->anggaran;
			$realisasi_bel   = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang    = $realisasi_bel-$anggaran_bel;
			$banding         = $realisasi_bel - $realisasi_tlalu;
			$persen_bel      = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel    = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel   = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_bel = $banding*-1;
					$banding_bel = empty($ban_bel) || $ban_bel == 0 ? number_format(0,"2",",",".") :number_format($ban_bel,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			
			$per_pen  = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($realisasi_tlalu<$realisasi_bel){
				$naik_turun = "peningkatan";
				
			}else if($realisasi_bel==$realisasi_tlalu){
				$naik_turun = "tidak terjadi perubahan";
			}else{
				$naik_turun = "penurunan";
			} 
			
			if($panjang=='1'){
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$kd_rek5."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$ang_bel."</strong></td>
							 <td align=\"right\"><strong>".$real_bel."</strong></td>
							 <td align=\"right\"><strong>".$a."".$leb_kur."".$b."</strong></td>   						  
							 <td align=\"center\"><strong>".$per_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
						</tr>
						<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">Belanja pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran  ".$thn." memiliki anggaran belanja sebesar Rp.".$ang_bel." dan realisasi belanja sebesar Rp.".$real_bel.". Apabila dibandingkan dengan realisasi belanja Tahun Anggaran ".$cthnsbl." yang tercatat sebesar Rp. ".$real_tlalu." terjadi $naik_turun sebesar Rp. ".$c."".$banding_bel."".$d." dengan rincian penjelasan sebagai berikut :</td>                         
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			}else{
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td> 
							 <td align=\"right\">&nbsp;</td>
							 <td align=\"left\">".$this->dotrek($kd_rek5)." ".$nm_rek5."</td>
							 <td align=\"right\">".$ang_bel."</td>
							 <td align=\"right\">".$real_bel."</td>
							 <td align=\"right\">".$a."".$leb_kur."".$b."</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
						  </tr>";
			}
		}
		
		
		
		//REK 51
		if($cek==0){
			$sql_51 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
				select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, (select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(a.kd_rek5,2)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
				from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
				where left(a.kd_rek5,2)='51' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
				group by b.kd_skpd, LEFT(a.kd_rek5,2)
				) x
				UNION ALL
				SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
				select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, (select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(a.kd_rek5,3)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
				from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
				where left(a.kd_rek5,2)='51' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
				group by b.kd_skpd, LEFT(a.kd_rek5,3)
				) x
				order by x.kd_rek5";
		}else{
		$sql_51 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, y.real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,2) kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(kd_rek5,2)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd' 
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,2)='51'
					GROUP BY kd_skpd, LEFT(kd_rek5,2)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,2)='51' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,2)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5

					UNION ALL

					SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,2)='51'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,2)='51' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
					order by x.kd_rek5";
		}
		
		$sql_51_2=$this->db->query($sql_51);
		
		foreach ($sql_51_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$banding         = $realisasi_bel - $realisasi_tlalu;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_bel = $banding*-1;
					$banding_bel = empty($ban_bel) || $ban_bel == 0 ? number_format(0,"2",",",".") :number_format($ban_bel,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			$per_pen  = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($realisasi_bel<$realisasi_tlalu){
				$naik_turun = "penurunan";
				
			}else{
				$naik_turun = "kenaikan";
			}  
			
			if($panjang==2){
				$cRet .= "
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$ang_bel."</strong></td>
							 <td align=\"right\"><strong>".$real_bel."</strong></td>
							<td align=\"right\"><strong>$a".$leb_kur."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$per_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
						</tr>";
			}else{
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\">".$this->dotrek($kd_rek5)." ".$nm_rek5."</td>
							 <td align=\"right\">".$ang_bel."</td>
							 <td align=\"right\">".$real_bel."</td>
							<td align=\"right\">$a".$leb_kur."$b</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\">".$real_tlalu."</td>
						</tr>";
			}
		
		}	
		
		//511
		$sql_511="SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='511'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3)='511' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
					order by kd_rek5";
		$sql_511_2=$this->db->query($sql_511);
	
		foreach ($sql_511_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$banding         = $realisasi_bel - $realisasi_tlalu;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_bel = $banding*-1;
					$banding_bel = empty($ban_bel) || $ban_bel == 0 ? number_format(0,"2",",",".") :number_format($ban_bel,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}

			if($realisasi_bel<$realisasi_tlalu){
				$naik_turun = "penurunan";
				
			}else{
				$naik_turun = "kenaikan";
			}  
			
			$per_pen  = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			$cRet .= "
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
						 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
						 <td align=\"right\"><strong>".$ang_bel."</strong></td>
						 <td align=\"right\"><strong>".$real_bel."</strong></td>
						 <td align=\"right\"><strong>$a".$leb_kur."$b</strong></td>   						  
						 <td align=\"center\"><strong>".$per_pen."</strong></td>
						  <td align=\"right\"><strong>".$real_tlalu."</strong></td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." memiliki anggaran belanja sebesar Rp. ".$ang_bel." dan realisasi belanja sebesar Rp. ".$real_bel.". Apabila dibandingkan dengan realisasi belanja Tahun Anggaran ".$cthnsbl." yang tercatat sebesar Rp.".$real_tlalu." terjadi $naik_turun sebesar Rp. ".$banding_bel.". Rincian ".$nm_rek5." Tahun Anggaran ".$thn." sebagai berikut:</td>                         
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
		
		}
		
		//detail 511
		$sql_511_det="SELECT * from (
						Select kd_skpd,LEFT(kd_ang,3) kd_ang, LEFT(kd_rek5,3) kd_rek5,CASE WHEN LEFT(kd_ang,3)='511' THEN '1.' ELSE '2.' END nomor, CASE WHEN LEFT(kd_ang,3)='511' THEN 'Belanja Tidak Langsung' ELSE 'Belanja Langsung' END nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,3)='511'
						GROUP BY kd_skpd,LEFT(kd_ang,3),LEFT(kd_rek5,3)

						UNION ALL
						Select kd_skpd,LEFT(kd_ang,5) kd_ang, '' kd_rek5, '' nomor, (select '-'+' '+nm_rek4 from ms_rek4 where kd_rek4=LEFT(kd_ang,5)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,3)='511'
						GROUP BY kd_skpd,LEFT(kd_ang,5))x
						order by kd_ang";
			$sql_511_det_2=$this->db->query($sql_511_det);
	
		foreach ($sql_511_det_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$nomor          = $rowsc->nomor;
			$kd_ang         = $rowsc->kd_ang;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
			$per_pen  = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			$panjang = strlen($kd_rek5);
					
			$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">".$nomor."</td>                           
							 <td align=\"left\">".$nm_rek5."</td>
							 <td align=\"right\">".$ang_bel."</td>
							 <td align=\"right\">".$real_bel."</td>
							 <td align=\"right\">$a".$leb_kur."$b</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\"></td>
						</tr>";
		
		
		}
			$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
		
	
		//512
		$sql_512="SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='512'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3)='512' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
		$sql_512_2=$this->db->query($sql_512);
	
		foreach ($sql_512_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$banding         = $realisasi_bel - $realisasi_tlalu;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			$per_bel = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_bel = $banding*-1;
					$banding_bel = empty($ban_bel) || $ban_bel == 0 ? number_format(0,"2",",",".") :number_format($ban_bel,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}

			if($realisasi_bel<$realisasi_tlalu){
				$naik_turun = "penurunan";
				
			}else{
				$naik_turun = "kenaikan";
			}  
		
			$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
						 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
						 <td align=\"right\"><strong>".$ang_bel."</strong></td>
						 <td align=\"right\"><strong>".$real_bel."</strong></td>
						 <td align=\"right\"><strong>$a".$leb_kur."$b</strong></td>   						  
						 <td align=\"center\"><strong>".$per_bel."</strong></td>
						  <td align=\"right\"><strong>".$real_tlalu."</strong></td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." memiliki anggaran belanja sebesar Rp. ".$ang_bel." dan realisasi belanja sebesar Rp. ".$real_bel.". Apabila dibandingkan dengan realisasi belanja Tahun Anggaran ".$cthnsbl." yang tercatat sebesar Rp. ".$real_tlalu." terjadi $naik_turun sebesar Rp. ".$banding_bel.". Rincian ".$nm_rek5." Tahun Anggaran ".$thn." sebagai berikut:</td>                         
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
		
		}
		
		//detail 512
		$sql_512_det="SELECT * from (
						Select kd_skpd,LEFT(kd_ang,5) kd_ang, '' kd_rek5,(select nm_rek4 from ms_rek4 where kd_rek4=LEFT(kd_ang,5)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,3)='512'
						GROUP BY kd_skpd,LEFT(kd_ang,5) )x
						order by kd_ang";
			$sql_512_det_2=$this->db->query($sql_512_det);
		$no=1;
		foreach ($sql_512_det_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_ang         = $rowsc->kd_ang;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			$per_pen  = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($lebih_kurang<0){
				$naik_turun = "penurunan";
			}else{
				$naik_turun = "kenaikan";
			} 
		
			$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">".$no++.".</td>                         
							 <td align=\"left\">".$nm_rek5."</td>
							 <td align=\"right\">".$ang_bel."</td>
							 <td align=\"right\">".$real_bel."</td>
							 <td align=\"right\">$a".$leb_kur."$b</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\"></td>
						</tr>";
		
		
		}
		
		$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
//baru_galih

		//513
		$sql_513="SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='513'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3)='513' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
		$sql_513_2=$this->db->query($sql_513);
	
		foreach ($sql_513_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$banding         = $realisasi_bel - $realisasi_tlalu;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			$per_bel = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_bel = $banding*-1;
					$banding_bel = empty($ban_bel) || $ban_bel == 0 ? number_format(0,"2",",",".") :number_format($ban_bel,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}

			if($realisasi_bel<$realisasi_tlalu){
				$naik_turun = "penurunan";
				
			}else{
				$naik_turun = "kenaikan";
			}  
		
			$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
						 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
						 <td align=\"right\"><strong>".$ang_bel."</strong></td>
						 <td align=\"right\"><strong>".$real_bel."</strong></td>
						 <td align=\"right\"><strong>$a".$leb_kur."$b</strong></td>   						  
						 <td align=\"center\"><strong>".$per_bel."</strong></td>
						  <td align=\"right\"><strong>".$real_tlalu."</strong></td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." memiliki anggaran belanja sebesar Rp. ".$ang_bel." dan realisasi belanja sebesar Rp. ".$real_bel.". Apabila dibandingkan dengan realisasi belanja Tahun Anggaran ".$cthnsbl." yang tercatat sebesar Rp. ".$real_tlalu." terjadi $naik_turun sebesar Rp. ".$banding_bel.".</td>                         
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
		
		}	

		//514
		$sql_514="SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='514'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3)='514' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
		$sql_514_2=$this->db->query($sql_514);
	
		foreach ($sql_514_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$banding         = $realisasi_bel - $realisasi_tlalu;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			$per_bel = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_bel = $banding*-1;
					$banding_bel = empty($ban_bel) || $ban_bel == 0 ? number_format(0,"2",",",".") :number_format($ban_bel,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}

			if($realisasi_bel<$realisasi_tlalu){
				$naik_turun = "penurunan";
				
			}else{
				$naik_turun = "kenaikan";
			}  
		
			$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
						 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
						 <td align=\"right\"><strong>".$ang_bel."</strong></td>
						 <td align=\"right\"><strong>".$real_bel."</strong></td>
						 <td align=\"right\"><strong>$a".$leb_kur."$b</strong></td>   						  
						 <td align=\"center\"><strong>".$per_bel."</strong></td>
						  <td align=\"right\"><strong>".$real_tlalu."</strong></td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." memiliki anggaran belanja sebesar Rp. ".$ang_bel." dan realisasi belanja sebesar Rp. ".$real_bel.". Apabila dibandingkan dengan realisasi belanja Tahun Anggaran ".$cthnsbl." yang tercatat sebesar Rp. ".$real_tlalu." terjadi $naik_turun sebesar Rp. ".$banding_bel.".</td>                         
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
		
		}
		
		//515
		$sql_515="SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='515'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3)='515' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
		$sql_515_2=$this->db->query($sql_515);
	
		foreach ($sql_515_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$banding         = $realisasi_bel - $realisasi_tlalu;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			$per_bel = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_bel = $banding*-1;
					$banding_bel = empty($ban_bel) || $ban_bel == 0 ? number_format(0,"2",",",".") :number_format($ban_bel,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}

			if($realisasi_bel<$realisasi_tlalu){
				$naik_turun = "penurunan";
				
			}else{
				$naik_turun = "kenaikan";
			}  
		
			$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
						 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
						 <td align=\"right\"><strong>".$ang_bel."</strong></td>
						 <td align=\"right\"><strong>".$real_bel."</strong></td>
						 <td align=\"right\"><strong>$a".$leb_kur."$b</strong></td>   						  
						 <td align=\"center\"><strong>".$per_bel."</strong></td>
						  <td align=\"right\"><strong>".$real_tlalu."</strong></td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." memiliki anggaran belanja sebesar Rp. ".$ang_bel." dan realisasi belanja sebesar Rp. ".$real_bel.". Apabila dibandingkan dengan realisasi belanja Tahun Anggaran ".$cthnsbl." yang tercatat sebesar Rp. ".$real_tlalu." terjadi $naik_turun sebesar Rp. ".$banding_bel.". Rincian ".$nm_rek5." Tahun Anggaran ".$thn." sebagai berikut:</td>                         
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
		
		}
		
		//detail 515
		$sql_515_det="SELECT * from (
						Select kd_skpd,LEFT(kd_ang,5) kd_ang, '' kd_rek5,(select nm_rek4 from ms_rek4 where kd_rek4=LEFT(kd_ang,5)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,3)='515'
						GROUP BY kd_skpd,LEFT(kd_ang,5) )x
						order by kd_ang";
			$sql_515_det_2=$this->db->query($sql_515_det);
		$no=1;
		foreach ($sql_515_det_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_ang         = $rowsc->kd_ang;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			$per_pen  = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($lebih_kurang<0){
				$naik_turun = "penurunan";
			}else{
				$naik_turun = "kenaikan";
			} 
		
			$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">".$no++.".</td>                         
							 <td align=\"left\">".$nm_rek5."</td>
							 <td align=\"right\">".$ang_bel."</td>
							 <td align=\"right\">".$real_bel."</td>
							 <td align=\"right\">$a".$leb_kur."$b</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\"></td>
						</tr>";
		
		
		}
		
		$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";		
					
		
		//516
		$sql_516="SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,3)='516'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,3)='516' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
		$sql_516_2=$this->db->query($sql_516);
	
		foreach ($sql_516_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$banding         = $realisasi_bel - $realisasi_tlalu;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			$per_bel = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_bel = $banding*-1;
					$banding_bel = empty($ban_bel) || $ban_bel == 0 ? number_format(0,"2",",",".") :number_format($ban_bel,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				}

			if($realisasi_bel<$realisasi_tlalu){
				$naik_turun = "penurunan";
				
			}else{
				$naik_turun = "kenaikan";
			}  
		
			$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
						 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
						 <td align=\"right\"><strong>".$ang_bel."</strong></td>
						 <td align=\"right\"><strong>".$real_bel."</strong></td>
						 <td align=\"right\"><strong>$a".$leb_kur."$b</strong></td>   						  
						 <td align=\"center\"><strong>".$per_bel."</strong></td>
						  <td align=\"right\"><strong>".$real_tlalu."</strong></td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." memiliki anggaran belanja sebesar Rp. ".$ang_bel." dan realisasi belanja sebesar Rp. ".$real_bel.". Apabila dibandingkan dengan realisasi belanja Tahun Anggaran ".$cthnsbl." yang tercatat sebesar Rp. ".$real_tlalu." terjadi $naik_turun sebesar Rp. ".$banding_bel.". Rincian ".$nm_rek5." Tahun Anggaran ".$thn." sebagai berikut:</td>                         
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
		
		}
		
		//detail 516
		$sql_516_det="SELECT * from (
						Select kd_skpd,LEFT(kd_ang,5) kd_ang, '' kd_rek5,(select nm_rek4 from ms_rek4 where kd_rek4=LEFT(kd_ang,5)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
						FROM (
						select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
						(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
						case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
						from 
						(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
						a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
						where a.kd_skpd='$kd_skpd'
						group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
						LEFT JOIN
						(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
						from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
						where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
						group by kd_skpd, a.kd_rek5, a.map_real)
						b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
						WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,3)='516'
						GROUP BY kd_skpd,LEFT(kd_ang,5) )x
						order by kd_ang";
			$sql_516_det_2=$this->db->query($sql_516_det);
		$no=1;
		foreach ($sql_516_det_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_ang         = $rowsc->kd_ang;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			$per_pen  = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($lebih_kurang<0){
				$naik_turun = "penurunan";
			}else{
				$naik_turun = "kenaikan";
			} 
		
			$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">".$no++.".</td>                         
							 <td align=\"left\">".$nm_rek5."</td>
							 <td align=\"right\">".$ang_bel."</td>
							 <td align=\"right\">".$real_bel."</td>
							 <td align=\"right\">$a".$leb_kur."$b</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\"></td>
						</tr>";
		
		
		}
		
		$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";	
		//REK 52
		
		if($cek==0){
			$sql_52 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
				select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, (select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(a.kd_rek5,2)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
				from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
				where left(a.kd_rek5,2)='52' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
				group by b.kd_skpd, LEFT(a.kd_rek5,2)
				) x
				UNION ALL
				SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, x.real_tlalu FROM (
				select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, (select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(a.kd_rek5,3)) nm_rek5, 0 anggaran, 0 realisasi, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
				from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
				where left(a.kd_rek5,2)='52' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
				group by b.kd_skpd, LEFT(a.kd_rek5,3)
				) x";
		}else{
		
		$sql_52 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, y.real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,2) kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(kd_rek5,2)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn'
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,2)='52'
					GROUP BY kd_skpd, LEFT(kd_rek5,2)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,2) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,2)='52' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,2)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5

					UNION ALL

					SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, x.anggaran, x.realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
					Select kd_skpd, LEFT(kd_rek5,3) kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(kd_rek5,3)) nm_rek5, sum(anggaran) anggaran, sum(real_spj) realisasi
					FROM (
					select a.kd_skpd, a.kd_rek5 kd_ang, a.kd_rek64 kd_rek5, a.anggaran, isnull(b.real_spj,0) as real_spj from
					(select a.kd_skpd, a.kd_rek5, b.kd_rek64,
					case when ($ang=0) then sum(a.nilai) when ($ang=1) then sum(a.nilai_sempurna) else sum(a.nilai_ubah) end as anggaran
					from 
					(select kd_skpd, kd_rek5, kd_kegiatan, nilai, nilai_sempurna, nilai_ubah from trdrka where left(kd_rek5,1)<>4)
					a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5
					where a.kd_skpd='$kd_skpd'
					group by a.kd_skpd, a.kd_rek5, b.kd_rek64) a
					LEFT JOIN
					(select b.kd_skpd, a.kd_rek5, a.map_real, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_spj 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,1)=5 and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$thn' 
					group by kd_skpd, a.kd_rek5, a.map_real)
					b on a.kd_skpd=b.kd_skpd and a.kd_rek5=b.map_real and a.kd_rek64=b.kd_rek5 ) z
					WHERE kd_skpd='$kd_skpd' and LEFT(kd_rek5,2)='52'
					GROUP BY kd_skpd, LEFT(kd_rek5,3)) x
					LEFT JOIN
					(select b.kd_skpd, LEFT(a.kd_rek5,3) kd_rek5, sum(isnull(a.debet,0)-isnull(a.kredit,0)) as real_tlalu 
					from $trdju a inner join $trhju b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where left(a.kd_rek5,2)='52' and a.kd_unit='$kd_skpd' and YEAR(b.tgl_voucher)='$cthnsbl'
					group by b.kd_skpd, LEFT(a.kd_rek5,3)) y
					on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
					order by x.kd_rek5";
		}
		$sql_52_2=$this->db->query($sql_52);
		
		foreach ($sql_52_2->result() as $rowsc){
			$kd_skpd        = $rowsc->kd_skpd;
			$kd_rek5        = $rowsc->kd_rek5;
			$nm_rek5        = $rowsc->nm_rek5;
			$anggaran_bel   = $rowsc->anggaran;
			$realisasi_bel  = $rowsc->realisasi;
			$realisasi_tlalu = $rowsc->real_tlalu;
			$lebih_kurang   = $realisasi_bel-$anggaran_bel;
			$banding         = $realisasi_bel - $realisasi_tlalu;
			$persen_bel     = ($anggaran_bel!=0)?($realisasi_bel / $anggaran_bel ) * 100:0; 
			
			$ang_bel  = empty($anggaran_bel) || $anggaran_bel == 0 ? number_format(0,"2",",",".") :number_format($anggaran_bel,"2",",",".");
			$real_bel = empty($realisasi_bel) || $realisasi_bel == 0 ? number_format(0,"2",",",".") :number_format($realisasi_bel,"2",",",".");
			$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
			
			if($banding<0){
					$c = "(";
					$d = ")";
					$ban_bel = $banding*-1;
					$banding_bel = empty($ban_bel) || $ban_bel == 0 ? number_format(0,"2",",",".") :number_format($ban_bel,"2",",",".");
				}else{
					$c = "";
					$d = "";
					$banding_bel = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
			
			if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$leb_kur  = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$leb_kur  = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
			
			$per_pen  = empty($persen_bel) || $persen_bel == 0 ? number_format(0,"2",",",".") :number_format($persen_bel,"2",",",".");
			
			$panjang = strlen($kd_rek5);
			
			if($realisasi_bel<$realisasi_tlalu){
				$naik_turun = "penurunan";
				
			}else{
				$naik_turun = "kenaikan";
			}  
			
			if($panjang==2){
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$ang_bel."</strong></td>
							 <td align=\"right\"><strong>".$real_bel."</strong></td>
							 <td align=\"right\"><strong>$a".$leb_kur."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$per_pen."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
						</tr>
						<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"left\"><strong>&nbsp;</strong></td>
						 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." memiliki anggaran belanja sebesar Rp. ".$ang_bel." dan realisasi belanja sebesar Rp. ".$real_bel.". Apabila dibandingkan dengan realisasi Tahun Anggaran ".$cthnsbl." yang tercatat sebesar Rp. ".$real_tlalu." terjadi $naik_turun sebesar Rp. ".$banding_bel.". Rincian ".$nm_rek5." Tahun Anggaran ".$thn." sebagai berikut:</td>                         
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
			}else{
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\">".$this->dotrek($kd_rek5)." ".$nm_rek5."</td>
							 <td align=\"right\">".$ang_bel."</td>
							 <td align=\"right\">".$real_bel."</td>
							 <td align=\"right\">$a".$leb_kur."$b</td>   						  
							 <td align=\"center\">".$per_pen."</td>
							 <td align=\"right\"></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>                         
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong>&nbsp;</strong></td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
							 <td align=\"center\"><strong></strong>&nbsp;</td>
							 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			}
		
		}	
		
		$cRet .= "</table><br>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("BAB III $kd_skpd /");
        $this->template->set('title', 'BAB III $kd_skpd / $cbulan');        
        
		$pilih=1;
		switch($pilih) {       
        case 1;
			echo ("<title>BAB III</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }
	
	function cetak_babIII_lo($dcetak='',$ttd='',$kd_skpd='',$jnsctk='',$judul=''){
		$spasi = "line-height: 1.5em;";
		$thn     = $this->session->userdata('pcThang');
		$cbulan  = substr($dcetak,5,2);
		$cthnsbl = $thn-1;
	
		if($cbulan== 12){
		$sumber_data= "_at";
		$trdju = "trdju_calk";
        $trhju = "trhju_calk";
		}else{
		$sumber_data= "";
		$trdju = "trdju";
        $trhju = "trhju";
		}
	
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd'";
        $sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$nmskpd = $rowsc->nm_skpd;
		} 
		$nm_skpd = strtoupper($nmskpd);	
	
		$lcttd = str_replace('a',' ',$ttd);
		$sqlsc ="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc){
			$kab     = $rowsc->kab_kota;
			$prov    = $rowsc->provinsi;
			$daerah  = $rowsc->daerah;
			$thn     = $rowsc->thn_ang;
		}
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd){
			$nip      =$rowttd->nip;                    
			$nama_ttd = $rowttd->nm;
			$jabatan  = $rowttd->jab;
		}
		
		if($jnsctk==1){
			$bg_color = "bgcolor=\"yellow\"";
			$tombol_811 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lo_811\" methode=\"get\" target=\"blank\">
							<!--<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">-->
					   </form>";
			$tombol_812 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lo_812\" methode=\"get\" target=\"blank\">
							<!--<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">-->
					   </form>";
			$tombol_813 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lo_813\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_814 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lo_814\" methode=\"get\" target=\"blank\">
							<!--<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">-->
					   </form>";
		}else{
			$bg_color = "";
			$tombol_811 = "";
			$tombol_812 = "";
			$tombol_813 = "";
			$tombol_814 = "";
		}
		
		$cRet = '';
		
		//mulai
		if($judul=='2'){
				$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                        <td align=\"center\"><strong>BAB III  PENJELASAN POS-POS LAPORAN KEUANGAN</strong></td>                         
                    </tr>
				 </table><br>";
				
				$cRet .= "<table width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\"><strong>3.1</strong></td>                         
						 <td align=\"left\" colspan=\"2\"><strong>Rincian dan Penjelasan masing-masing pos-pos laporan Keuangan SKPD.</strong></td>                         
					</tr></table>";
		}
		 		
				$cRet .= "<table width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
							<tr>
								 <td align=\"left\" width=\"2%\"><strong>&nbsp;</strong></td>                         
								 <td align=\"left\" width=\"4%\"><strong>3.1.2.</strong></td>                         
								 <td align=\"left\"><strong>Laporan Operasional</strong></td>                         
							</tr>
						  </table><br>";
		
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\" rowspan=\"2\"><strong>&nbsp;</strong></td>                         
						 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"center\" width=\"10%\" rowspan=\"2\"><strong>Reff</strong></td>                         
						 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"center\" width=\"30%\" rowspan=\"2\"><strong>Uraian</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"15%\"><strong>Realisasi - LO $thn</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"15%\"><strong>Realisasi - LO $cthnsbl</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"10%\"><strong>Kenaikan / (Penurunan)</strong></td>   						  
						 <td style=\"border-top:solid;border-bottom:solid;\" align=\"center\" width=\"5%\" rowspan=\"2\"><strong>%</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"13%\"><strong>Realisasi - LRA $thn</strong></td>
					</tr>
					<tr>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>                                               
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>                                               
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
			
			
			$prv = $this->db->query("select ISNULL(sum(b.kredit-b.debet),0) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
			where LEFT(b.kd_rek5,1) IN ('8') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
			");
			$prvn = $prv->row();          
			$cek = $prvn->realisasi; 
			
			//lo
			if($cek==0){
			$sql_lo_8 = "select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,1) as kd_rek5,(select nm_rek1 from ms_rek1_64 where kd_rek1=LEFT(b.kd_rek5,1)) as nm_rek5, 0 as realisasi,  sum(b.kredit-b.debet) real_tlalu, 0 as real_lra 
			from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
			where LEFT(b.kd_rek5,1) IN ('8') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
			group by b.kd_unit, LEFT(b.kd_rek5,1)
			UNION ALL
			select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(b.kd_rek5,2)) as nm_rek5, 0 as realisasi,  sum(b.kredit-b.debet) real_tlalu, 0 as real_lra 
			from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
			where LEFT(b.kd_rek5,1) IN ('8') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
			group by b.kd_unit, LEFT(b.kd_rek5,2)
			order by kd_rek5";
			}else{
		/*	
			$sql_lo_8 = "select x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu, ISNULL(z.real_lra,0) real_lra  from (
							select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,1),'8','4') as kd_lra, LEFT(b.kd_rek5,1) as kd_rek5,(select nm_rek1 from ms_rek1_64 where kd_rek1=LEFT(b.kd_rek5,1)) as nm_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,1) IN ('8') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,1)
							UNION ALL
							select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,2),'8','4') as kd_lra, LEFT(b.kd_rek5,2) as kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(b.kd_rek5,2)) as nm_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,1) IN ('8') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,2) ) x

							LEFT JOIN 
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,1) as kd_rek5,(select nm_rek1 from ms_rek1_64 where kd_rek1=LEFT(b.kd_rek5,1)) as nm_rek5, sum(b.kredit-b.debet) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,1) IN ('8') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,1)
							UNION ALL
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(b.kd_rek5,2)) as nm_rek5, sum(b.kredit-b.debet) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,1) IN ('8') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,2) ) y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5

							INNER JOIN
							(select x.kd_skpd, '4' as kd_lra, '8' kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
							FROM(
								select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,2),'8','4') as kd_lra, LEFT(b.kd_rek5,2) as kd_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where LEFT(b.kd_rek5,1) IN ('8') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit, LEFT(b.kd_rek5,2)) x
								INNER JOIN				
								(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5, sum(b.kredit-b.debet) real_lra from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where LEFT(b.kd_rek5,1) IN ('4') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit, LEFT(b.kd_rek5,2)) y
								on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
								group by x.kd_skpd, x.kd_rek5
							UNION ALL
							select x.kd_skpd, x.kd_lra, x.kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
							FROM(
								select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,2),'8','4') as kd_lra, LEFT(b.kd_rek5,2) as kd_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where LEFT(b.kd_rek5,1) IN ('8') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit, LEFT(b.kd_rek5,2)) x
								INNER JOIN				
								(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5, sum(b.kredit-b.debet) real_lra from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where LEFT(b.kd_rek5,1) IN ('4') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit, LEFT(b.kd_rek5,2)) y
								on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
								group by x.kd_skpd,x.kd_lra, x.kd_rek5) z
							on x.kd_skpd=z.kd_skpd and x.kd_rek5=z.kd_rek5
							order by kd_rek5";
			*/
			$sql_lo_8 = "select * from (
						select x.kd_skpd,'8' kd_rek5,'PENDAPATAN - LO' nm_rek5,sum(x.real_ini) realisasi,sum(x.real_lalu) real_tlalu,sum(x.real_lra) real_lra  from (
						select a.kd_skpd,case when left(b.kd_rek5,1)='8' then left(b.kd_rek5,2) end kod,case when left(b.kd_rek5,1)='8' then 
						replace(left(b.kd_rek5,2),'8','4') end kd_lra,
						sum(case when left(b.kd_rek5,1)='8' and year(a.tgl_voucher)='$thn' then b.kredit-b.debet else 0 end) real_ini,
						sum(case when left(b.kd_rek5,1)='8' and year(a.tgl_voucher)='$cthnsbl' then b.kredit-b.debet else 0 end) real_lalu,
						0 real_lra
						from $trhju a inner join $trdju b
						on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where left(b.kd_rek5,1) in ('8') and a.kd_skpd='$kd_skpd'
						group by a.kd_skpd,left(b.kd_rek5,2),left(b.kd_rek5,1)
						union all
						select a.kd_skpd,case when left(b.kd_rek5,1)='4' then replace(left(b.kd_rek5,2),'4','8') end kod,left(b.kd_rek5,2) kd_lra,
						0 real_ini,
						0 real_lalu,
						sum(case when left(b.kd_rek5,1)='4' and year(a.tgl_voucher)='$thn' then b.kredit-b.debet else 0 end) real_lra
						from $trhju a inner join $trdju b
						on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where left(b.kd_rek5,1) in ('4') and a.kd_skpd='$kd_skpd'
						group by a.kd_skpd,left(b.kd_rek5,2),left(b.kd_rek5,1)
						) x
						group by x.kd_skpd
						union all
						select x.kd_skpd,x.kod kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=x.kod group by nm_rek2) nm_rek5,sum(x.real_ini) realisasi,sum(x.real_lalu) real_tlalu,sum(x.real_lra) real_lra  from (
						select a.kd_skpd,case when left(b.kd_rek5,1)='8' then left(b.kd_rek5,2) end kod,case when left(b.kd_rek5,1)='8' then 
						replace(left(b.kd_rek5,2),'8','4') end kd_lra,
						sum(case when left(b.kd_rek5,1)='8' and year(a.tgl_voucher)='$thn' then b.kredit-b.debet else 0 end) real_ini,
						sum(case when left(b.kd_rek5,1)='8' and year(a.tgl_voucher)='$cthnsbl' then b.kredit-b.debet else 0 end) real_lalu,
						0 real_lra
						from $trhju a inner join $trdju b
						on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where left(b.kd_rek5,1) in ('8') and a.kd_skpd='$kd_skpd'
						group by a.kd_skpd,left(b.kd_rek5,2),left(b.kd_rek5,1)
						union all
						select a.kd_skpd,case when left(b.kd_rek5,1)='4' then replace(left(b.kd_rek5,2),'4','8') end kod,left(b.kd_rek5,2) kd_lra,
						0 real_ini,
						0 real_lalu,
						sum(case when left(b.kd_rek5,1)='4' and year(a.tgl_voucher)='$thn' then b.kredit-b.debet else 0 end) real_lra
						from $trhju a inner join $trdju b
						on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where left(b.kd_rek5,1) in ('4') and a.kd_skpd='$kd_skpd'
						group by a.kd_skpd,left(b.kd_rek5,2),left(b.kd_rek5,1)
						) x
						group by x.kd_skpd,x.kod
						) q
						where q.realisasi<>'0' and q.real_tlalu<>'0' and q.real_lra<>'0'
						order by q.kd_rek5
						";
			
			}
			
			$sql_lo_82=$this->db->query($sql_lo_8);
		
			foreach ($sql_lo_82->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? '' :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				if($panjang=='1'){
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$kd_rek5."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_lra."</strong></td>
						</tr>
						";
				}else{
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td> 
								 <td align=\"right\">&nbsp;</td>
								 <td align=\"left\">".$this->dotrek($kd_rek5)." ".$nm_rek5."</td>
								<td align=\"right\">".$real_lo."</td>
								 <td align=\"right\">".$real_tlalu."</td>
								 <td align=\"right\">$a".$lebih_kurang_lo."$b</td>   						  
								 <td align=\"center\">".$persen_lo."</td>
								 <td align=\"right\">".$real_lra."</td>
								 </tr>";
				}
			
			}
		
			
		
		//(81)
		if($cek==0){
			$sql_lo_81 = "select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(b.kd_rek5,2)) as nm_rek5, 0 as realisasi,  sum(b.kredit-b.debet) real_tlalu, 0 as real_lra 
			from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
			where LEFT(b.kd_rek5,2) IN ('81') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
			group by b.kd_unit, LEFT(b.kd_rek5,2)
			UNION ALL
			select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, 0 as realisasi,  sum(b.kredit-b.debet) real_tlalu, 0 as real_lra 
			from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
			where LEFT(b.kd_rek5,2) IN ('81') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
			group by b.kd_unit, LEFT(b.kd_rek5,3)
			order by kd_rek5";
			}else{
			$sql_lo_81 = "SELECT x.kd_skpd,x.kd_rek5,x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu, ISNULL(z.real_lra,0) real_lra FROM (
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(b.kd_rek5,2)) as nm_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,2) IN ('81') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,2)
							UNION ALL
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,2) IN ('81') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,3)) x

							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(b.kd_rek5,2)) as nm_rek5, sum(b.kredit-b.debet) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,2) IN ('81') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,2)
							UNION ALL
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,2) IN ('81') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,3))y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
							
							INNER JOIN
							(select x.kd_skpd, x.kd_lra, x.kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
							FROM(
								select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,2),'8','4') as kd_lra, LEFT(b.kd_rek5,2) as kd_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where LEFT(b.kd_rek5,2) IN ('81') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit, LEFT(b.kd_rek5,2)) x
								INNER JOIN				
								(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5, sum(b.kredit-b.debet) real_lra from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where LEFT(b.kd_rek5,2) IN ('41') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit, LEFT(b.kd_rek5,2)) y
								on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
								group by x.kd_skpd,x.kd_lra, x.kd_rek5
							UNION ALL	
							select x.kd_skpd, x.kd_lra, x.kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
							FROM(
								select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,3),'8','4') as kd_lra, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where LEFT(b.kd_rek5,2) IN ('81') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit, LEFT(b.kd_rek5,3)) x
								INNER JOIN				
								(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) real_lra from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where LEFT(b.kd_rek5,2) IN ('41') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit, LEFT(b.kd_rek5,3)) y
								on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
								group by x.kd_skpd,x.kd_lra, x.kd_rek5) z
								on x.kd_skpd=z.kd_skpd and x.kd_rek5=z.kd_rek5
								order by kd_rek5";
			}
			$sql_lo_812=$this->db->query($sql_lo_81);
		
			foreach ($sql_lo_812->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? '' :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				if($panjang=='2'){
				$cRet .= "
						<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_lra."</strong></td>
						</tr>";
				}else{
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td> 
								 <td align=\"right\">&nbsp;</td>
								 <td align=\"left\">".$this->dotrek($kd_rek5)." ".$nm_rek5."</td>
								 <td align=\"right\">".$real_lo."</td>
								 <td align=\"right\">".$real_tlalu."</td>
								 <td align=\"right\">$a".$lebih_kurang_lo."$b</td>   						  
								 <td align=\"center\">".$persen_lo."</td>
								 <td align=\"right\">".$real_lra."</td>
							  </tr>";
				}
			
			}
		$cRet .= "
						<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";	
			
		//(811)
		if($cek==0){
			$sql_lo_811 = "select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, 0 as realisasi,  sum(b.kredit-b.debet) real_tlalu, 0 as real_lra 
			from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
			where LEFT(b.kd_rek5,3) IN ('811') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
			group by b.kd_unit, LEFT(b.kd_rek5,3)
			order by kd_rek5";
			}else{
			$sql_lo_811 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu, ISNULL(z.real_lra,0) real_lra FROM(
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('811') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,3))x
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('811') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,3))y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
							INNER JOIN
							(select x.kd_skpd, x.kd_lra, x.kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
								FROM(
									select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,3),'8','4') as kd_lra, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('811') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) x
									INNER JOIN				
									(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) real_lra from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('411') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) y
									on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
									group by x.kd_skpd,x.kd_lra, x.kd_rek5) z
							on x.kd_skpd=z.kd_skpd and x.kd_rek5=z.kd_rek5
							order by kd_rek5";
			}
			$sql_lo_8112=$this->db->query($sql_lo_811);
		
			foreach ($sql_lo_8112->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");				
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				
				$banding = $realisasi_lo-$reallra;
				if($banding<0){
					$m = "(";
					$n = ")";
					$hitung_banding = $banding*-1;
					$lebih_kurang_banding = empty($hitung_banding) || $hitung_banding == 0 ? number_format(0,"2",",",".") :number_format($hitung_banding,"2",",",".");
				}else{
					$m = "";
					$n = "";
					$lebih_kurang_banding = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
				
				
				if($realisasi_tlalu<$realisasi_lo){
					$naik_turun = "terjadi peningkatan";
				}else if($realisasi_tlalu==$realisasi_lo){
					$naik_turun = "tidak terjadi perubahan";
				}else{
					$naik_turun = "terjadi penurunan";
				}
				
				if($realisasi_lo!=$reallra){
					$selisih = "perbedaan";
				}else{
					$selisih = "persamaan";
				}
				
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_lra."</strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." sebesar Rp. ".$real_lo." dan realisasi ".$nm_rek5." Tahun Anggaran ".$cthnsbl." sebesar Rp. ".$real_tlalu." terjadi ".$naik_turun." sebesar Rp. ".$lebih_kurang_lo." atau ".$persen_lo."%. Jika ".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp. ".$real_lo." dibandingkan dengan realisasi ".$nm_rek5." - LRA sebesar Rp. ".$real_lra." $selisih sebesar Rp. ".$m."".$lebih_kurang_banding."".$n.", dapat dijelaskan sebagai berikut :</td>                         
						 </tr>";
						 
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td valign=\"top\" align=\"right\">-</td>                         
							 <td align=\"left\">Pendapatan Pajak Daerah - LRA $thn</td>
							 <td align=\"right\">".$real_lra."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>";
						
				$total = 0;		
				$sql_det = "select z.no,z.kd_rek,z.nm_rek,sum(isnull(q.nilai_x,0)) nilai from ( 
							select '$cthnsbl' thn,'11301' kd_rek,isnull(sum(d.debet-d.kredit),0)*-1 nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,5)='11301' and year(c.tgl_voucher)<='$cthnsbl'
							union all
							select '$thn' thn,'11301' kd_rek,isnull(sum(d.debet-d.kredit),0) nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,5)='11301' and year(c.tgl_voucher)<='$thn'
							) q 
							inner join 
							(select no,kd_rek,nm_rek,kd_neraca,thn from ket_lo_calk where left(kd_rek,3)='811')
							z
							on q.thn=z.thn and z.kd_neraca=q.kd_rek
							group by z.no,z.kd_rek,z.nm_rek
							order by z.kd_rek";
				$sql_det_2=$this->db->query($sql_det);
		
				foreach ($sql_det_2->result() as $rowsc){
					$no        = $rowsc->no;
					$kd_rek        = $rowsc->kd_rek;
					$nm_rek        = $rowsc->nm_rek;
					$nilai         = $rowsc->nilai;
					
					$total		   = $total+$nilai;
					$nilai_lo = empty($nilai) || $nilai == 0 ? number_format(0,"2",",",".") :number_format($nilai,"2",",",".");
					
					
					
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"right\">".$no."</td>                         
							 <td align=\"left\" $bg_color>".$nm_rek."</td>
							 <td align=\"right\" $bg_color>".$nilai_lo."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>
						";
				
				}
/*				
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td valign=\"top\" align=\"right\">-</td>                         
							 <td align=\"left\">".$nm_rek5." $thn</td>
							 <td align=\"right\">".$real_lo."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>
						";
*/
				$nilai_plus=$reallra+$total;
					
				$nilai_plus_lo = empty($nilai_plus) || $nilai_plus == 0 ? number_format(0,"2",",",".") :number_format($nilai_plus,"2",",",".");
					
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td align=\"top\" align=\"right\">-</td>                         
							 <td align=\"left\">".$nm_rek5." $thn</td>
							 <td align=\"right\">".$nilai_plus_lo."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>
						";	
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_811
							</td>                         
						</tr>";
			
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			
			}	
			
			
		//(812)
		if($cek==0){
			$sql_lo_812 = "select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, 0 as realisasi,  sum(b.kredit-b.debet) real_tlalu, 0 as real_lra 
			from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
			where LEFT(b.kd_rek5,3) IN ('812') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
			group by b.kd_unit, LEFT(b.kd_rek5,3)
			order by kd_rek5";
			}else{
			$sql_lo_812 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu, ISNULL(z.real_lra,0) real_lra FROM(
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('812') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,3))x
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('812') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,3))y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
							INNER JOIN
							(select x.kd_skpd, x.kd_lra, x.kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
								FROM(
									select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,3),'8','4') as kd_lra, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('812') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) x
									INNER JOIN				
									(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) real_lra from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('412') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) y
									on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
									group by x.kd_skpd,x.kd_lra, x.kd_rek5) z
							on x.kd_skpd=z.kd_skpd and x.kd_rek5=z.kd_rek5
							order by kd_rek5";
			}
			$sql_lo_8122=$this->db->query($sql_lo_812);
		
			foreach ($sql_lo_8122->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");				
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				
				$banding = $realisasi_lo-$reallra;
				if($banding<0){
					$m = "(";
					$n = ")";
					$hitung_banding = $banding*-1;
					$lebih_kurang_banding = empty($hitung_banding) || $hitung_banding == 0 ? number_format(0,"2",",",".") :number_format($hitung_banding,"2",",",".");
				}else{
					$m = "";
					$n = "";
					$lebih_kurang_banding = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
				
				
				if($realisasi_tlalu<$realisasi_lo){
					$naik_turun = "terjadi peningkatan";
				}else if($realisasi_tlalu==$realisasi_lo){
					$naik_turun = "tidak terjadi perubahan";
				}else{
					$naik_turun = "terjadi penurunan";
				}
				
				if($realisasi_lo!=$reallra){
					$selisih = "perbedaan";
				}else{
					$selisih = "persamaan";
				}
				
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_lra."</strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." sebesar Rp. ".$real_lo." dan realisasi ".$nm_rek5." Tahun Anggaran ".$cthnsbl." sebesar Rp. ".$real_tlalu." terjadi ".$naik_turun." sebesar Rp. ".$lebih_kurang_lo." atau ".$persen_lo."%. Jika ".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp. ".$real_lo." dibandingkan dengan realisasi ".$nm_rek5." - LRA sebesar Rp. ".$real_lra." $selisih sebesar Rp. ".$m."".$lebih_kurang_banding."".$n.", dapat dijelaskan sebagai berikut :</td>                         
						 </tr>";
						 
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td valign=\"top\" align=\"right\">-</td>                         
							 <td align=\"left\">Pendapatan Retribusi Daerah - LRA $thn</td>
							 <td align=\"right\">".$real_lra."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>";
						
				$total = 0;	
				$sql_det = "select z.no,z.kd_rek,z.nm_rek,sum(q.nilai_x) nilai from ( 
							select '$cthnsbl' thn,'11302' kd_rek,isnull(sum(d.debet-d.kredit),0)*-1 nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,5)='11302' and year(c.tgl_voucher)<='$cthnsbl'
							union all
							select '$thn' thn,'11302' kd_rek,isnull(sum(d.debet-d.kredit),0) nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,5)='11302' and year(c.tgl_voucher)<='$thn'
							union all 
							select '$cthnsbl' thn,'214' kd_rek,isnull(sum(d.debet-d.kredit),0) nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,3)='214' and year(c.tgl_voucher)<='$cthnsbl'
							union all
							select '$thn' thn,'214' kd_rek,isnull(sum(d.debet-d.kredit),0)*-1 nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,3)='214' and year(c.tgl_voucher)<='$thn'
							) q 
							inner join 
							(select no,kd_rek,nm_rek,kd_neraca,thn from ket_lo_calk where left(kd_rek,3)='812')
							z
							on q.thn=z.thn and z.kd_neraca=q.kd_rek
							group by z.no,z.kd_rek,z.nm_rek
							order by z.kd_rek";
				$sql_det_2=$this->db->query($sql_det);
		
				foreach ($sql_det_2->result() as $rowsc){
					$no        		= $rowsc->no;
					$kd_rek        = $rowsc->kd_rek;
					$nm_rek        = $rowsc->nm_rek;
					$nilai         = $rowsc->nilai;
					
					$total		   = $total+$nilai;
					$nilai_lo = empty($nilai) || $nilai == 0 ? number_format(0,"2",",",".") :number_format($nilai,"2",",",".");
					
					
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"right\">$no</td>                         
							 <td align=\"left\" $bg_color>".$nm_rek."</td>
							 <td align=\"right\" $bg_color>".$nilai_lo."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>
						";
				
				}
				
					$nilai_plus=$reallra+$total;
					
					$nilai_plus_lo = empty($nilai_plus) || $nilai_plus == 0 ? number_format(0,"2",",",".") :number_format($nilai_plus,"2",",",".");
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td valign=\"top\" align=\"right\">-</td>                         
							 <td align=\"left\">".$nm_rek5." $thn</td>
							 <td align=\"right\">".$nilai_plus_lo."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>
						";
				
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_812
							</td>                         
						</tr>";
			
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			
			}
			


		//(813)
		if($cek==0){
			$sql_lo_813 = "select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, 0 as realisasi,  sum(b.kredit-b.debet) real_tlalu, 0 as real_lra 
			from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
			where LEFT(b.kd_rek5,3) IN ('813') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
			group by b.kd_unit, LEFT(b.kd_rek5,3)
			order by kd_rek5";
			}else{
			$sql_lo_813 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu, ISNULL(z.real_lra,0) real_lra FROM(
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('813') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,3))x
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('813') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,3))y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
							INNER JOIN
							(select x.kd_skpd, x.kd_lra, x.kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
								FROM(
									select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,3),'8','4') as kd_lra, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('813') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) x
									INNER JOIN				
									(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) real_lra from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('413') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) y
									on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
									group by x.kd_skpd,x.kd_lra, x.kd_rek5) z
							on x.kd_skpd=z.kd_skpd and x.kd_rek5=z.kd_rek5
							order by kd_rek5";
			}
			$sql_lo_8132=$this->db->query($sql_lo_813);
		
			foreach ($sql_lo_8132->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");				
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				
				$banding = $realisasi_lo-$reallra;
				if($banding<0){
					$m = "(";
					$n = ")";
					$hitung_banding = $banding*-1;
					$lebih_kurang_banding = empty($hitung_banding) || $hitung_banding == 0 ? number_format(0,"2",",",".") :number_format($hitung_banding,"2",",",".");
				}else{
					$m = "";
					$n = "";
					$lebih_kurang_banding = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
				
				
				if($realisasi_tlalu<$realisasi_lo){
					$naik_turun = "terjadi peningkatan";
				}else if($realisasi_tlalu==$realisasi_lo){
					$naik_turun = "tidak terjadi perubahan";
				}else{
					$naik_turun = "terjadi penurunan";
				}
				
				if($realisasi_lo!=$reallra){
					$selisih = "perbedaan";
				}else{
					$selisih = "persamaan";
				}
				
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_lra."</strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." sebesar Rp. ".$real_lo." dan realisasi ".$nm_rek5." Tahun Anggaran ".$cthnsbl." sebesar Rp. ".$real_tlalu." terjadi ".$naik_turun." sebesar Rp. ".$lebih_kurang_lo." atau ".$persen_lo."%. Jika ".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp. ".$real_lo." dibandingkan dengan realisasi ".$nm_rek5." - LRA sebesar Rp. ".$real_lra." $selisih sebesar Rp. ".$m."".$lebih_kurang_banding."".$n.", dapat dijelaskan sebagai berikut :</td>                         
						 </tr>";
						
				$sql_det = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_lo_calk a  
							LEFT JOIN
							(select kd_rek, nm_rek, nilai from nilai_lo_calk where kd_skpd='$kd_skpd') b
							on a.kd_rek=b.kd_rek
							where LEFT(a.kd_rek,3)='813'";
				$sql_det_2=$this->db->query($sql_det);
		
				foreach ($sql_det_2->result() as $rowsc){
					$kd_rek        = $rowsc->kd_rek;
					$nm_rek        = $rowsc->nm_rek;
					$nilai         = $rowsc->nilai;
					
					$nilai_lo = empty($nilai) || $nilai == 0 ? number_format(0,"2",",",".") :number_format($nilai,"2",",",".");
					
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\" $bg_color></td>
							 <td align=\"right\" $bg_color>".$nilai_lo."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>
						";
				
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_813
							</td>                         
						</tr>";
				
				}
			
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			
			}	
/*			
			//(814)
		if($cek==0){
			$sql_lo_814 = "select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, 0 as realisasi,  sum(b.kredit-b.debet) real_tlalu, 0 as real_lra 
			from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
			where LEFT(b.kd_rek5,3) IN ('814') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
			group by b.kd_unit, LEFT(b.kd_rek5,3)
			order by kd_rek5";
			}else{
			$sql_lo_814 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu, ISNULL(z.real_lra,0) real_lra, p.ket FROM(
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('814') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,3))x
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('814') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,3))y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
							INNER JOIN
							(select x.kd_skpd, x.kd_lra, x.kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
								FROM(
									select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,3),'8','4') as kd_lra, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('814') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) x
									INNER JOIN				
									(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) real_lra from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('414') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) y
									on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
									group by x.kd_skpd,x.kd_lra, x.kd_rek5) z
							on x.kd_skpd=z.kd_skpd and x.kd_rek5=z.kd_rek5
							LEFT JOIN 
							(select kd_rek,nm_rek ket from ket_lo_calk
							where left(kd_rek,3)='814' and len(kd_rek)>3 
							group by kd_rek,nm_rek) p
							on LEFT(x.kd_rek5,5)=p.kd_rek
							order by kd_rek5";
			}
			$sql_lo_8142=$this->db->query($sql_lo_814);
		
			foreach ($sql_lo_8142->result() as $rowsc){
				$kd_skpd         = $rowsc->kd_skpd;
				$kd_rek5         = $rowsc->kd_rek5;
				$nm_rek5         = $rowsc->nm_rek5;
				$realisasi_lo    = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				$ket             = $rowsc->ket;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");				
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				
				$banding = $realisasi_lo-$reallra;
				if($banding<0){
					$m = "(";
					$n = ")";
					$hitung_banding = $banding*-1;
					$lebih_kurang_banding = empty($hitung_banding) || $hitung_banding == 0 ? number_format(0,"2",",",".") :number_format($hitung_banding,"2",",",".");
				}else{
					$m = "";
					$n = "";
					$lebih_kurang_banding = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
				
				
				if($realisasi_tlalu<$realisasi_lo){
					$naik_turun = "terjadi peningkatan";
				}else if($realisasi_tlalu==$realisasi_lo){
					$naik_turun = "tidak terjadi perubahan";
				}else{
					$naik_turun = "terjadi penurunan";
				}
				
				if($realisasi_lo!=$reallra){
					$selisih = "terjadi perbedaan";
				}else{
					$selisih = "tarjadi persamaan";
				}
				
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_lra."</strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran ".$thn." sebesar Rp. ".$real_lo." dan realisasi ".$nm_rek5." Tahun Anggaran ".$cthnsbl." sebesar Rp. ".$real_tlalu." ".$naik_turun." sebesar Rp. ".$lebih_kurang_lo." atau ".$persen_lo."%. Jika ".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp. ".$real_lo." dibandingkan dengan realisasi ".$nm_rek5." - LRA sebesar Rp. ".$real_lra." $selisih sebesar Rp. ".$m."".$lebih_kurang_banding."".$n.", dapat dijelaskan sebagai berikut :</td>                         
						 </tr>
						 
						 <!--<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"7\" align=\"left\" $bg_color>$ket</td>
							</tr>-->";
						 
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_814
							</td>                         
						</tr>";
			
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			
			}
			*/


		//(814)
		if($cek==0){
			$sql_lo_814 = "select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, 0 as realisasi,  sum(b.kredit-b.debet) real_tlalu, 0 as real_lra 
			from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
			where LEFT(b.kd_rek5,3) IN ('814') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
			group by b.kd_unit, LEFT(b.kd_rek5,3)
			order by kd_rek5";
			}else{
			$sql_lo_814 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu, ISNULL(z.real_lra,0) real_lra FROM(
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('814') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,3))x
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.kredit-b.debet) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('814') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,3))y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
							INNER JOIN
							(select x.kd_skpd, x.kd_lra, x.kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
								FROM(
									select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,3),'8','4') as kd_lra, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('814') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) x
									INNER JOIN				
									(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.kredit-b.debet) real_lra from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('414') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) y
									on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
									group by x.kd_skpd,x.kd_lra, x.kd_rek5) z
							on x.kd_skpd=z.kd_skpd and x.kd_rek5=z.kd_rek5
							order by kd_rek5";
			}
			$sql_lo_8142=$this->db->query($sql_lo_814);
		
			foreach ($sql_lo_8142->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");				
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				
				$banding = $realisasi_lo-$reallra;
				if($banding<0){
					$m = "(";
					$n = ")";
					$hitung_banding = $banding*-1;
					$lebih_kurang_banding = empty($hitung_banding) || $hitung_banding == 0 ? number_format(0,"2",",",".") :number_format($hitung_banding,"2",",",".");
				}else{
					$m = "";
					$n = "";
					$lebih_kurang_banding = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				} 
				
				
				if($realisasi_tlalu<$realisasi_lo){
					$naik_turun = "terjadi peningkatan";
				}else if($realisasi_tlalu==$realisasi_lo){
					$naik_turun = "tidak terjadi perubahan";
				}else{
					$naik_turun = "terjadi penurunan";
				}
				
				if($realisasi_lo!=$reallra){
					$selisih = "perbedaan";
				}else{
					$selisih = "persamaan";
				}
				
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_lra."</strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Provinsi Kalimantan Barat Tahun Anggaran ".$thn." sebesar Rp. ".$real_lo." dan realisasi ".$nm_rek5." Tahun Anggaran ".$cthnsbl." sebesar Rp. ".$real_tlalu." terjadi ".$naik_turun." sebesar Rp. ".$lebih_kurang_lo." atau ".$persen_lo."%. Jika ".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp. ".$real_lo." dibandingkan dengan realisasi ".$nm_rek5." - LRA sebesar Rp. ".$real_lra." $selisih sebesar Rp. ".$m."".$lebih_kurang_banding."".$n.", dapat dijelaskan sebagai berikut :</td>                         
						 </tr>";
						 
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td valign=\"top\" align=\"right\">-</td>                         
							 <td align=\"left\">Lain-lain PAD Yang Sah - LRA $thn</td>
							 <td align=\"right\">".$real_lra."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>";
						
				$total = 0;	
				$sql_det = "select z.no,z.kd_rek,z.nm_rek,sum(q.nilai_x) nilai from (  
							select '$cthnsbl' thn,'11304' kd_rek,isnull(sum(d.debet-d.kredit),0)*-1 nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and (left(d.kd_rek5,5)='11304'and left(d.kd_rek5,7)<>'1130411') and year(c.tgl_voucher)<='$cthnsbl'
							union all
							select '$thn' thn,'11304' kd_rek,isnull(sum(d.debet-d.kredit),0) nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and (left(d.kd_rek5,5)='11304'and left(d.kd_rek5,7)<>'1130411') and year(c.tgl_voucher)<='$thn'
							union all
							select '$cthnsbl' thn,'11305' kd_rek,isnull(sum(d.debet-d.kredit),0)*-1 nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,5)='11305' and year(c.tgl_voucher)<='$cthnsbl'
							union all
							select '$thn' thn,'11305' kd_rek,isnull(sum(d.debet-d.kredit),0) nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,5)='11305' and year(c.tgl_voucher)<='$thn'
							union all 
							select '$thn' thn,'1130411' kd_rek,isnull(sum(d.debet-d.kredit),0) nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,7)='1130411' and year(c.tgl_voucher)<='$thn'
							union all
							select '$cthnsbl' thn,'1130411' kd_rek,isnull(sum(d.debet-d.kredit),0)*-1 nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,7)='1130411' and year(c.tgl_voucher)<='$cthnsbl'
							union all
							select '$cthnsbl' thn,'214' kd_rek,isnull(sum(d.debet-d.kredit),0) nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,3)='214' and year(c.tgl_voucher)<='$cthnsbl'
							union all
							select '$thn' thn,'214' kd_rek,isnull(sum(d.debet-d.kredit),0)*-1 nilai_x from trhju_calk c inner join trdju_calk d 
							on c.kd_skpd=d.kd_unit and c.no_voucher=d.no_voucher 
							where c.kd_skpd='$kd_skpd' and left(d.kd_rek5,3)='214' and year(c.tgl_voucher)<='$thn'
							) q 
							inner join 
							(select no,kd_rek,nm_rek,kd_neraca,thn from ket_lo_calk where left(kd_rek,3)='814')
							z
							on q.thn=z.thn and z.kd_neraca=q.kd_rek
							group by z.no,z.kd_rek,z.nm_rek
							order by z.kd_rek";
				$sql_det_2=$this->db->query($sql_det);
		
				foreach ($sql_det_2->result() as $rowsc){
					$no        = $rowsc->no;
					$kd_rek        = $rowsc->kd_rek;
					$nm_rek        = $rowsc->nm_rek;
					$nilai         = $rowsc->nilai;
					
					$total		   = $total+$nilai;
					$nilai_lo = empty($nilai) || $nilai == 0 ? number_format(0,"2",",",".") :number_format($nilai,"2",",",".");
					
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"right\">$no</td>                         
							 <td align=\"left\" $bg_color>".$nm_rek."</td>
							 <td align=\"right\" $bg_color>".$nilai_lo."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>
						";
				
				}
				
					$nilai_plus=$reallra+$total;
					
					$nilai_plus_lo = empty($nilai_plus) || $nilai_plus == 0 ? number_format(0,"2",",",".") :number_format($nilai_plus,"2",",",".");
					
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td valign=\"top\" align=\"right\">-</td>                         
							 <td align=\"left\">".$nm_rek5." $thn</td>
							 <td align=\"right\">".$nilai_plus_lo."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>
						";
				
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_814
							</td>                         
						</tr>";
			
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			
			}			
			
		$cRet .= "</table><br>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("BAB III $kd_skpd /");
        $this->template->set('title', 'BAB III $kd_skpd / $cbulan');        
        
		$pilih=1;
		switch($pilih) {       
        case 1;
			echo ("<title>BAB III</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }
	
	function cetak_babIII_beban($dcetak='',$ttd='',$kd_skpd='',$jnsctk='',$judul=''){
		$spasi = "line-height: 1.5em;";
		
		$thn     = $this->session->userdata('pcThang');
		$cbulan  = substr($dcetak,5,2);
		$cthnsbl = $thn-1;
		
		if($cbulan== 12){
		$sumber_data= "_at";
		$trdju = "trdju_calk";
        $trhju = "trhju_calk";
		}else{
		$sumber_data= "";
		$trdju = "trdju";
        $trhju = "trhju";
		}
		
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd'";
        $sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$nmskpd = $rowsc->nm_skpd;
		} 
		$nm_skpd = strtoupper($nmskpd);	
	
		$lcttd = str_replace('a',' ',$ttd);
		$sqlsc ="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc){
			$kab     = $rowsc->kab_kota;
			$prov    = $rowsc->provinsi;
			$daerah  = $rowsc->daerah;
			$thnx     = $rowsc->thn_ang;
		}
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd){
			$nip      =$rowttd->nip;                    
			$nama_ttd = $rowttd->nm;
			$jabatan  = $rowttd->jab;
		}
		
		
		
		if($jnsctk==1){
			$bg_color = "bgcolor=\"yellow\"";
			$tombol_911 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_beban_911\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_912 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_beban_912\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_913 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_beban_913\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_914 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_beban_914\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_915 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_beban_915\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_918 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_beban_918\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		}else{
			$bg_color = "";
			$tombol_911 = "";
			$tombol_912 = "";
			$tombol_913 = "";
			$tombol_914 = "";
			$tombol_915 = "";
			$tombol_918 = "";
		}
		
		$cRet = '';
		
		//mulai
		
		if($judul=='2'){
				$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                        <td align=\"center\"><strong>BAB III  PENJELASAN POS-POS LAPORAN KEUANGAN</strong></td>                         
                    </tr>
				 </table><br>";
				
				$cRet .= "<table width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\"><strong>3.1</strong></td>                         
						 <td align=\"left\" colspan=\"2\"><strong>Rincian dan Penjelasan masing-masing pos-pos laporan Keuangan SKPD.</strong></td>                         
					</tr></table>";
		 		
				$cRet .= "<table width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
							<tr>
								 <td align=\"left\" width=\"2%\"><strong>&nbsp;</strong></td>                         
								 <td align=\"left\" width=\"4%\"><strong>3.1.2.</strong></td>                         
								 <td align=\"left\"><strong>Laporan Operasional</strong></td>                         
							</tr>
						  </table><br>";
		}
		
		
		
		$cRet .= "<table width=\"100%\" style=\"".$spasi."\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\" rowspan=\"2\"><strong>&nbsp;</strong></td>                         
						 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"center\" width=\"10%\" rowspan=\"2\"><strong>Reff</strong></td>                         
						 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"center\" width=\"25%\" rowspan=\"2\"><strong>Uraian</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"15%\"><strong>Realisasi - LO $thn</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"15%\"><strong>Realisasi - LO $cthnsbl</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"15%\"><strong>Kenaikan / (Penurunan)</strong></td>   						  
						 <td style=\"border-top:solid;border-bottom:solid;\" align=\"center\" width=\"5%\" rowspan=\"2\"><strong>%</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"13%\"><strong>Realisasi - LRA $thn</strong></td>
					</tr>
					<tr>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>                                               
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>                                               
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
					</tr>";
			//beban
			$sql_lo_9 = "SELECT * FROM (
							SELECT '$kd_skpd' kd_skpd, j.kd_rek5, j.nm_rek5, ISNULL(k.realisasi,0) realisasi, ISNULL(l.real_tlalu,0) real_tlalu, ISNULL(m.real_lra,0) real_lra 
							FROM (select kd_rek1 as kd_rek5, nm_rek1 as nm_rek5 from ms_rek1_64 where kd_rek1='9'
								  UNION ALL
								  select kd_rek2 as kd_rek5, nm_rek2 as nm_rek5 from ms_rek2_64 where kd_rek1='9'
								  ) j
							LEFT JOIN
							(SELECT x.kd_skpd,x.kd_rek5, ISNULL(x.realisasi,0) realisasi 
							 FROM(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,1) as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								  where LEFT(b.kd_rek5,1) IN ('9') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								  group by b.kd_unit, LEFT(b.kd_rek5,1)
								  UNION ALL
								  select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								  where LEFT(b.kd_rek5,1) IN ('9') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								  group by b.kd_unit, LEFT(b.kd_rek5,2)
								 ) x
							) k on j.kd_rek5=k.kd_rek5
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,1) as kd_rek5,(select nm_rek1 from ms_rek1_64 where kd_rek1=LEFT(b.kd_rek5,1)) as nm_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,1) IN ('9') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							 group by b.kd_unit, LEFT(b.kd_rek5,1)
							 UNION ALL
							 select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(b.kd_rek5,2)) as nm_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,1) IN ('9') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							 group by b.kd_unit, LEFT(b.kd_rek5,2)
							)l on j.kd_rek5=l.kd_rek5
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,1) as kd_lra, REPLACE(LEFT(b.kd_rek5,1),'5','9') as kd_rek5, sum(b.debet-b.kredit) real_lra from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,1) IN ('5') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
							 group by b.kd_unit, LEFT(b.kd_rek5,1)
							 UNION ALL
							 select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_lra, REPLACE(LEFT(b.kd_rek5,2),'5','9') as kd_rek5, sum(b.debet-b.kredit) real_lra from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,1) IN ('5') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
							 group by b.kd_unit, LEFT(b.kd_rek5,2)
							) m
							on j.kd_rek5=m.kd_rek5) z
							where z.realisasi<>0 OR z.real_tlalu<>0 OR z.real_lra<>0
							order by kd_rek5";
			$sql_lo_92=$this->db->query($sql_lo_9);
		
			foreach ($sql_lo_92->result() as $rowsc){
				$kd_skpd         = $rowsc->kd_skpd;
				$kd_rek5         = trim($rowsc->kd_rek5);
				$nm_rek5         = $rowsc->nm_rek5;
				$realisasi_lo    = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				 
				
				 
				$panjang = strlen($kd_rek5);

				if($panjang=='1'){
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$kd_rek5."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_lra."</strong></td>
						</tr>";
				}else{
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td> 
								 <td align=\"right\">&nbsp;</td>
								 <td align=\"left\">".$this->dotrek($kd_rek5)." ".$nm_rek5."</td>
								 <td align=\"right\">".$real_lo."</td>
								 <td align=\"right\">".$real_tlalu."</td>
								 <td align=\"right\">$a".$lebih_kurang_lo."$b</td>   						  
								 <td align=\"center\">".$persen_lo."</td>
								 <td align=\"right\">".$real_lra."</td>
							  </tr>";
				}
				
			}
			
			$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
		
		//91
			$sql_lo_91 = "SELECT * FROM (
							SELECT '$kd_skpd' kd_skpd, j.kd_rek5, j.nm_rek5, ISNULL(k.realisasi,0) realisasi, ISNULL(l.real_tlalu,0) real_tlalu, ISNULL(m.real_lra,0) real_lra 
							FROM (select kd_rek2 as kd_rek5, nm_rek2 as nm_rek5 from ms_rek2_64 where kd_rek2='91'
								  UNION ALL
								  select kd_rek3 as kd_rek5, nm_rek3 as nm_rek5 from ms_rek3_64 where LEFT(kd_rek3,2)='91' AND LEFT(kd_rek3,3) NOT IN ('918','919')
								  UNION ALL
								  select kd_rek3 as kd_rek5, 'Beban Lain - lain' as nm_rek5 from ms_rek3_64 where LEFT(kd_rek3,3) IN ('918','919')
							      ) j
							LEFT JOIN
							(SELECT x.kd_skpd,x.kd_rek5, ISNULL(x.realisasi,0) realisasi 
							 FROM(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								  where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								  group by b.kd_unit, LEFT(b.kd_rek5,2)
								  UNION ALL
								  select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								  where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) NOT IN ('918','919') AND YEAR(tgl_voucher)='$thn'
								  group by b.kd_unit, LEFT(b.kd_rek5,3)
								  UNION ALL
								  select b.kd_unit as kd_skpd, '918' as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								  where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) IN ('918','919') AND YEAR(tgl_voucher)='$thn'
								  group by b.kd_unit, LEFT(b.kd_rek5,3)
								 ) x
							) k on j.kd_rek5=k.kd_rek5
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(b.kd_rek5,2)) as nm_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							 group by b.kd_unit, LEFT(b.kd_rek5,2)
							 UNION ALL
							 select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) NOT IN ('918','919') AND YEAR(tgl_voucher)='$cthnsbl'
							 group by b.kd_unit, LEFT(b.kd_rek5,3)
							 UNION ALL
							 select b.kd_unit as kd_skpd, '918' as kd_rek5,'Beban Lain - lain' as nm_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) IN ('918','919') AND YEAR(tgl_voucher)='$cthnsbl'
							 group by b.kd_unit, LEFT(b.kd_rek5,3)
							)l on j.kd_rek5=l.kd_rek5
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_lra, REPLACE(LEFT(b.kd_rek5,2),'5','9') as kd_rek5, sum(b.debet-b.kredit) real_lra from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('51') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
							 group by b.kd_unit, LEFT(b.kd_rek5,2)
							 UNION ALL
							 select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_lra, REPLACE(LEFT(b.kd_rek5,3),'5','9') as kd_rek5, sum(b.debet-b.kredit) real_lra from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('51') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
							 group by b.kd_unit, LEFT(b.kd_rek5,3)
							) m
							on k.kd_rek5=m.kd_rek5 and k.kd_skpd=m.kd_skpd ) z
							where z.realisasi<>0 OR z.real_tlalu<>0 OR z.real_lra<>0
							order by kd_rek5";
			$sql_lo_912=$this->db->query($sql_lo_91);
		
			foreach ($sql_lo_912->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = trim($rowsc->kd_rek5);
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");
				
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
				
				if($panjang=='2'){
					$cRet .= "<tr>
								 <td align=\"left\"><strong>&nbsp;</strong></td>                         
								 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
								 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
								 <td align=\"right\"><strong>".$real_lo."</strong></td>
								 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
								 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
								 <td align=\"center\"><strong>".$persen_lo."</strong></td>
								 <td align=\"right\"><strong>".$real_lra."</strong></td>
							</tr>";
				}else{
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td> 
								 <td align=\"right\">&nbsp;</td>
								 <td align=\"left\">".$this->dotrek($kd_rek5)." ".$nm_rek5."</td>
								 <td align=\"right\">".$real_lo."</td>
								 <td align=\"right\">".$real_tlalu."</td>
								 <td align=\"right\">$a".$lebih_kurang_lo."$b</td>   						  
								 <td align=\"center\">".$persen_lo."</td>
								 <td align=\"right\">".$real_lra."</td>
							  </tr>";
				}
			}
			
			$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			
			
		//911
			$sql_lo_911 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu, ISNULL(z.real_lra,0) real_lra FROM(
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.debet-b.kredit) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('911') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,3))x
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.debet-b.kredit) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('911') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,3))y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
							INNER JOIN
							(select x.kd_skpd, x.kd_lra, x.kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
								FROM(
									select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,3),'9','5') as kd_lra, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.debet-b.kredit) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('911') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) x
									INNER JOIN				
									(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.debet-b.kredit) real_lra from $trhju  a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									where LEFT(b.kd_rek5,3) IN ('511') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
									group by b.kd_unit, LEFT(b.kd_rek5,3)) y
									on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
									group by x.kd_skpd,x.kd_lra, x.kd_rek5) z
							on x.kd_skpd=z.kd_skpd and x.kd_rek5=z.kd_rek5";
			$sql_lo_9112=$this->db->query($sql_lo_911);
		
			foreach ($sql_lo_9112->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$nm_belanja = str_replace('- LO','',$nm_rek5);
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");				
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				
				$banding = $realisasi_lo-$reallra;
				$banding_num = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				
				if($banding<0 || $banding>0){
					$selisih = "terjadi perbedaan";
				}else{
					$selisih = "tidak terjadi perbedaan";
				}
				
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				if($realisasi_lo>$realisasi_tlalu){
					$naik_turun = "kenaikan";
				}else if($realisasi_lo<$realisasi_tlalu){
					$naik_turun = "penurunan";
				}else{
					$naik_turun = "penurunan";
				}
				
				
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_lra."</strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran ".$thn." sebesar Rp. ".$real_lo." dan realisasi ".$nm_rek5." Tahun Anggaran ".$cthnsbl." sebesar Rp. ".$real_tlalu." terjadi ".$naik_turun." sebesar Rp. ".$lebih_kurang_lo." atau ".$persen_lo."%. Jika ".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp. ".$real_lo." dibandingkan dengan realisasi ".$nm_belanja." - LRA sebesar Rp. ".$real_lra." $selisih sebesar Rp. ".$banding_num.", dapat dijelaskan sebagai berikut :</td>                         
						 </tr>";
				
				
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td valign=\"top\" align=\"right\"><b>-</td>                         
							 <td align=\"left\"><b>".$nm_belanja." - LRA $thn</td>
							 <td align=\"right\"><b>".$real_lra."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>";
						
				/* $sql_det = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
							LEFT JOIN
							(select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$kd_skpd') b
							on a.kd_rek=b.kd_rek
							where LEFT(a.kd_rek,3)='911'"; */
					
					$sql_det = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai 
								from ket_beban_calk a  
								LEFT JOIN
								(select '9111' kd_rek, ISNULL(sum(nilai_trans),0) nilai
								from trkapitalisasi a inner join ms_rek5 b on a.kd_rek5=b.kd_rek5 
								where jenis<>'X' AND nilai_trans<>0 AND kd_skpd='$kd_skpd' AND LEFT(b.map_lo,3)='911'
								UNION ALL
								SELECT '9112' kd_rek, ISNULL(SUM(kredit-debet),0) nilai 
								FROM trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								WHERE LEFT(b.kd_rek5,5) IN ('21501') AND YEAR(tgl_voucher)='$thn' AND b.kd_unit='$kd_skpd'
								UNION ALL
								SELECT '9113' kd_rek, ISNULL(SUM(kredit-debet),0)*-1 nilai 
								FROM trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								WHERE LEFT(b.kd_rek5,5) IN ('21501') AND YEAR(tgl_voucher)<='$cthnsbl' AND b.kd_unit='$kd_skpd'
								) b
								on a.kd_rek=b.kd_rek
								where LEFT(a.kd_rek,3)='911'";
				$sql_det_2=$this->db->query($sql_det);
				$tot_lo_peg = 0;
				foreach ($sql_det_2->result() as $rowsc){
					$kd_rek        = $rowsc->kd_rek;
					$nm_rek        = $rowsc->nm_rek;
					$nilai         = $rowsc->nilai;
					
					$nilai_lo = empty($nilai) || $nilai == 0 ? number_format(0,"2",",",".") :number_format($nilai,"2",",",".");
					
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\" >".$nm_rek."</td>
							 <td align=\"right\" >".$nilai_lo."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>
						";
				
				$tot_lo_peg = $tot_lo_peg+$nilai;
				}
				
				$tot_beban_peg = $reallra+$tot_lo_peg;
				
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td valign=\"top\" align=\"right\"><b>-</td>                         
							 <td align=\"left\"><b>".$nm_rek5." $thn</td>
							 <td align=\"right\"><b>".number_format($tot_beban_peg,"2",",",".")."</td>
							 <td align=\"right\"></td>
							 <td align=\"right\"></td>   						  
							 <td align=\"center\"></td>
							 <td align=\"right\"></td>
						</tr>
						";
				
				/* $cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_911
							</td>                         
						</tr>"; */
			
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			}
				
			//--pindah
		$sql51 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=5";
        $hasil51 = $this->db->query($sql51);
		foreach ($hasil51->result() as $row)
        {
			$kd_rek51 = $row->kd_rek;			
		}
		
		$sql91 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=9";
        $hasil91 = $this->db->query($sql91);
		foreach ($hasil91->result() as $row)
        {
			$kd_rek91 = $row->kd_rek;			
		}
		
		$sql21 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=2";
        $hasil21 = $this->db->query($sql21);
		foreach ($hasil21->result() as $row)
        {
			$kd_rek21 = $row->kd_rek;			
		}
		
		$sql52 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=5";
        $hasil52 = $this->db->query($sql52);
		foreach ($hasil52->result() as $row)
        {
			$kd_rek52 = $row->kd_rek;			
		}
		
		$sql92 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=9";
        $hasil92 = $this->db->query($sql92);
		foreach ($hasil92->result() as $row)
        {
			$kd_rek92 = $row->kd_rek;			
		}
		
		$sql22 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=2";
        $hasil22 = $this->db->query($sql22);
		foreach ($hasil22->result() as $row)
        {
			$kd_rek22 = $row->kd_rek;			
		}
		
		$sql53 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=5";
        $hasil53 = $this->db->query($sql53);
		foreach ($hasil53->result() as $row)
        {
			$kd_rek53 = $row->kd_rek;			
		}
		
		$sql93 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=9";
        $hasil93 = $this->db->query($sql93);
		foreach ($hasil93->result() as $row)
        {
			$kd_rek93 = $row->kd_rek;			
		}
		
		$sql23 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=2";
        $hasil23 = $this->db->query($sql23);
		foreach ($hasil23->result() as $row)
        {
			$kd_rek23 = $row->kd_rek;			
		}
		
		$sql54 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=5";
        $hasil54 = $this->db->query($sql54);
		foreach ($hasil54->result() as $row)
        {
			$kd_rek54 = $row->kd_rek;			
		}
		
		$sql94 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=9";
        $hasil94 = $this->db->query($sql94);
		foreach ($hasil94->result() as $row)
        {
			$kd_rek94 = $row->kd_rek;			
		}
		
		$sql24 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=2";
        $hasil24 = $this->db->query($sql24);
		foreach ($hasil24->result() as $row)
        {
			$kd_rek24 = $row->kd_rek;			
		}
		//--akhir
				
		//912
			$sql_lo_912 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu, ISNULL(z.real_lra,0) real_lra FROM(
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.debet-b.kredit) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('912') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,3))x
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.debet-b.kredit) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('912') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,3))y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
							
							INNER JOIN 
							(select x.kd_skpd, x.kd_lra, x.kd_rek5, ISNULL(SUM(y.real_lra),0) real_lra 
							FROM(
								select b.kd_unit as kd_skpd, REPLACE(LEFT(b.kd_rek5,3),'9','5') as kd_lra, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.debet-b.kredit) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where LEFT(b.kd_rek5,3) IN ('912') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit, LEFT(b.kd_rek5,3)) x
								INNER JOIN				
								(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.debet-b.kredit) real_lra from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where LEFT(b.kd_rek5,3) IN ('512') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit, LEFT(b.kd_rek5,3)) y
								on x.kd_skpd=y.kd_skpd and x.kd_lra=y.kd_rek5
								group by x.kd_skpd,x.kd_lra, x.kd_rek5) z
							on x.kd_skpd=z.kd_skpd and x.kd_rek5=z.kd_rek5";
			$sql_lo_9122=$this->db->query($sql_lo_912);
		
			foreach ($sql_lo_9122->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$nm_belanja = str_replace('Beban Barang dan Jasa','Belanja Barang dan Jasa',$nm_rek5);
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");	
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				
				$banding = $realisasi_lo-$reallra;
				$banding_num = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				
				if($banding<0 || $banding>0){
					$selisih = "terjadi perbedaan";
				}else{
					$selisih = "tidak terjadi perbedaan";
				}
				
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo>$realisasi_tlalu){
					$naik_turun = "kenaikan";
				}else if($realisasi_lo<$realisasi_tlalu){
					$naik_turun = "penurunan";
				}else{
					$naik_turun = "penurunan";
				}
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_lra."</strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp.".$real_lo." dan realisasi ".$nm_rek5." Tahun Anggaran ".$cthnsbl." sebesar Rp.".$real_tlalu." terjadi $naik_turun sebesar Rp. $a".$lebih_kurang_lo."$b atau ".$persen_lo."%. Jika ".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp.".$real_lo." dibandingkan dengan realisasi ".$nm_belanja." - LRA sebesar Rp. ".$real_lra." $selisih sebesar Rp. ".$banding_num.", dapat dijelaskan sebagai berikut :</td>                         
						 </tr>";
				
				$sql_det = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu, ISNULL(z.real_lra,0) real_lra FROM (
								select b.kd_unit as kd_skpd, '1' kd_rek5, 'Beban Barang dan Jasa' as nm_rek5, sum(b.debet-b.kredit) realisasi 
								from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek91) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit

								UNION ALL
								select b.kd_unit as kd_skpd, '2' kd_rek5, 'Beban Persediaan' as nm_rek5, sum(b.debet-b.kredit) realisasi 
								from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek92) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit

								UNION ALL
								select b.kd_unit as kd_skpd, '3' kd_rek5, 'Beban Pemeliharaan' as nm_rek5, sum(b.debet-b.kredit) realisasi 
								from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek93) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit

								UNION ALL
								select b.kd_unit as kd_skpd, '4' kd_rek5, 'Beban Perjalanan Dinas' as nm_rek5, sum(b.debet-b.kredit) realisasi 
								from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek94) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit ) x
								LEFT JOIN 
								(select b.kd_unit as kd_skpd, '1' kd_rek5, 'Beban Barang dan Jasa' as nm_rek5, sum(b.debet-b.kredit) real_tlalu 
								from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek91) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
								group by b.kd_unit

								UNION ALL
								select b.kd_unit as kd_skpd, '2' kd_rek5, 'Beban Persediaan' as nm_rek5, sum(b.debet-b.kredit) real_tlalu 
								from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek92) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
								group by b.kd_unit

								UNION ALL
								select b.kd_unit as kd_skpd, '3' kd_rek5, 'Beban Pemeliharaan' as nm_rek5, sum(b.debet-b.kredit) real_tlalu 
								from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek93) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
								group by b.kd_unit

								UNION ALL
								select b.kd_unit as kd_skpd, '4' kd_rek5, 'Beban Perjalanan Dinas' as nm_rek5, sum(b.debet-b.kredit) real_tlalu 
								from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek94) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
								group by b.kd_unit ) y
								on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5
								LEFT JOIN 
								(select b.kd_unit as kd_skpd, '1' kd_rek5, 'Beban Barang dan Jasa' as nm_rek5, sum(b.debet-b.kredit) real_lra 
								from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek51) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit

								UNION ALL
								select b.kd_unit as kd_skpd, '2' kd_rek5, 'Beban Persediaan' as nm_rek5, sum(b.debet-b.kredit) real_lra 
								from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek52) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit

								UNION ALL
								select b.kd_unit as kd_skpd, '3' kd_rek5, 'Beban Pemeliharaan' as nm_rek5, sum(b.debet-b.kredit) real_lra 
								from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek53) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit

								UNION ALL
								select b.kd_unit as kd_skpd, '4' kd_rek5, 'Beban Perjalanan Dinas' as nm_rek5, sum(b.debet-b.kredit) real_lra 
								from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek54) 
								AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								group by b.kd_unit ) z
								on x.kd_skpd=z.kd_skpd and x.kd_rek5=z.kd_rek5";
				$sql_det_2=$this->db->query($sql_det);
				foreach ($sql_det_2->result() as $rowsc){
					$kd_skpd         = $rowsc->kd_skpd;
					$kd_rek5         = $rowsc->kd_rek5;
					$nm_rek5         = $rowsc->nm_rek5;
					$realisasi       = $rowsc->realisasi;
					$realisasi_tlalu = $rowsc->real_tlalu;
					$real_lra        = $rowsc->real_lra;
					
					$realisasi_lo = empty($realisasi) || $realisasi == 0 ? number_format(0,"2",",",".") :number_format($realisasi,"2",",",".");
					$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
					$reallra = empty($real_lra) || $real_lra == 0 ? number_format(0,"2",",",".") :number_format($real_lra,"2",",",".");
					
					$lebih_kurang    = $realisasi-$realisasi_tlalu;
					if($lebih_kurang<0){
						$a = "(";
						$b = ")";
						$hitung_lo = $lebih_kurang*-1;
						$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
					}else{
						$a = "";
						$b = "";
						$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
					} 
				
					$persen = ($realisasi!=0)?($realisasi_tlalu / $realisasi ) * 100:0;
					$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
					
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\">".$kd_rek5."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".$nm_rek5."</td>
							 <td align=\"right\">".$realisasi_lo."</td>
							 <td align=\"right\">".$real_tlalu."</td>
							 <td align=\"right\">$a".$lebih_kurang_lo."$b</td>   						  
							 <td align=\"center\">".$persen_lo."</td>
							 <td align=\"right\">".$reallra."</td>
						</tr>";
				
				}
				
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
				
				foreach ($sql_det_2->result() as $rowsc){
					$kd_skpd        = $rowsc->kd_skpd;
					$kd_rek5        = $rowsc->kd_rek5;
					$nm_rek5        = $rowsc->nm_rek5;
					$realisasi      = $rowsc->realisasi;
					$realisasi_tlalu = $rowsc->real_tlalu;
					$real_lra        = $rowsc->real_lra;
					
					$nm_belanja = str_replace('- LO','',$nm_rek5);
					
					$realisasi_lo = empty($realisasi) || $realisasi == 0 ? number_format(0,"2",",",".") :number_format($realisasi,"2",",",".");
					$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
					$reallra = empty($real_lra) || $real_lra == 0 ? number_format(0,"2",",",".") :number_format($real_lra,"2",",",".");
					
					$lebih_kurang    = $realisasi-$realisasi_tlalu;
					if($lebih_kurang<0){
						$a = "(";
						$b = ")";
						$hitung_lo = $lebih_kurang*-1;
						$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
					}else{
						$a = "";
						$b = "";
						$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
					} 
				
					$persen = ($realisasi!=0)?($realisasi_tlalu / $realisasi ) * 100:0;
					$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
					
					if($kd_rek5=='1'){
						$cRet .= "<tr>
								 <td align=\"left\"></td>                         
								 <td align=\"left\"></td>                         
								 <td align=\"left\"><b>".$kd_rek5."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".$nm_rek5."</td>
								 <td align=\"right\"><b>".$realisasi_lo."</td>
								 <td align=\"right\"><b>".$real_tlalu."</td>
								 <td align=\"right\"><b>$a".$lebih_kurang_lo."$b</td>   						  
								 <td align=\"center\"><b>".$persen_lo."</td>
								 <td align=\"right\"><b>".$reallra."</td>
							</tr>";
						
						$banding = $realisasi-$real_lra;
						$banding_num = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
						
						if($banding<0 || $banding>0){
							$beda = "terjadi perbedaan";
						}else{
							$beda = "tidak terjadi perbedaan";
						}
						
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">Jika ".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp.".$realisasi_lo." dibandingkan dengan realisasi ".$nm_rek5." - LRA sebesar Rp. ".$reallra." $beda sebesar Rp. ".$banding_num.", dapat dijelaskan sebagai berikut :</td>                         
						 </tr>";
					
						$cRet .= "<tr>
									 <td align=\"left\"></td>                         
									 <td valign=\"top\" align=\"right\">-</td>                         
									 <td align=\"left\"><b>".$nm_rek5." - LRA $thn</td>
									 <td align=\"right\"><b>".$reallra."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>";
						
						$sql_det = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a 
										LEFT JOIN
										(SELECT '9121' kd_rek, ISNULL(SUM(debet-kredit),0)*-1 nilai 
										from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
										WHERE YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,5)='11602' AND b.kd_unit='$kd_skpd'
										UNION ALL
										SELECT '9122' kd_rek, ISNULL(SUM(debet-kredit),0) nilai 
										from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
										WHERE YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,5)='11602' AND b.kd_unit='$kd_skpd'
										UNION ALL
										SELECT '9123' kd_rek, ISNULL(SUM(debet-kredit),0) nilai 
										from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
										WHERE YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,5)='11603' AND b.kd_unit='$kd_skpd'
										UNION ALL
										SELECT '9124' kd_rek, ISNULL(SUM(debet-kredit),0)*-1 nilai 
										from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
										WHERE YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,5)='11603' AND b.kd_unit='$kd_skpd'
										UNION ALL
										SELECT '9125' kd_rek, ISNULL(SUM(kredit-debet),0)*-1 nilai 
										from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
										WHERE YEAR(a.tgl_voucher)<='$cthnsbl' AND b.kd_rek5 IN ($kd_rek21) AND b.kd_unit='$kd_skpd'
										UNION ALL
										SELECT '9126' kd_rek, ISNULL(SUM(kredit-debet),0) nilai 
										from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
										WHERE YEAR(a.tgl_voucher)<='$thn' AND b.kd_rek5 IN ($kd_rek21) AND b.kd_unit='$kd_skpd'
										UNION ALL
										select a.kd_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
										LEFT JOIN
										(select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$kd_skpd') b
										on a.kd_rek=b.kd_rek
										where LEFT(a.kd_rek,4) in ('9127')
										UNION ALL
										select a.kd_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
										LEFT JOIN
										(select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$kd_skpd') b
										on a.kd_rek=b.kd_rek
										where LEFT(a.kd_rek,4) in ('9128')
										UNION ALL
										SELECT '9129' kd_rek, ISNULL(SUM(debet-kredit),0)*-1 nilai 
										from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
										--WHERE YEAR(a.tgl_voucher)='$thn' AND b.kd_rek5='5122002' AND b.kd_unit='$kd_skpd') b
										WHERE YEAR(a.tgl_voucher)='$thn' AND b.kd_rek5='5122003' AND b.kd_unit='$kd_skpd') b
										on a.kd_rek=b.kd_rek
										where LEFT(a.kd_rek,3)='912'
										order by kd_rek";
						$sql_det_2=$this->db->query($sql_det);
						$arr_az = "a";
						$tot_lo_brg = 0;
						foreach ($sql_det_2->result() as $rowsc){
							$kd_rek        = $rowsc->kd_rek;
							$nm_rek        = $rowsc->nm_rek;
							$nilai         = $rowsc->nilai;
							
							$nilai_lo = empty($nilai) || $nilai == 0 ? number_format(0,"2",",",".") :number_format($nilai,"2",",",".");
						if($kd_rek=='9127' || $kd_rek=='9128'){
						$cRet .= "<tr>
									 <td align=\"left\">&nbsp;</td>                         
									 <td align=\"right\" valign=\"top\">".$arr_az++.".</td>                         
									 <td align=\"left\" valign=\"top\" >".$nm_rek."</td>
									 <td align=\"right\" valign=\"top\" >".$nilai_lo."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";
						$cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\">
										$tombol_912
									</td>                         
								</tr>";
						}else{
						$cRet .= "<tr>
									 <td align=\"left\">&nbsp;</td>                         
									 <td align=\"right\" valign=\"top\">".$arr_az++.".</td>                         
									 <td align=\"left\" valign=\"top\" >".$nm_rek."</td>
									 <td align=\"right\" valign=\"top\" >".$nilai_lo."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";	
						}
						$tot_lo_brg = $tot_lo_brg+$nilai;
						
						}
						
						$tot_beban_brg = $real_lra+$tot_lo_brg;
						
						$cRet .= "<tr>
									 <td align=\"left\"></td>                         
									 <td valign=\"top\" align=\"right\">-</td>                         
									 <td align=\"left\"><b>".$nm_rek5." - LO $thn</td>
									 <td align=\"right\"><b>".number_format($tot_beban_brg,"2",",",".")."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";
						
						$cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\"></td>                         
								</tr>";
						
					}else if($kd_rek5=='2'){
						$cRet .= "<tr>
								 <td align=\"left\"></td>                         
								 <td align=\"left\"></td>                         
								 <td align=\"left\"><b>".$kd_rek5."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".$nm_rek5."</td>
								 <td align=\"right\"><b>".$realisasi_lo."</td>
								 <td align=\"right\"><b>".$real_tlalu."</td>
								 <td align=\"right\"><b>$a".$lebih_kurang_lo."$b</td>   						  
							     <td align=\"center\"><b>".$persen_lo."</td>
								 <td align=\"right\"><b>".$reallra."</td>
							</tr>";
						
						$banding = $realisasi-$real_lra;
						$banding_num = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
						
						if($banding<0 || $banding>0){
							$beda = "terjadi perbedaan";
						}else{
							$beda = "tidak terjadi perbedaan";
						}
						
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">Jika ".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp.".$realisasi_lo." dibandingkan dengan realisasi ".$nm_belanja." - LRA sebesar Rp. ".$reallra." $beda sebesar Rp. ".$banding_num.", dapat dijelaskan sebagai berikut :</td>                         
						 </tr>";
					
						$cRet .= "<tr>
									 <td align=\"left\"></td>                         
									 <td valign=\"top\" align=\"right\">-</td>                         
									 <td align=\"left\"><b>".$nm_belanja." - LRA $thn</td>
									 <td align=\"right\"><b>".$reallra."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>";
					
					
						$sql_det = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a 
							LEFT JOIN
							(SELECT '9131' kd_rek, ISNULL(SUM(debet-kredit),0)*-1 nilai 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,5) IN ('11701','11702','11703')
							UNION ALL
							SELECT '9132' kd_rek, ISNULL(SUM(debet-kredit),0) nilai 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,5) IN ('11701','11702','11703')
							UNION ALL
							SELECT '9133' kd_rek, ISNULL(sal_awal-kurang+tambah+tahun_n+koreksi,0) nilai
							FROM (
							SELECT SUM(sal_awal) sal_awal, SUM(kurang) kurang, SUM(tambah) tambah, 
							SUM(tahun_n) tahun_n, 
							sum(isnull(korplus,0)-isnull(kormin,0)) koreksi
							FROM lamp_aset 
							where kd_rek5='1170302' and kd_skpd='$kd_skpd' and tahun<='$thn' 
							group by left(kd_rek5,5)) x
							UNION ALL
							SELECT '9134' kd_rek, ISNULL(sal_awal,0)*-1 nilai
							FROM (
							SELECT SUM(sal_awal) sal_awal, SUM(kurang) kurang, SUM(tambah) tambah, 
							SUM(tahun_n) tahun_n, 
							sum(isnull(korplus,0)-isnull(kormin,0)) koreksi
							FROM lamp_aset 
							where kd_rek5='1170302' and kd_skpd='$kd_skpd' and tahun<='$cthnsbl' 
							group by left(kd_rek5,5)) x
							UNION ALL
							select a.kd_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
							LEFT JOIN (select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$kd_skpd') b
							on a.kd_rek=b.kd_rek where LEFT(a.kd_rek,4) in ('9135')
							UNION ALL
							select a.kd_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
							LEFT JOIN (select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$kd_skpd') b
							on a.kd_rek=b.kd_rek where LEFT(a.kd_rek,4) in ('9136')
							union all
							SELECT '9137' kd_rek, ISNULL(SUM(debet-kredit),0) nilai 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,7) IN ($kd_rek22)
							UNION ALL
							SELECT '9138' kd_rek, ISNULL(SUM(debet-kredit),0) nilai 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,7) IN ($kd_rek22)
							union all
							SELECT '9139' kd_rek, ISNULL(SUM(0),0) nilai 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE (b.kd_unit='$kd_skpd' and b.kd_unit='$kd_skpd') AND YEAR(a.tgl_voucher)='$thn' AND LEFT(b.kd_rek5,3) IN ('117')
							UNION ALL
							SELECT '91310' kd_rek, ISNULL(SUM(0),0) nilai 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE (b.kd_unit='$kd_skpd' and b.kd_unit='$kd_skpd') AND YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,3) IN ('117')
							UNION ALL
							select a.kd_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
							LEFT JOIN (select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$kd_skpd') b
							on a.kd_rek=b.kd_rek where LEFT(a.kd_rek,5) in ('91311')
							UNION ALL
							select a.kd_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
							LEFT JOIN (select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$kd_skpd') b
							on a.kd_rek=b.kd_rek where LEFT(a.kd_rek,5) in ('91312')
							) b
							on a.kd_rek=b.kd_rek
							where LEFT(a.kd_rek,3)='913'
							order by cast(a.kd_rek as int)";
						$sql_det_2=$this->db->query($sql_det);
						$arr_az = "a";
						$tot_lo_pers = 0;
						foreach ($sql_det_2->result() as $rowsc){
							$kd_rek        = $rowsc->kd_rek;
							$nm_rek        = $rowsc->nm_rek;
							$nilai         = $rowsc->nilai;
							
							$nilai_lo = empty($nilai) || $nilai == 0 ? number_format(0,"2",",",".") :number_format($nilai,"2",",",".");
						
						if($kd_rek=='9135' || $kd_rek=='9136' || $kd_rek=='91311' || $kd_rek=='91312'){
						$cRet .= "<tr>
									 <td align=\"left\">&nbsp;</td>                         
									 <td align=\"right\" valign=\"top\">".$arr_az++.".</td>                         
									 <td align=\"left\" valign=\"top\" >".$nm_rek."</td>
									 <td align=\"right\" valign=\"top\" >".$nilai_lo."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";
						$cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\">
										$tombol_913
									</td>                         
								</tr>";
						}else{
						$cRet .= "<tr>
									 <td align=\"left\">&nbsp;</td>                         
									 <td align=\"right\" valign=\"top\">".$arr_az++.".</td>                         
									 <td align=\"left\" valign=\"top\" >".$nm_rek."</td>
									 <td align=\"right\" valign=\"top\" >".$nilai_lo."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";	
						}
						/*
						$cRet .= "<tr>
									 <td align=\"left\">&nbsp;</td>                         
									 <td align=\"right\" valign=\"top\">".$arr_az++.".</td>                         
									 <td align=\"left\" valign=\"top\" >".$nm_rek."</td>
									 <td align=\"right\" valign=\"top\" >".$nilai_lo."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";*/
						
						$tot_lo_pers = $tot_lo_pers+$nilai;
						
						}
						
						$tot_beban_pers = $real_lra+$tot_lo_pers;
						
						$cRet .= "<tr>
									 <td align=\"left\"></td>                         
									 <td valign=\"top\" align=\"right\">-</td>                         
									 <td align=\"left\"><b>".$nm_rek5." - LO $thn</td>
									 <td align=\"right\"><b>".number_format($tot_beban_pers,"2",",",".")."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";
						
						/* $cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\">
										$tombol_913
									</td>                         
								</tr>"; */
								
							
							$cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\"></td>                         
								</tr>";
								
					}else if($kd_rek5=='3'){
						$cRet .= "<tr>
								 <td align=\"left\"></td>                         
								 <td align=\"left\"></td>                         
								 <td align=\"left\"><b>".$kd_rek5."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".$nm_rek5."</td>
								 <td align=\"right\"><b>".$realisasi_lo."</td>
								 <td align=\"right\"><b>".$real_tlalu."</td>
								 <td align=\"right\"><b>$a".$lebih_kurang_lo."$b</td>   						  
							     <td align=\"center\"><b>".$persen_lo."</td>
								 <td align=\"right\"><b>".$reallra."</td>
							</tr>";
						
						$banding = $realisasi-$real_lra;
						$banding_num = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
						
						if($banding<0 || $banding>0){
							$beda = "terjadi perbedaan";
						}else{
							$beda = "tidak terjadi perbedaan";
						}
						
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">Jika ".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp.".$realisasi_lo." dibandingkan dengan realisasi ".$nm_belanja." - LRA sebesar Rp. ".$reallra." $beda sebesar Rp. ".$banding_num.", dapat dijelaskan sebagai berikut :</td>                         
						 </tr>";
					
						$cRet .= "<tr>
									 <td align=\"left\"></td>                         
									 <td valign=\"top\" align=\"right\">-</td>                         
									 <td align=\"left\"><b>".$nm_belanja." - LRA $thn</td>
									 <td align=\"right\"><b>".$reallra."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>";
					
						$sql_det = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a 
							LEFT JOIN
							(
							SELECT '9141' kd_rek, ISNULL(SUM(debet-kredit),0) nilai 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,7) IN ('2150202')
							UNION ALL
							SELECT '9142' kd_rek, ISNULL(SUM(debet-kredit),0)*-1 nilai 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,7) IN ('2150202')
							union all
							select a.kd_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
							LEFT JOIN (select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$kd_skpd') b
							on a.kd_rek=b.kd_rek where LEFT(a.kd_rek,4) in ('9143')
							UNION ALL
							select a.kd_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a  
							LEFT JOIN (select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$kd_skpd') b
							on a.kd_rek=b.kd_rek where LEFT(a.kd_rek,4) in ('9144')
							) b
							on a.kd_rek=b.kd_rek
							where LEFT(a.kd_rek,3)='914'
							order by cast(a.kd_rek as int)";
						$sql_det_2=$this->db->query($sql_det);
						$tot_lo_pem = 0;
						foreach ($sql_det_2->result() as $rowsc){
							$kd_rek        = $rowsc->kd_rek;
							$nm_rek        = $rowsc->nm_rek;
							$nilai         = $rowsc->nilai;
							
							$nilai_lo = empty($nilai) || $nilai == 0 ? number_format(0,"2",",",".") :number_format($nilai,"2",",",".");
						if($kd_rek=='9143' || $kd_rek=='9144'){	
						$cRet .= "<tr>
									 <td align=\"left\">&nbsp;</td>                         
									 <td align=\"left\"></td>                         
									 <td align=\"left\">".$nm_rek."</td>
									 <td align=\"right\">".$nilai_lo."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";
						$cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\">
										$tombol_914
									</td>                         
								</tr>";
						}else{
							
						$cRet .= "<tr>
									 <td align=\"left\">&nbsp;</td>                         
									 <td align=\"left\"></td>                         
									 <td align=\"left\">".$nm_rek."</td>
									 <td align=\"right\">".$nilai_lo."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";
						}
								
						$tot_lo_pem = $tot_lo_pem+$nilai;
						
						}
						
						$tot_beban_pem = $real_lra+$tot_lo_pem;
						
						$cRet .= "<tr>
									 <td align=\"left\"></td>                         
									 <td valign=\"top\" align=\"right\">-</td>                         
									 <td align=\"left\"><b>".$nm_rek5." - LO $thn</td>
									 <td align=\"right\"><b>".number_format($tot_beban_pem,"2",",",".")."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";
						
						/* $cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\">
										$tombol_914
									</td>                         
								</tr>"; */
								
								 $cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\">
									</td>                         
								</tr>";
					}else{
						$cRet .= "<tr>
								 <td align=\"left\"></td>                         
								 <td align=\"left\"></td>                         
								 <td align=\"left\"><b>".$kd_rek5."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".$nm_rek5."</td>
								 <td align=\"right\"><b>".$realisasi_lo."</td>
								 <td align=\"right\"><b>".$real_tlalu."</td>
								 <td align=\"right\"><b>$a".$lebih_kurang_lo."$b</td>   						  
								  <td align=\"center\"><b>".$persen_lo."</td>
								 <td align=\"right\"><b>".$reallra."</td>
							</tr>";
						
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp.".$realisasi_lo." dibandingkan dengan realisasi ".$nm_belanja." - LRA sebesar Rp. ".$reallra."</td>                         
						 </tr>";
						 
						 $cRet .= "<tr>
									 <td align=\"left\"></td>                         
									 <td valign=\"top\" align=\"right\">-</td>                         
									 <td align=\"left\"><b>".$nm_belanja." - LRA $thn</td>
									 <td align=\"right\"><b>".$reallra."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>";
					
						$sql_det = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai from ket_beban_calk a 
							LEFT JOIN
							(select kd_rek, nm_rek, nilai from nilai_beban_calk where kd_skpd='$kd_skpd') b
							on a.kd_rek=b.kd_rek
							where LEFT(a.kd_rek,3)='915'";
						$sql_det_2=$this->db->query($sql_det);
						$tot_lo_perj = 0;
						foreach ($sql_det_2->result() as $rowsc){
							$kd_rek        = $rowsc->kd_rek;
							$nm_rek        = $rowsc->nm_rek;
							$nilai         = $rowsc->nilai;
							
							$nilai_lo = empty($nilai) || $nilai == 0 ? number_format(0,"2",",",".") :number_format($nilai,"2",",",".");
							
						$cRet .= "<tr>
									 <td align=\"left\">&nbsp;</td>                         
									 <td align=\"left\"></td>                         
									 <td align=\"left\">".$nm_rek."</td>
									 <td align=\"right\">".$nilai_lo."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";
						$cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\">
										$tombol_915
									</td>                         
								</tr>";
								
						$tot_lo_perj = $tot_lo_perj+$nilai;
						
						}
						
						$tot_beban_perj = $real_lra+$tot_lo_perj;
						
						$cRet .= "<tr>
									 <td align=\"left\"></td>                         
									 <td valign=\"top\" align=\"right\">-</td>                         
									 <td align=\"left\"><b>".$nm_rek5." - LO $thn</td>
									 <td align=\"right\"><b>".number_format($tot_beban_perj,"2",",",".")."</td>
									 <td align=\"right\"></td>
									 <td align=\"right\"></td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";
						
						/* $cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\">
										$tombol_914
									</td>                         
								</tr>"; */
								
								 $cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\">
									</td>                         
								</tr>";
						 
					}
					
					
				}
				
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
				
				
			}
			
			
		
		//915
			$sql_lo_915 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.debet-b.kredit) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('915') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,3)) x
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.debet-b.kredit) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('915') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,3) )y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
			$sql_lo_82=$this->db->query($sql_lo_915);
		
			foreach ($sql_lo_82->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? '' :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
					if($lebih_kurang<0){
						$a = "(";
						$b = ")";
						$hitung_lo = $lebih_kurang*-1;
						$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
					}else{
						$a = "";
						$b = "";
						$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
					} 
				
					if($realisasi_lo==0 || $realisasi_tlalu==0){
						$persen = 0;
					}else{
						$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
					} 
					$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong></strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." merupakan beban pemerintah dalam bentuk uang kepada pemerintah, pemerintah daerah lainnya, perusahaan daerah, masyarakat, dan organisasi kemasyarakatan, yang bersifat tidak wajib dan tidak mengikat. Pengakuan beban hibah berdasarkan dokumen Naskah Perjanjian Hibah Daerah (NPHD). Beban hibah juga termasuk hibah BOS kepada Satuan Pendidikan Dasar.</td>                         
						 </tr>";
				
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			}
			
			
			
		//916
			$sql_lo_916 = "SELECT x.kd_skpd, x.kd_rek5, x.nm_rek5, ISNULL(x.realisasi,0) realisasi, ISNULL(y.real_tlalu,0) real_tlalu FROM (
							select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.debet-b.kredit) realisasi from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('916') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
							group by b.kd_unit, LEFT(b.kd_rek5,3)) x
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.debet-b.kredit) real_tlalu from $trhju a inner join $trdju b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('916') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							group by b.kd_unit, LEFT(b.kd_rek5,3) )y
							on x.kd_skpd=y.kd_skpd and x.kd_rek5=y.kd_rek5";
			$sql_lo_82=$this->db->query($sql_lo_916);
		
			foreach ($sql_lo_82->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? '' :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
					if($lebih_kurang<0){
						$a = "(";
						$b = ")";
						$hitung_lo = $lebih_kurang*-1;
						$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
					}else{
						$a = "";
						$b = "";
						$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
					} 
				
					$persen = ($realisasi_lo!=0)?($realisasi_lo / $realisasi_tlalu ) * 100:0;
					$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong></strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." merupakan beban pemerintah daerah dalam bentuk uang atau barang yang diberikan kepada individu, keluarga, kelompok dan/atau masyarakat yang sifatnya tidak secara terus menerus dan selektif yang bertujuan untuk melindungi dari kemungkinan terjadinya resiko sosial. Pengakuan beban bantuan sosial berdasarkan Surat Keputusan Kepala Daerah.</td>                         
						 </tr>";
				
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			}
			
			
						
			//917
			$sql_lo_917 = "SELECT * FROM (
							SELECT '$kd_skpd' kd_skpd, j.kd_rek5, j.nm_rek5, ISNULL(k.realisasi,0) realisasi, ISNULL(l.real_tlalu,0) real_tlalu, ISNULL(m.real_lra,0) real_lra 
							FROM (select kd_rek3 as kd_rek5, nm_rek3 as nm_rek5 from ms_rek3_64 where LEFT(kd_rek3,3) IN ('917')
							      ) j
							LEFT JOIN
							(SELECT x.kd_skpd,x.kd_rek5, ISNULL(x.realisasi,0) realisasi 
							 FROM(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								  where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$thn'
								  group by b.kd_unit, LEFT(b.kd_rek5,2)
								  UNION ALL
								  select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								  where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) NOT IN ('918','919') AND YEAR(tgl_voucher)='$thn'
								  group by b.kd_unit, LEFT(b.kd_rek5,3)
								  UNION ALL
								  select b.kd_unit as kd_skpd, '918' as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								  where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) IN ('918','919') AND YEAR(tgl_voucher)='$thn'
								  group by b.kd_unit, LEFT(b.kd_rek5,3)
								 ) x
							) k on j.kd_rek5=k.kd_rek5
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_rek5,(select nm_rek2 from ms_rek2_64 where kd_rek2=LEFT(b.kd_rek5,2)) as nm_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND YEAR(tgl_voucher)='$cthnsbl'
							 group by b.kd_unit, LEFT(b.kd_rek5,2)
							 UNION ALL
							 select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_rek5,(select nm_rek3 from ms_rek3_64 where kd_rek3=LEFT(b.kd_rek5,3)) as nm_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) NOT IN ('918','919') AND YEAR(tgl_voucher)='$cthnsbl'
							 group by b.kd_unit, LEFT(b.kd_rek5,3)
							 UNION ALL
							 select b.kd_unit as kd_skpd, '918' as kd_rek5,'Beban Lain - lain' as nm_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) IN ('918','919') AND YEAR(tgl_voucher)='$cthnsbl'
							 group by b.kd_unit, LEFT(b.kd_rek5,3)
							)l on j.kd_rek5=l.kd_rek5
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,2) as kd_lra, REPLACE(LEFT(b.kd_rek5,2),'5','9') as kd_rek5, sum(b.debet-b.kredit) real_lra from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('51') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
							 group by b.kd_unit, LEFT(b.kd_rek5,2)
							 UNION ALL
							 select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_lra, REPLACE(LEFT(b.kd_rek5,3),'5','9') as kd_rek5, sum(b.debet-b.kredit) real_lra from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('51') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
							 group by b.kd_unit, LEFT(b.kd_rek5,3)
							) m
							on k.kd_rek5=m.kd_rek5 and k.kd_skpd=m.kd_skpd ) z
							where z.realisasi<>0 OR z.real_tlalu<>0 OR z.real_lra<>0"; 
			$sql_lo_9172=$this->db->query($sql_lo_917);
		
			foreach ($sql_lo_9172->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");	
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				
				$banding = $realisasi_lo-$reallra;
				$banding_num = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				
				if($banding<0 || $banding>0){
					$selisih = "terjadi perbedaan";
				}else{
					$selisih = "tidak terjadi perbedaan";
				}
				
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo>$realisasi_tlalu){
					$naik_turun = "kenaikan";
				}else if($realisasi_lo<$realisasi_tlalu){
					$naik_turun = "penurunan";
				}else{
					$naik_turun = "penurunan";
				}
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong></strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp.".$real_lo." dan realisasi ".$nm_rek5." Tahun Anggaran ".$cthnsbl." sebesar Rp.".$real_tlalu." terjadi $naik_turun sebesar Rp. $a".$lebih_kurang_lo."$b atau ".$persen_lo."%  dirincikan sebagai berikut :</td>                         
						 </tr>";
				
				$sql_det = "SELECT * FROM (
								SELECT '$kd_skpd' kd_skpd, j.kd_rek5, j.nm_rek5, ISNULL(k.realisasi,0) realisasi, ISNULL(l.real_tlalu,0) real_tlalu, ISNULL(m.real_lra,0) real_lra 
								FROM (select kd_rek4_64 as kd_rek5, nm_rek4_64 nm_rek5 from ms_rek4_64 where LEFT(kd_rek4_64,3) IN ('917') 
									  ) j
								LEFT JOIN
								(SELECT x.kd_skpd,x.kd_rek5, ISNULL(x.realisasi,0) realisasi 
								 FROM(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,5) as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									  where LEFT(b.kd_rek5,3) IN ('917') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) IN ('917') AND YEAR(tgl_voucher)='$thn'
									  group by b.kd_unit, LEFT(b.kd_rek5,5)
									 ) x
								) k on j.kd_rek5=k.kd_rek5
								LEFT JOIN
								(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,5) as kd_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									  where LEFT(b.kd_rek5,3) IN ('917') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) IN ('917') AND YEAR(tgl_voucher)='$cthnsbl'
									  group by b.kd_unit, LEFT(b.kd_rek5,5)
								)l on j.kd_rek5=l.kd_rek5
								LEFT JOIN
								(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,5) as kd_lra, REPLACE(LEFT(b.kd_rek5,5),'5','9') as kd_rek5, sum(b.debet-b.kredit) real_lra from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								 where LEFT(b.kd_rek5,3) IN ('517') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
								 group by b.kd_unit, LEFT(b.kd_rek5,5)
								) m
								on k.kd_rek5=m.kd_rek5 and k.kd_skpd=m.kd_skpd ) z
								where z.realisasi<>0 OR z.real_tlalu<>0 OR z.real_lra<>0";
				$sql_det_2=$this->db->query($sql_det);
				$no=1;
				foreach ($sql_det_2->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");	
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				
				$banding = $realisasi_lo-$reallra;
				$banding_num = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				
				if($banding<0 || $banding>0){
					$selisih = "terjadi perbedaan";
				}else{
					$selisih = "tidak terjadi perbedaan";
				}
				
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo>$realisasi_tlalu){
					$naik_turun = "kenaikan";
				}else if($realisasi_lo<$realisasi_tlalu){
					$naik_turun = "penurunan";
				}else{
					$naik_turun = "penurunan";
				}
				
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
					
				$cRet .= "<tr>
							 <td align=\"left\"></td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\">".$no++."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".$nm_rek5."</td>
							 <td align=\"right\">".$real_lo."</td>
							 <td align=\"right\">".$real_tlalu."</td>
							 <td align=\"right\">$a".$lebih_kurang_lo."$b</td>   						  
							 <td align=\"center\">".$persen_lo."</td>
							 <td align=\"right\"></td>
						</tr>";
				
				}
			
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			}

			//918
			$sql_lo_918 = "SELECT * FROM (
							SELECT '$kd_skpd' kd_skpd, j.kd_rek5, j.nm_rek5, ISNULL(k.realisasi,0) realisasi, ISNULL(l.real_tlalu,0) real_tlalu, ISNULL(m.real_lra,0) real_lra 
							FROM (select kd_rek3 as kd_rek5, 'Beban Lain - lain' as nm_rek5 from ms_rek3_64 where LEFT(kd_rek3,3) IN ('918','919')
								  ) j
							LEFT JOIN
							(SELECT x.kd_skpd,x.kd_rek5, ISNULL(x.realisasi,0) realisasi 
							 FROM(select b.kd_unit as kd_skpd, '918' as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								  where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) IN ('918','919') AND YEAR(tgl_voucher)='$thn'
								  group by b.kd_unit, LEFT(b.kd_rek5,3)
								 ) x
							) k on j.kd_rek5=k.kd_rek5
							LEFT JOIN
							(select b.kd_unit as kd_skpd, '918' as kd_rek5,'Beban Lain - lain' as nm_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,2) IN ('91') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) IN ('918','919') AND YEAR(tgl_voucher)='$cthnsbl'
							 group by b.kd_unit, LEFT(b.kd_rek5,3)
							)l on j.kd_rek5=l.kd_rek5
							LEFT JOIN
							(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,3) as kd_lra, REPLACE(LEFT(b.kd_rek5,3),'5','9') as kd_rek5, sum(b.debet-b.kredit) real_lra from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							 where LEFT(b.kd_rek5,3) IN ('518','519') AND b.kd_unit='$kd_skpd'  AND YEAR(tgl_voucher)='$thn'
							 group by b.kd_unit, LEFT(b.kd_rek5,3)
							) m
							on k.kd_rek5=m.kd_rek5 and k.kd_skpd=m.kd_skpd ) z
							where z.realisasi<>0 OR z.real_tlalu<>0 OR z.real_lra<>0";
			$sql_lo_9182=$this->db->query($sql_lo_918);
		
			foreach ($sql_lo_9182->result() as $rowsc){
				$kd_skpd        = $rowsc->kd_skpd;
				$kd_rek5        = $rowsc->kd_rek5;
				$nm_rek5        = $rowsc->nm_rek5;
				$realisasi_lo = $rowsc->realisasi;
				$realisasi_tlalu = $rowsc->real_tlalu;
				$reallra         = $rowsc->real_lra;
				
				$real_lo = empty($realisasi_lo) || $realisasi_lo == 0 ? number_format(0,"2",",",".") :number_format($realisasi_lo,"2",",",".");
				$real_tlalu = empty($realisasi_tlalu) || $realisasi_tlalu == 0 ? number_format(0,"2",",",".") :number_format($realisasi_tlalu,"2",",",".");
				$real_lra = empty($reallra) || $reallra == 0 ? number_format(0,"2",",",".") :number_format($reallra,"2",",",".");	
				
				$lebih_kurang    = $realisasi_lo-$realisasi_tlalu;
				
				$banding = $realisasi_lo-$reallra;
				$banding_num = empty($banding) || $banding == 0 ? number_format(0,"2",",",".") :number_format($banding,"2",",",".");
				
				if($banding<0 || $banding>0){
					$selisih = "terjadi perbedaan";
				}else{
					$selisih = "tidak terjadi perbedaan";
				}
				
				if($lebih_kurang<0){
					$a = "(";
					$b = ")";
					$hitung_lo = $lebih_kurang*-1;
					$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
				}else{
					$a = "";
					$b = "";
					$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
				} 
				
				if($realisasi_lo>$realisasi_tlalu){
					$naik_turun = "kenaikan";
				}else if($realisasi_lo<$realisasi_tlalu){
					$naik_turun = "penurunan";
				}else{
					$naik_turun = "penurunan";
				}
				
				if($realisasi_lo==0 || $realisasi_tlalu==0){
					$persen = 0;
				}else{
					$persen = ($realisasi_lo / $realisasi_tlalu ) * 100;
				} 
				
				$persen_lo = empty($persen) || $persen == 0 ? number_format(0,"2",",",".") :number_format($persen,"2",",",".");
				
				$panjang = strlen($kd_rek5);
			
				
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>".$this->dotrek($kd_rek5)."</strong></td>                         
							 <td align=\"left\"><strong>".$nm_rek5."</strong></td>
							 <td align=\"right\"><strong>".$real_lo."</strong></td>
							 <td align=\"right\"><strong>".$real_tlalu."</strong></td>
							 <td align=\"right\"><strong>$a".$lebih_kurang_lo."$b</strong></td>   						  
							 <td align=\"center\"><strong>".$persen_lo."</strong></td>
							 <td align=\"right\"><strong></strong></td>
						</tr>
						";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">".$nm_rek5." pada ".$nm_skpd." Tahun Anggaran  ".$thn." sebesar Rp.".$real_lo." dan realisasi ".$nm_rek5." Tahun Anggaran ".$cthnsbl." sebesar Rp.".$real_tlalu." terjadi $naik_turun sebesar Rp. $a".$lebih_kurang_lo."$b atau ".$persen_lo."%  dirincikan sebagai berikut :</td>                         
						 </tr>";
/*				
				$sql_det = "select a.kd_rek, a.nm_rek, ISNULL(b.nilai,0) nilai, ISNULL(b.nilai2,0) nilai2 from ket_beban_calk a 
							LEFT JOIN
							(select kd_rek, nm_rek, nilai, nilai2 from nilai_beban_calk where kd_skpd='$kd_skpd') b
							on a.kd_rek=b.kd_rek
							where LEFT(a.kd_rek,3)='918'";
*/							
				$sql_det = "SELECT * FROM (
								SELECT '$kd_skpd' kd_skpd, j.kd_rek5 kd_rek, j.nm_rek5 nm_rek, ISNULL(k.realisasi,0) nilai, ISNULL(l.real_tlalu,0) nilai2 
								FROM (select kd_rek4_64 as kd_rek5, nm_rek4_64 nm_rek5 from ms_rek4_64 where LEFT(kd_rek4_64,3) IN ('918','919') 
									  ) j
								LEFT JOIN
								(SELECT x.kd_skpd,x.kd_rek5, ISNULL(x.realisasi,0) realisasi 
								 FROM(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,5) as kd_rek5, sum(b.debet-b.kredit) realisasi from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									  where LEFT(b.kd_rek5,3) IN ('918','919') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) IN ('918','919') AND YEAR(tgl_voucher)='$thn'
									  group by b.kd_unit, LEFT(b.kd_rek5,5)
									 ) x
								) k on j.kd_rek5=k.kd_rek5
								LEFT JOIN
								(select b.kd_unit as kd_skpd, LEFT(b.kd_rek5,5) as kd_rek5, sum(b.debet-b.kredit) real_tlalu from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
									  where LEFT(b.kd_rek5,3) IN ('918','919') AND b.kd_unit='$kd_skpd' AND LEFT(b.kd_rek5,3) IN ('918','919') AND YEAR(tgl_voucher)='$cthnsbl'
									  group by b.kd_unit, LEFT(b.kd_rek5,5)
								)l on j.kd_rek5=l.kd_rek5
								) z
								where z.nilai<>0 OR z.nilai2<>0";
							
						$sql_det_2=$this->db->query($sql_det);
						$no=1;
						foreach ($sql_det_2->result() as $rowsc){
							$kd_rek        = $rowsc->kd_rek;
							$nm_rek        = $rowsc->nm_rek;
							$nilai         = $rowsc->nilai;
							$nilai2         = $rowsc->nilai2;
							
							$nilai_lo = empty($nilai) || $nilai == 0 ? number_format(0,"2",",",".") :number_format($nilai,"2",",",".");
							$nilai2_lo = empty($nilai2) || $nilai2 == 0 ? number_format(0,"2",",",".") :number_format($nilai2,"2",",",".");
							
							$lebih_kurang    = $nilai-$nilai2;
							
							if($lebih_kurang<0){
								$a = "(";
								$b = ")";
								$hitung_lo = $lebih_kurang*-1;
								$lebih_kurang_lo = empty($hitung_lo) || $hitung_lo == 0 ? number_format(0,"2",",",".") :number_format($hitung_lo,"2",",",".");
							}else{
								$a = "";
								$b = "";
								$lebih_kurang_lo = empty($lebih_kurang) || $lebih_kurang == 0 ? number_format(0,"2",",",".") :number_format($lebih_kurang,"2",",",".");
							} 
							
						$cRet .= "<tr>
									 <td align=\"left\">&nbsp;</td>                         
									 <td align=\"left\"></td>                         
									 <td align=\"left\" $bg_color>".$no++."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".$nm_rek."</td>
									 <td align=\"right\" $bg_color>".$nilai_lo."</td>
									 <td align=\"right\" $bg_color>".$nilai2_lo."</td>
									 <td align=\"right\">".$a."".$lebih_kurang_lo."".$b."</td>   						  
									 <td align=\"center\"></td>
									 <td align=\"right\"></td>
								</tr>
								";
						}
/*						
						$cRet .= "<tr>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"left\"><strong>&nbsp;</strong></td>
									 <td align=\"justify\" colspan=\"7\">
										$tombol_918
									</td>                         
								</tr>";
*/			
				$cRet .= "<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>   						  
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						 <td align=\"center\"><strong></strong>&nbsp;</td>
						</tr>";
			}
				
		
		$cRet .= "</table><br>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("BAB III $kd_skpd /");
        $this->template->set('title', 'BAB III $kd_skpd / $cbulan');        
        
		$pilih=1;
		switch($pilih) {       
        case 1;
			echo ("<title>BAB III</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }
	
	 //PINDAH
	 function hapus_calk(){
        $nomor = $this->input->post('no');
        $skpd = $this->input->post('skpd');
        
        $sql = "delete from isi_neraca_calk where ket like '$nomor' and kd_skpd = '$skpd'";
        $asg = $this->db->query($sql);
		
        if ($asg){
            echo '1'; 
        } else{
            echo '0';
        }
                       
    }
	
	//PINDAH
	function hapus_calk3(){
        $nomor = $this->input->post('no');
        $skpd = $this->input->post('skpd');
        $kd_rek = $this->input->post('kd_rek');
        
        $sql = "delete from isi_neraca_calk where ket like '$nomor' and kd_skpd = '$skpd' and kd_rek='$kd_rek'";
        $asg = $this->db->query($sql);
		
        if ($asg){
            echo '1'; 
        } else{
            echo '0';
        }
                       
    }
	
	function hapus_calk_lamp(){
        $nomor = $this->input->post('no');
        $skpd = $this->input->post('skpd');
        $kd_rek = $this->input->post('kd_rek');
        $kd_rinci = $this->input->post('kd_rinci');
        
        $sql = "delete from isi_analisis_calk where ket like '$nomor' and kd_skpd = '$skpd' and kd_rinci='$kd_rinci' and kd_rek='$kd_rek'";
        $asg = $this->db->query($sql);
		
        if ($asg){
            echo '1'; 
        } else{
            echo '0';
        }
                       
    }
	
	 //PINDAH
	 function hapus_calk2(){
        $nomor = $this->input->post('no');
        $skpd = $this->input->post('skpd');
        $nilai = $this->input->post('nilai');
        $kd_rek = $this->input->post('kd_rek');
        
        $sql = "delete from isi_neraca_calk where ket like '$nomor' and kd_skpd = '$skpd' and nilai='$nilai' and kd_rek='$kd_rek'";
        $asg = $this->db->query($sql);
		
        if ($asg){
            echo '1'; 
        } else{
            echo '0';
        }
                       
    }
	
	 function hapus_calk_analisis(){
        $nomor = $this->input->post('no');
        $skpd = $this->input->post('skpd');
        $nilai = $this->input->post('nilai');
        $kd_rek = $this->input->post('kd_rek');
        
        $sql = "delete from isi_analisis_calk where ket like '$nomor' and kd_skpd = '$skpd' and nilai='$nilai' and kd_rek='$kd_rek'";
        $asg = $this->db->query($sql);
		
        if ($asg){
            echo '1'; 
        } else{
            echo '0';
        }
                       
    }

	function cetak_babIII_neraca($dcetak='',$ttd='',$kd_skpd='',$jnsctk='',$judul=''){
		$spasi = "line-height: 1.5em;";
		$thn	 = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;
		$cbulan  = substr($dcetak,5,2);
		$cbulan2 = 12;
	
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd'";
        $sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$nmskpd = $rowsc->nm_skpd;
		} 
		$nm_skpd = strtoupper($nmskpd);	
	
		$lcttd = str_replace('a',' ',$ttd);
		$sqlsc ="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc){
			$kab     = $rowsc->kab_kota;
			$prov    = $rowsc->provinsi;
			$daerah  = $rowsc->daerah;
			//$thn     = $rowsc->thn_ang;
		}
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd){
			$nip      =$rowttd->nip;                    
			$nama_ttd = $rowttd->nm;
			$jabatan  = $rowttd->jab;
		}
		
		if($jnsctk==1){
			$bg_color = "bgcolor=\"yellow\"";
			
			$tombol_111= "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_kas_terima\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			
			$tombol_112= "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_kas_keluar\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			
			$tombol_1131= "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_piutang_pendapatan_1131\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
					   
			$tombol_1132= "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_piutang_pendapatan_1132\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			
			$tombol_1133= "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_piutang_pendapatan_1133\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			
			$tombol_131 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_131\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1312 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1312\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1313 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1313\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_132 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_132\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1322 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1322\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1323 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1323\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_133 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_133\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1332 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1332\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1333 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1333\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_134 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_134\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1342 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1342\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1343 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1343\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_135 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_135\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1352 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1352\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1353 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1353\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";		   
			$tombol_1362 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1362\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1363 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1363\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";		   
			$tombol_136 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_136\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_141 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_141\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1421 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1421\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1422 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1422\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1423 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1423\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1424 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1424\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_143 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_143\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1432 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1432\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1433 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1433\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1442 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1442\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_1443 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_1443\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_211 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_211\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_212 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_212\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_213 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_213\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_221 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_221\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_231 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_231\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_232 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_232\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_233 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_neraca_233\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
			$tombol_314 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lpe_314\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
        }else{
			$bg_color = "";
			$tombol_program = "";
			$tombol_111 = "";
			$tombol_112 = "";
			$tombol_1131 = "";
			$tombol_1132 = "";
			$tombol_1133 = "";
			$tombol_131 = "";
			$tombol_1312 = "";
			$tombol_1313 = "";
			$tombol_132 = "";
			$tombol_1322 = "";
			$tombol_1323 = "";
			$tombol_133 = "";
			$tombol_1332 = "";
			$tombol_1333 = "";
			$tombol_134 = "";
			$tombol_1342 = "";
			$tombol_1343 = "";
			$tombol_135 = "";
			$tombol_1352 = "";
			$tombol_1353 = "";
			$tombol_136 = "";
			$tombol_1362 = "";
			$tombol_1363 = "";
			$tombol_141 = "";
			$tombol_142 = "";
			$tombol_143 = "";
			$tombol_144 = "";
			$tombol_21 = "";
			$tombol_22 = "";
			$tombol_23 = "";
			$tombol_314 = "";
			$tombol_1421 = "";
			$tombol_1422 = "";
			$tombol_1423 = "";
			$tombol_1424 = "";
			$tombol_1432 = "";
			$tombol_1433 = "";
			$tombol_1442 = "";
			$tombol_1443 = "";
			$tombol_211 = "";
			$tombol_212 = "";
			$tombol_213 = "";
			$tombol_221 = "";
			$tombol_221 = "";
			$tombol_231 = "";
			$tombol_232 = "";
			$tombol_233 = "";
		}
		
		$modtahun= $thn%4;
	 
			if ($modtahun = 0){
				$nilaibulan=".31 JANUARI.29 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
					else {
				$nilaibulan=".31 JANUARI.28 FEBRUARI.31 MARET.30 APRIL.31 MEI.30 JUNI.31 JULI.31 AGUSTUS.30 SEPTEMBER.31 OKTOBER.30 NOVEMBER.31 DESEMBER";}
			 
			$arraybulan=explode(".",$nilaibulan);
		
		$cRet = '';
		
		//mulai
		
		if($judul=='2'){
				$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                        <td align=\"center\"><strong>BAB III  PENJELASAN POS-POS LAPORAN KEUANGAN</strong></td>                         
                    </tr>
				 </table><br>";
				
				$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\"  width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\"><strong>3.1</strong></td>                         
						 <td align=\"left\" colspan=\"2\"><strong>Rincian dan Penjelasan masing-masing pos-pos laporan Keuangan SKPD.</strong></td>                         
					</tr></table>";
		}
		
				$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
							<tr>
								 <td align=\"left\" width=\"2%\"><strong>&nbsp;</strong></td>                         
								 <td align=\"left\" width=\"4%\"><strong>3.1.3</strong></td>                         
								 <td align=\"left\"><strong>Penjelasan atas Neraca</strong></td>                         
							</tr>
							<tr>
								 <td align=\"left\" width=\"2%\">&nbsp;</td>                         
								 <td align=\"left\" width=\"4%\">&nbsp;</td>                         
								 <td align=\"justify\">Komposisi dan Rasio perbandingan Neraca per 31 Desember $thn dan  per 31 Desember $cthnsbl dapat dilihat sebagai berikut :</td>                         
							</tr>
						  </table><br>";
		
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\" rowspan=\"2\"><strong>&nbsp;</strong></td>                         
						 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"center\" width=\"10%\" rowspan=\"2\"><strong>Reff</strong></td>                         
						 <td colspan =\"3\"style=\"border-top:solid;;border-bottom:solid;\" align=\"center\" width=\"30%\" rowspan=\"2\"><strong>Penjelasan Neraca</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"15%\"><strong>Per 31 Desember $thn</strong></td>
						 <td style=\"border-top:solid;\" align=\"center\" width=\"13%\"><strong>Per 31 Desember $cthnsbl</strong></td>
					</tr>
					<tr>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>
						 <td align=\"center\" style=\"border-bottom:solid;\"><strong>(Rp)</strong></td>                                               
					</tr>
					<tr>
						 <td align=\"left\"><strong>&nbsp;</strong></td>                         
						 <td align=\"center\"><strong>&nbsp;</strong></td>                         
						 <td colspan =\"3\"align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
						 <td align=\"center\"><strong>&nbsp;</strong></td>
					</tr>";
			
		// 1 Aset
		$sql_12 = "	select '1' reff, 'ASET' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,1)='1' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// Uraian 1 Aset
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Aset merupakan salah satu pos yang termuat dalam Neraca Pemerintah Provinsi Kalimantan Barat. Nilai Aset Pemerintah Provinsi Kalimantan Barat per 31 Desember $thn dan per 31 Desember $cthnsbl terdiri dari : <br></td>                         
						</tr>";
		
		$sql_12 = "	select '1.1' reff, 'Aset Lancar' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,2)='11' and a.kd_unit='$kd_skpd'
					union all
					select '1.2' reff, 'Investasi Jangka Panjang' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,2)='12' and a.kd_unit='$kd_skpd'
					union all	
					select '1.3' reff, 'Aset Tetap' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,2)='13' and a.kd_unit='$kd_skpd'
					union all
					select '1.4' reff, 'Aset Lainnya' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,2)='15' and a.kd_unit='$kd_skpd'
					union all
					select '' reff, 'Jumlah Aset' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,1)='1' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			// Rincian 1 Aset
				if($reff==''){
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$a$real_sal$b</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}else{
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td align=\"right\">$a$real_sal$b</td>
								 <td align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}
			}	
		
		// 1.1 Aset Lancar
		$sql_12 = "	select '1.1' reff, 'ASET LANCAR' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,2)='11' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// Uraian 1.1 Aset Lancar
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Aset lancar terdiri dari kas dan setara kas, dan aset yang diharapkan untuk segera direalisasikan dalam waktu 12 (dua belas) bulan sejak tanggal pelaporan. Rincian dan perbandingan saldo Aset Lancar per 31 Desember $thn dan per 31 Desember $cthnsbl terdiri dari :<br></td>                         
						</tr>";
		
		$sql_12 = "	select '1.1.1' reff, 'Kas di Bendahara Penerimaan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,5)='11102' and a.kd_unit='$kd_skpd'
					union all
					select '1.1.2' reff, 'Kas di Bendahara Pengeluaran' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,5)='11103' and a.kd_unit='$kd_skpd'
					union all	
					select '1.1.3' reff, 'Piutang Pendapatan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='113' and a.kd_unit='$kd_skpd'
					union all
					select '1.1.4' reff, 'Piutang Lainnya' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='114' and a.kd_unit='$kd_skpd'
					union all
					select '1.1.5' reff, 'Penyisihan Piutang' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='115' and a.kd_unit='$kd_skpd'
					union all
					select '1.1.6' reff, 'Beban Dibayar Dimuka' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='116' and a.kd_unit='$kd_skpd'
					union all
					select '1.1.7' reff, 'Persediaan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='117' and a.kd_unit='$kd_skpd'
					union all
					select '' reff, 'Jumlah Aset Lancar' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,2)='11' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			// Rincian 1.1 Aset Lancar
				if($reff==''){
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$a$real_sal$b</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"center\"></td>                         
							 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
				}
				
			}
			
			// 1.1.1 Kas Bendahara Penerimaan
		$sql_12 = "	select '1.1.1' reff, 'Kas Bendahara Penerimaan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,5)='11102' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// Uraian 1.1.1 Kas Bendahara Penerimaan
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Kas di Bendahara Penerimaan merupakan pendapatan daerah yang masih berada di tangan Bendahara Penerimaan dan sampai dengan 31 Desember $thn belum disetorkan ke Kas Daerah.<br></td>                         
						</tr>";
			
			$sql_12 = "SELECT x.kd_rek, x.nm_rek, y.ket, y.kd_rinci FROM (
											SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE kd_rek='111') x 
											LEFT JOIN (
											SELECT kd_rek, ket, kd_rinci FROM isi_neraca_calk where kd_skpd='$kd_skpd') y
											on x.kd_rek=y.kd_rek
											order by kd_rinci";
					
			$sql_122=$this->db->query($sql_12);
			
			foreach ($sql_122->result() as $rowsc){
				$ket = $rowsc->ket;
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
			}
			
				
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_111
							</td>                         
						</tr>";
				
			
			
			// 1.1.2 Kas Bendahara Pengeluaran
		$sql_12 = "	select '1.1.2' reff, 'Kas Bendahara Pengeluaran' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,5)='11103' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// Uraian 1.1.2 Kas Bendahara Pengeluaran
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Kas di Bendahara Pengeluaran merupakan kas yang menjadi tanggung jawab/dikelola oleh Bendahara Pengeluaran dan sampai dengan 31 Desember $thn belum disetor ke Kas Daerah termasuk di dalamnya adalah Kas yang masih terdapat pada Rekening Koran, kas yang berasal dari PPN dan PPH yang dipungut tetapi belum disetorkan. <br></td>                         
						</tr>";
			
				$sql_12 = "SELECT x.kd_rek, x.nm_rek, y.ket, y.kd_rinci FROM (
											SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE kd_rek='112') x 
											LEFT JOIN (
											SELECT kd_rek, ket, kd_rinci FROM isi_neraca_calk where kd_skpd='$kd_skpd') y
											on x.kd_rek=y.kd_rek
											order by kd_rinci";
					
			$sql_122=$this->db->query($sql_12);
			
			foreach ($sql_122->result() as $rowsc){
				$ket = $rowsc->ket;
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
			}
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_112
							</td>                         
						</tr>";
			
			// 1.1.3 Piutang Pendapatan
		$sql_12 = "	select '1.1.3' reff, 'Piutang Pendapatan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='113' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// Uraian 1.1.3 Piutang Pendapatan
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Piutang Pendapatan terdiri dari piutang pajak daerah dan piutang retribusi daerah. <br></td>                         
						</tr>";
			
			// 1.1.3 Piutang Pajak Daerah
		$sql_12 = "	select '1' reff, 'Piutang Pajak Daerah' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where (LEFT(kd_rek5,5) IN ('11301') OR kd_rek5='1130405') and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
						
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
			
			// 1.1.3 Rincian Piutang Pajak Daerah
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Piutang pajak kendaraan bermotor disajikan berdasarkan Surat Ketetapan Pajak Daerah yang telah ditetapkan oleh Badan Pengelolaan Keuangan dan Pendapatan Daerah  yang belum terbayar sampai dengan tanggal 31 Desember $thn.<br><br></td>                         
						</tr>";
				
				$sql_12 = "SELECT x.kd_rek, x.nm_rek, y.ket, y.kd_rinci FROM (
											SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE kd_rek='1131') x 
											LEFT JOIN (
											SELECT kd_rek, ket, kd_rinci FROM isi_neraca_calk where kd_skpd='$kd_skpd') y
											on x.kd_rek=y.kd_rek
											order by kd_rinci";
					
			$sql_122=$this->db->query($sql_12);
			
			foreach ($sql_122->result() as $rowsc){
				$ket = $rowsc->ket;
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
			}
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_1131
							</td>                         
						</tr>";
				
				
			// 1.1.3 Piutang Retribusi Daerah
		$sql_12 = "	select '2' reff, 'Piutang Retribusi Daerah' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where (LEFT(kd_rek5,5) IN ('11302') OR kd_rek5='1130406') and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
						
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
			
			// 1.1.3 Rincian Piutang Retribusi Daerah
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Piutang retribusi dicatat sebesar nilai nominal, yaitu sebesar nilai rupiah piutang yang belum dilunasi sampai dengan tanggal pelaporan. <br><br></td>                         
						</tr>";
						
				$sql_12 = "SELECT x.kd_rek, x.nm_rek, y.ket, y.kd_rinci FROM (
											SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE kd_rek='1132') x 
											LEFT JOIN (
											SELECT kd_rek, ket, kd_rinci FROM isi_neraca_calk where kd_skpd='$kd_skpd') y
											on x.kd_rek=y.kd_rek
											order by kd_rinci";
					
			$sql_122=$this->db->query($sql_12);
			
			foreach ($sql_122->result() as $rowsc){
				$ket = $rowsc->ket;
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
			}
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_1132
							</td>                         
						</tr>";
				
				// 1.1.3 Piutang Lain-lain PAD Daerah
		$sql_12 = "	select '3' reff, 'Piutang Lain-lain PAD yang Sah' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where (LEFT(kd_rek5,5) IN ('11303') OR kd_rek5='1130407') and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
						
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
			
			// 1.1.3 Rincian Piutang Lain-lain PAD Daerah
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Piutang Lain-lain PAD yang Sah merupakan Piutang Denda Pajak, denda Retribusi dan Denda Pengembalian. <br></td>                         
						</tr>";
						
				$sql_12 = "SELECT x.kd_rek, x.nm_rek, y.ket, y.kd_rinci FROM (
											SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE kd_rek='1133') x 
											LEFT JOIN (
											SELECT kd_rek, ket, kd_rinci FROM isi_neraca_calk where kd_skpd='$kd_skpd') y
											on x.kd_rek=y.kd_rek
											order by kd_rinci";
					
			$sql_122=$this->db->query($sql_12);
			
			foreach ($sql_122->result() as $rowsc){
				$ket = $rowsc->ket;
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
			}
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_1133
							</td>                         
						</tr>";	
			
			// 1.1.4 Piutang Lainnya
		$sql_12 = "	select '1.1.4' reff, 'Piutang Lainnya' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='114' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 1.1.4 Uraian Piutang Lainnya
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Piutang Lainnya adalah Piutang Bagian Lancar Tagihan Penjualan Angsuran terdiri dari Pembayaran Angsuran Rumah Dinas Provinsi Kalimantan Barat dan Angsuran Kendaraan Dinas Provinsi Kalimantan Barat.<br></td>                         
						</tr>";
		
		$sql_12 = "	select '1' reff, 'Angsuran Rumah Dinas' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='1140301' and a.kd_unit='$kd_skpd'
					union all
					select '2' reff, 'Angsuran Kendaraan Dinas' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5 in ('1140302','1140303') and a.kd_unit='$kd_skpd'
					union all
					select '' reff, 'Jumlah Bagian Lancar Tagihan Penjualan Angsuran' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='114' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			// 1.1.4 Rincian Piutang Lainnya
				if($reff==''){
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$a$real_sal$b</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
				}
				
			}	
		
			// 1.1.5 Penyisihan Piutang
		$sql_12 = "	select '1.1.5' reff, 'Penyisihan Piutang' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='115' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 1.1.5 Uraian Penyisihan Piutang
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Penyisihan Piutang Pendapatan terdiri dari penyisihan piutang pajak dan penyisihan piutang retribusi.<br></td>                         
						</tr>";
		
		$sql_12 = "	select '1' reff, 'Penyisihan Piutang Pajak' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5 IN ('1150101','1150104','1150107') and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			// 1.1.5 Rincian Penyisihan Piutang Pajak
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
			
			// 1.1.5 Uraian Rincian Penyisihan Piutang Pajak
				$cRet.= "<tr>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\">&nbsp;</td>
							<td align=\"justify\" colspan=\"5\">Penggolongan Kualitas Piutang Pajak dengan ketentuan:</td>                         
						</tr>
						<tr>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\"width=\"3%\">a.</td>
							<td align=\"justify\" colspan=\"4\">Kualitas Piutang Lancar; dengan kriteria umur piutang kurang dari 1 tahun; Taksiran Piutang Tak Tertagih 0,5%.</td>                         
						</tr>
						<tr>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\"width=\"3%\">b.</td>
							<td align=\"justify\" colspan=\"4\">Kualitas Piutang Kurang Lancar; dengan kriteria umur piutang 1 sampai dengan 2 tahun; Taksiran Piutang Tak Tertagih 10 %.</td>                         
						</tr>
						<tr>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\"width=\"3%\">c.</td>
							<td align=\"justify\" colspan=\"4\">Kualitas Piutang Diragukan; dengan kriteria umur piutang 2 sampai dengan 5 tahun; Taksiran Piutang Tak Tertagih 50 %.</td>                         
						</tr>
						<tr>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\"width=\"3%\">d.</td>
							<td align=\"justify\" colspan=\"4\">Kualitas Piutang Macet. dengan kriteria umur piutang diatas 5 tahun; Taksiran Piutang Tak Tertagih 100 %.<br></td>                         
						</tr>";
			
			$sql_12 = "select '2' reff, 'Penyisihan Piutang Retribusi' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='1150102' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			// 1.1.5 Rincian Penyisihan Piutang Retribusi
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"center\">&nbsp;</td>                         
							 <td colspan =\"3\" align=\"left\">&nbsp;</td>
							 <td align=\"right\">&nbsp;</td>
							 <td align=\"right\">&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
		
			// 1.1.5 Uraian Rincian Penyisihan Piutang Retribusi
				$cRet.= "<tr>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\">&nbsp;</td>
							<td align=\"justify\" colspan=\"5\">Penggolongan Kualitas Piutang Bukan Pajak Khusus untuk objek Retribusi, dapat dipilah berdasarkan karakteristik sebagai berikut:</td>                         
						</tr>
						<tr>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\"width=\"3%\">a.</td>
							<td align=\"justify\" colspan=\"4\">Kualitas Lancar, jika umur piutang 0 sampai dengan 1 bulan; Taksiran Piutang Tak Tertagih 0,5%.</td>                         
						</tr>
						<tr>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\"width=\"3%\">b.</td>
							<td align=\"justify\" colspan=\"4\">Kualitas Kurang Lancar, jika umur piutang 1 sampai dengan 3 bulan; Taksiran Piutang Tak Tertagih 10 %.</td>                         
						</tr>
						<tr>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\"width=\"3%\">c.</td>
							<td align=\"justify\" colspan=\"4\">Kualitas Diragukan, jika umur piutang 3 sampai dengan 12 bulan; Taksiran Piutang Tak Tertagih 50 %.</td>                         
						</tr>
						<tr>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\">&nbsp;</td>
							<td align=\"left\"width=\"3%\">d.</td>
							<td align=\"justify\" colspan=\"4\">Kualitas Macet, jika umur piutang lebih dari 12  bulan; Taksiran Piutang Tak Tertagih 100 %.<br></td>                         
						</tr>";
		
			// 1.1.6 Beban Dibayar Dimuka
		$sql_12 = "	select '1.1.6' reff, 'Beban Dibayar Dimuka' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='116' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 1.1.6 Uraian Beban Dibayar Dimuka
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Beban dibayar dimuka terdiri dari Beban Jasa Dibayar Dimuka (asuransi dibayar dimuka dan  Sewa gedung)<br></td>                         
						</tr>";
		
		$sql_12 = "	select '1' reff, 'Asuransi dibayar dimuka' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='1160301' and a.kd_unit='$kd_skpd'
					union all
					select '2' reff, 'Sewa gedung' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='1160302' and a.kd_unit='$kd_skpd'
					union all
					select '' reff, 'Jumlah Beban dibayar dimuka' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='116' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			// 1.1.6 Rincian Beban Dibayar Dimuka
				if($reff==''){
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$a$real_sal$b</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
				}
			}
		
			// 1.1.7 Persediaan
		$sql_12 = "	select '1.1.7' reff, 'Persediaan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='117' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 1.1.7 Uraian Persediaan
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Persediaan adalah aset lancar dalam bentuk barang atau perlengkapan yang dimaksudkan untuk mendukung kegiatan operasional Pemerintah Daerah, dan barang-barang yang dimaksud untuk dijual dan/atau diserahkan dalam  rangka pelayanan kepada masyarakat. Aset tetap Peralatan dan Mesin yang tidak memenuhi kriteria batasan minimal kapitalisasi aset tetap yaitu sebesar sama dengan atau lebih dari Rp500.000,00 (Lima Ratus Ribu Rupiah) tetapi barang tersebut memiliki manfaat ekonomi barang lebih dari 12 (dua belas) bulan dan dipergunakan untuk operasional pemerintahan serta tidak untuk dijual.<br></td>                         
						</tr>";
		
		$sql_12 = "	select '1' reff, 'Persediaan Bahan Pakai Habis' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='11701' and a.kd_unit='$kd_skpd'
					union all
					select '2' reff, 'Persediaan Bahan/ Material' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='11702' and a.kd_unit='$kd_skpd'
					union all
					select '3' reff, 'Persediaan Barang Lainnya' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='11703' and a.kd_unit='$kd_skpd'
					union all
					select '' reff, 'Jumlah Persediaan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='117' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			// 1.1.7 Rincian Persediaan
				if($reff==''){
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$a$real_sal$b</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
				}
			}
			
			// 1.2 INVESTASI JANGKA PANJANG
		$sql_12 = "	select '1.2' reff, 'INVESTASI JANGKA PANJANG' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,2)='12' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 1.2 INVESTASI JANGKA PANJANG
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Investasi Jangka Panjang adalah investasi yang dimaksudkan untuk dimiliki lebih dari 12 (dua belas) bulan.<br></td>                         
						</tr>";
			
			// 1.3 ASET TETAP
		$sql_12 = "	select '1.3' reff, 'ASET TETAP' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,2)='13' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 1.3 Uraian ASET TETAP
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Aset tetap adalah aset berwujud yang mempunyai masa manfaat lebih dari 12 bulan untuk digunakan, atau dimaksudkan untuk digunakan, dalam kegiatan pemerintahan daerah atau dimanfaatkan oleh masyarakat umum. Rincian dan perbandingan saldo Aset Tetap per 31 Desember $thn dan per 31 Desember $cthnsbl terdiri dari :<br></td>                         
						</tr>";
		
		// 1.3 Rincian ASET TETAP
		$sql_12 = "	select '1.3.1' reff, 'Tanah' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='131' and a.kd_unit='$kd_skpd'
					union all
					select '1.3.2' reff, 'Peralatan dan Mesin' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='132' and a.kd_unit='$kd_skpd'
					union all
					select '1.3.3' reff, 'Gedung dan Bangunan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='133' and a.kd_unit='$kd_skpd'
					union all
					select '1.3.4' reff, 'Jalan, Irigasi dan Jaringan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='134' and a.kd_unit='$kd_skpd'
					union all
					select '1.3.5' reff, 'Aset Tetap Lainnya' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='135' and a.kd_unit='$kd_skpd'
					union all
					select '1.3.6' reff, 'Konstruksi Dalam Pengerjaan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='136' and a.kd_unit='$kd_skpd'
					union all
					select '1.3.7' reff, 'Akumulasi Penyusutan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='137' and a.kd_unit='$kd_skpd'
					union all
					select '' reff, 'Jumlah Aset Tetap' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,2)='13' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				if($reff==''){
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$a$real_sal$b</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\"></td>                         
							 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
				}
			}
			
			// 1.3.1 Tanah
		$sql_12 = "	select '1.3.1' reff, 'Tanah' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='131' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
	
		// 1.3.1 Tanah
		$sql_12 = "	SELECT x.*,  z.ket FROM (select '1' reff, 'Aset Tetap Tanah Per 31 Desember $cthnsbl' uraian, 
					isnull(sum(sal_awal),0) sal
					from lamp_aset where kd_rek3='131' and kd_skpd='$kd_skpd'
					union all
					select '2' reff, 'Mutasi Bertambah' uraian, 
					isnull(sum(tambah),0) sal
					from lamp_aset where kd_rek3='131' and kd_skpd='$kd_skpd'
					union all
					select '3' reff, 'Mutasi Berkurang' uraian, 
					isnull(sum(kurang),0) sal
					from lamp_aset where kd_rek3='131' and kd_skpd='$kd_skpd'
					union all
					select '4' reff, 'Pengadaan Tahun Anggaran $thn' uraian, 
					isnull(sum(tahun_n),0) sal
					from lamp_aset where kd_rek3='131' and kd_skpd='$kd_skpd'
					union all
					select '5' reff, 'Aset Tetap Tanah Per 31 Desember $thn' uraian, 
					isnull(sum(sal_awal+tambah-kurang+tahun_n),0) sal
					from lamp_aset where kd_rek3='131' and kd_skpd='$kd_skpd')x 
					LEFT JOIN
					(select '2' as reff, ket from isi_neraca_calk where kd_rek='1312' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '3' as reff, ket from isi_neraca_calk where kd_rek='1313' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '4' as reff, ket from isi_neraca_calk where kd_rek='1314' and kd_skpd='$kd_skpd') z
					on x.reff=z.reff";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff    = $rowsc->reff;
			$uraian  = $rowsc->uraian;
			$sal     = $rowsc->sal;
			$ket     = $rowsc->ket;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
				if($reff=='1' || $reff=='4'|| $reff=='5'){
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
						</tr>";
				}else if($reff=='2'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
							
					$sql_1312 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1312' order by kd_rek,kd_rinci";
					$sql_1312_r=$this->db->query($sql_1312);
					
					foreach ($sql_1312_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1312
							</td>                         
						</tr>";
				}else if($reff=='3'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
					
					$sql_1313 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1313'";
					$sql_1313_r=$this->db->query($sql_1313);
					
					
					foreach ($sql_1313_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1313
							</td>                         
						</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>
							<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>";
							
				} 
				
			}
			
			// 1.3.2 Peralatan dan Mesin
		$sql_12 = "	select '1.3.2' reff, 'Peralatan dan Mesin' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='132' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
	
		// 1.3.2 Peralatan dan Mesin
		$sql_12 = "	SELECT x.*,  z.ket FROM (select '1' reff, 'Aset Tetap Peralatan dan Mesin Per 31 Desember $cthnsbl' uraian, 
					isnull(sum(sal_awal),0) sal
					from lamp_aset where kd_rek3='132' and kd_skpd='$kd_skpd'
					union all
					select '2' reff, 'Mutasi Bertambah' uraian, 
					isnull(sum(tambah),0) sal
					from lamp_aset where kd_rek3='132' and kd_skpd='$kd_skpd'
					union all
					select '3' reff, 'Mutasi Berkurang' uraian, 
					isnull(sum(kurang),0) sal
					from lamp_aset where kd_rek3='132' and kd_skpd='$kd_skpd'
					union all
					select '4' reff, 'Pengadaan Tahun Anggaran $thn' uraian, 
					isnull(sum(tahun_n),0) sal
					from lamp_aset where kd_rek3='132' and kd_skpd='$kd_skpd'
					union all
					select '5' reff, 'Aset Tetap Peralatan dan Mesin Per 31 Desember $thn' uraian, 
					isnull(sum(sal_awal+tambah-kurang+tahun_n),0) sal
					from lamp_aset where kd_rek3='132' and kd_skpd='$kd_skpd')x 
					LEFT JOIN
					(select '2' as reff, ket from isi_neraca_calk where kd_rek='1322' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '3' as reff, ket from isi_neraca_calk where kd_rek='1323' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '4' as reff, ket from isi_neraca_calk where kd_rek='1324' and kd_skpd='$kd_skpd') z
					on x.reff=z.reff";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$ket     = $rowsc->ket;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				if($reff=='1' || $reff=='4' || $reff=='5'){
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
						</tr>";
				}else if($reff=='2'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
							
					$sql_1312 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1322'";
					$sql_1312_r=$this->db->query($sql_1312);
					
					foreach ($sql_1312_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1322
							</td>                         
						</tr>";
				}else if($reff=='3'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
					
					$sql_1313 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1323'";
					$sql_1313_r=$this->db->query($sql_1313);
					
					
					foreach ($sql_1313_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1323
							</td>                         
						</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>
							<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>";							
				} 
				
			}
			
			// 1.3.3 Gedung dan Bangunan
		$sql_12 = "	select '1.3.3' reff, 'Gedung dan Bangunan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='133' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
	
		// 1.3.3 Gedung dan Bangunan
		$sql_12 = "	SELECT x.*,  z.ket FROM (select '1' reff, 'Aset Tetap Gedung dan Bangunan Per 31 Desember $cthnsbl' uraian, 
					isnull(sum(sal_awal),0) sal
					from lamp_aset where kd_rek3='133' and kd_skpd='$kd_skpd'
					union all
					select '2' reff, 'Mutasi Bertambah' uraian, 
					isnull(sum(tambah),0) sal
					from lamp_aset where kd_rek3='133' and kd_skpd='$kd_skpd'
					union all
					select '3' reff, 'Mutasi Berkurang' uraian, 
					isnull(sum(kurang),0) sal
					from lamp_aset where kd_rek3='133' and kd_skpd='$kd_skpd'
					union all
					select '4' reff, 'Pengadaan Tahun Anggaran $thn' uraian, 
					isnull(sum(tahun_n),0) sal
					from lamp_aset where kd_rek3='133' and kd_skpd='$kd_skpd'
					union all
					select '5' reff, 'Aset Tetap Gedung dan Bangunan Per 31 Desember $thn' uraian, 
					isnull(sum(sal_awal+tambah-kurang+tahun_n),0) sal
					from lamp_aset where kd_rek3='133' and kd_skpd='$kd_skpd')x 
					LEFT JOIN
					(select '2' as reff, ket from isi_neraca_calk where kd_rek='1332' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '3' as reff, ket from isi_neraca_calk where kd_rek='1333' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '4' as reff, ket from isi_neraca_calk where kd_rek='1334' and kd_skpd='$kd_skpd') z
					on x.reff=z.reff";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$ket     = $rowsc->ket;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				if($reff=='1' || $reff=='4' || $reff=='5'){
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
						</tr>";
				}else if($reff=='2'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
							
					$sql_1312 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1332'";
					$sql_1312_r=$this->db->query($sql_1312);
					
					foreach ($sql_1312_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1332
							</td>                         
						</tr>";
				}else if($reff=='3'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
					
					$sql_1313 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1333'";
					$sql_1313_r=$this->db->query($sql_1313);
					
					
					foreach ($sql_1313_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1333
							</td>                         
						</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>
							<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>";
							
				} 
				
			}
			
			// 1.3.4 Jalan, Irigasi dan Jaringan
		$sql_12 = "	select '1.3.4' reff, 'Jalan, Irigasi dan Jaringan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='134' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
	
		// 1.3.4 Jalan, Irigasi dan Jaringan
		$sql_12 = "	SELECT x.*,  z.ket FROM (select '1' reff, 'Aset Tetap Jalan, Irigasi dan Jaringan Per 31 Desember $cthnsbl' uraian, 
					isnull(sum(sal_awal),0) sal
					from lamp_aset where kd_rek3='134' and kd_skpd='$kd_skpd'
					union all
					select '2' reff, 'Mutasi Bertambah' uraian, 
					isnull(sum(tambah),0) sal
					from lamp_aset where kd_rek3='134' and kd_skpd='$kd_skpd'
					union all
					select '3' reff, 'Mutasi Berkurang' uraian, 
					isnull(sum(kurang),0) sal
					from lamp_aset where kd_rek3='134' and kd_skpd='$kd_skpd'
					union all
					select '4' reff, 'Pengadaan Tahun Anggaran $thn' uraian, 
					isnull(sum(tahun_n),0) sal
					from lamp_aset where kd_rek3='134' and kd_skpd='$kd_skpd'
					union all
					select '5' reff, 'Aset Tetap Jalan, Irigasi dan Jaringan Per 31 Desember $thn' uraian, 
					isnull(sum(sal_awal+tambah-kurang+tahun_n),0) sal
					from lamp_aset where kd_rek3='134' and kd_skpd='$kd_skpd')x 
					LEFT JOIN
					(select '2' as reff, ket from isi_neraca_calk where kd_rek='1342' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '3' as reff, ket from isi_neraca_calk where kd_rek='1343' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '4' as reff, ket from isi_neraca_calk where kd_rek='1344' and kd_skpd='$kd_skpd') z
					on x.reff=z.reff";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$ket     = $rowsc->ket;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				if($reff=='1' || $reff=='4'  || $reff=='5'){
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
						</tr>";
				}else if($reff=='2'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
							
					$sql_1312 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1342'";
					$sql_1312_r=$this->db->query($sql_1312);
					
					foreach ($sql_1312_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1342
							</td>                         
						</tr>";
				}else if($reff=='3'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
					
					$sql_1313 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1343'";
					$sql_1313_r=$this->db->query($sql_1313);
					
					
					foreach ($sql_1313_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1343
							</td>                         
						</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>
							<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>";
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_134
							</td>                         
						</tr>";
							
				} 
				
			}
			
			// 1.3.5 Aset Tetap Lainnya
		$sql_12 = "	select '1.3.5' reff, 'Aset Tetap Lainnya' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='135' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
	
		// 1.3.5 Aset Tetap Lainnya
		$sql_12 = "	SELECT x.*,  z.ket FROM (select '1' reff, 'Aset Tetap Lainnya Per 31 Desember $cthnsbl' uraian, 
					isnull(sum(sal_awal),0) sal
					from lamp_aset where kd_rek3='135' and kd_skpd='$kd_skpd'
					union all
					select '2' reff, 'Mutasi Bertambah' uraian, 
					isnull(sum(tambah),0) sal
					from lamp_aset where kd_rek3='135' and kd_skpd='$kd_skpd'
					union all
					select '3' reff, 'Mutasi Berkurang' uraian, 
					isnull(sum(kurang),0) sal
					from lamp_aset where kd_rek3='135' and kd_skpd='$kd_skpd'
					union all
					select '4' reff, 'Pengadaan Tahun Anggaran $thn' uraian, 
					isnull(sum(tahun_n),0) sal
					from lamp_aset where kd_rek3='135' and kd_skpd='$kd_skpd'
					union all
					select '5' reff, 'Aset Tetap Lainnya Per 31 Desember $thn' uraian, 
					isnull(sum(sal_awal+tambah-kurang+tahun_n),0) sal
					from lamp_aset where kd_rek3='135' and kd_skpd='$kd_skpd')x 
					LEFT JOIN
					(select '2' as reff, ket from isi_neraca_calk where kd_rek='1352' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '3' as reff, ket from isi_neraca_calk where kd_rek='1353' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '4' as reff, ket from isi_neraca_calk where kd_rek='1354' and kd_skpd='$kd_skpd') z
					on x.reff=z.reff";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$ket     = $rowsc->ket;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				if($reff=='1' || $reff=='4'  || $reff=='5'){
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
						</tr>";
				}else if($reff=='2'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
							
					$sql_1312 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1352'";
					$sql_1312_r=$this->db->query($sql_1312);
					
					foreach ($sql_1312_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1352
							</td>                         
						</tr>";
				}else if($reff=='3'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
					
					$sql_1313 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1353'";
					$sql_1313_r=$this->db->query($sql_1313);
					
					
					foreach ($sql_1313_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1353
							</td>                         
						</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>
							<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>";
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_135
							</td>                         
						</tr>";
							
				} 
				
			}
			
			// 1.3.6 Kontruksi Dalam Pengerjaan
		$sql_12 = "	select '1.3.6' reff, 'Kontruksi Dalam Pengerjaan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='136' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
	
		// 1.3.6 Kontruksi Dalam Pengerjaan
		$sql_12 = "	SELECT x.*,  z.ket FROM (select '1' reff, 'Aset Tetap Kontruksi Dalam Pengerjaan Per 31 Desember $cthnsbl' uraian, 
					isnull(sum(sal_awal),0) sal
					from lamp_aset where kd_rek3='136' and kd_skpd='$kd_skpd'
					union all
					select '2' reff, 'Mutasi Bertambah' uraian, 
					isnull(sum(tambah),0) sal
					from lamp_aset where kd_rek3='136' and kd_skpd='$kd_skpd'
					union all
					select '3' reff, 'Mutasi Berkurang' uraian, 
					isnull(sum(kurang),0) sal
					from lamp_aset where kd_rek3='136' and kd_skpd='$kd_skpd'
					union all
					select '4' reff, 'Pengadaan Tahun Anggaran $thn' uraian, 
					isnull(sum(tahun_n),0) sal
					from lamp_aset where kd_rek3='136' and kd_skpd='$kd_skpd'
					union all
					select '5' reff, 'Aset Tetap Kontruksi Dalam Pengerjaan Per 31 Desember $thn' uraian, 
					isnull(sum(sal_awal+tambah-kurang+tahun_n),0) sal
					from lamp_aset where kd_rek3='136' and kd_skpd='$kd_skpd')x 
					LEFT JOIN
					(select '2' as reff, ket from isi_neraca_calk where kd_rek='1362' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '3' as reff, ket from isi_neraca_calk where kd_rek='1363' and kd_skpd='$kd_skpd'
					 UNION ALL
					 select '4' as reff, ket from isi_neraca_calk where kd_rek='1364' and kd_skpd='$kd_skpd') z
					on x.reff=z.reff";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$ket    = $rowsc->ket;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				if($reff=='1' || $reff=='4'  || $reff=='5'){
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
						</tr>";
				}else if($reff=='2'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
							
					$sql_1312 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1362'";
					$sql_1312_r=$this->db->query($sql_1312);
					
					foreach ($sql_1312_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1362
							</td>                         
						</tr>";
				}else if($reff=='3'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>";
					
					$sql_1313 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1363'";
					$sql_1313_r=$this->db->query($sql_1313);
					
					
					foreach ($sql_1313_r->result() as $rowsc){
						$kd_skpd    = $rowsc->kd_skpd;
						$kd_rek  = $rowsc->kd_rek;
						$ket     = $rowsc->ket;
						$nilai     = $rowsc->nilai;
						$nil       = number_format($nilai,"2",",",".");
						$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\" $bg_color>$nil</td>
								 <td align=\"right\"></td>
							</tr>";
					}
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1363
							</td>                         
						</tr>";
				}else{
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
							</tr>
							<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>";
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_136
							</td>                         
						</tr>";
							
				} 
				
			}
			
			// 1.3.7 Akumulasi Penyusutan
		$sql_12 = "	select '1.3.7' reff, 'Akumulasi Penyusutan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='137' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
		
			// 1.3.7 Uraian Akumulasi Penyusutan
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Akumulasi Penyusutan adalah Penyajian kembali nilai buku aset tetap terdiri dari Akumulasi Penyusutan Peralatan dan Mesin, Akumulasi Penyusutan Gedung dan Bangunan dan Akumulasi Penyusutan Jalan, Irigasi, dan jaringan, rincian penjelasan sebagai berikut :<br></td>                         
						</tr>";
		
		// 1.3.7 Rincian Akumulasi Penyusutan Peralatan dan Mesin
		$sql_12 = "	select '1' reff, 'Akumulasi Penyusutan Peralatan dan Mesin' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='13701' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
		
		// 1.3.7 Rincian Uraian Akumulasi Penyusutan Peralatan dan Mesin
		$sql_12 = "	select '-' reff, 'Per 31 Desember $cthnsbl' uraian, 
					sum(akum_penyuk) sal from (select a.*, case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when status in ('9','10') then akum_penyub else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu, case when len(tahun)<>4 then 0 when a.usia>=a.masa then 0 when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when a.masa-a.usia=1 then (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)-(case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when status in ('9','10') then akum_penyub else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end) else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu_n
					from(SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  merk, no_polisi, jumlah,  satuan, harga_satuan, sal_awal, kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, (select masa from ms_penyu where kd_rek4=LEFT(kd_rek5,5)) masa, 
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(akum_penyu,0) akum_penyuk, isnull(akum_penyub,0) akum_penyub, status FROM lamp_aset where kd_rek3 = '132' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Koreksi' uraian, 
					sum(akum_penyu-akum_penyuk) sal from (select a.*, case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when status in ('9','10') then akum_penyub else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu, case when len(tahun)<>4 then 0 when a.usia>=a.masa then 0 when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when a.masa-a.usia=1 then (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)-(case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when status in ('9','10') then akum_penyub else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end) else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu_n
					from(SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  merk, no_polisi, jumlah,  satuan, harga_satuan, sal_awal, kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, (select masa from ms_penyu where kd_rek4=LEFT(kd_rek5,5)) masa, 
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(akum_penyu,0) akum_penyuk, isnull(akum_penyub,0) akum_penyub, status FROM lamp_aset where kd_rek3 = '132' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Setelah Koreksi' uraian, 
					sum(akum_penyu) sal from (select a.*, case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when status in ('9','10') then akum_penyub else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu, case when len(tahun)<>4 then 0 when a.usia>=a.masa then 0 when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when a.masa-a.usia=1 then (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)-(case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when status in ('9','10') then akum_penyub else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end) else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu_n
					from(SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  merk, no_polisi, jumlah,  satuan, harga_satuan, sal_awal, kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, (select masa from ms_penyu where kd_rek4=LEFT(kd_rek5,5)) masa, 
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(akum_penyu,0) akum_penyuk, isnull(akum_penyub,0) akum_penyub, status FROM lamp_aset where kd_rek3 = '132' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Penyusutan tahun $thn' uraian, 
					sum(akum_penyu_n) sal from (select a.*, case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when status in ('9','10') then akum_penyub when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu, case when len(tahun)<>4 then 0 when a.usia>=a.masa then 0 when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when a.masa-a.usia=1 then (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)-(case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when status in ('9','10') then akum_penyub when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end) else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu_n
						from(SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  merk, no_polisi, jumlah,  satuan, harga_satuan, sal_awal, kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, (select masa from ms_penyu where kd_rek4=LEFT(kd_rek5,5)) masa, 
						case when len(tahun)<>4 then 0 else 2018-tahun end as usia, isnull(akum_penyu,0) akum_penyuk, isnull(akum_penyub,0) akum_penyub, status FROM lamp_aset where kd_rek3 = '132' and kd_skpd = '1.07.01.01') a) a
					union all
					select '-' reff, 'Per 31 Desember $thn' uraian, 
					sum(akum_penyu+akum_penyu_n) sal from (select a.*, case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when status in ('9','10') then akum_penyub else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu, case when len(tahun)<>4 then 0 when a.usia>=a.masa then 0 when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when a.masa-a.usia=1 then (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)-(case when len(tahun)<>4 then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when a.usia>=a.masa then cast(a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi as decimal(20,0)) when sal_awal=sal_awal+tambah-kurang+tahun_n+koreksi then akum_penyuk when a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi=0 then 0 when status in ('9','10') then akum_penyub else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa*(a.usia-1) as decimal(20,0))+cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end) else cast((a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi)/a.masa as decimal(20,0)) end as akum_penyu_n
					from(SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  merk, no_polisi, jumlah,  satuan, harga_satuan, sal_awal, kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, (select masa from ms_penyu where kd_rek4=LEFT(kd_rek5,5)) masa, 
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(akum_penyu,0) akum_penyuk, isnull(akum_penyub,0) akum_penyub, status FROM lamp_aset where kd_rek3 = '132' and kd_skpd = '$kd_skpd') a) a
					";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
						</tr>";
			}
			
			// 1.3.7 Rincian Akumulasi Penyusutan Gedung dan Bangunan
		$sql_12 = "	select '2' reff, 'Akumulasi Penyusutan Gedung dan Bangunan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='13702' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
			
			// 1.3.7 Rincian Uraian Akumulasi Penyusutan Gedung dan Bangunan
		$sql_12 = "	select '-' reff, 'Per 31 Desember $cthnsbl' uraian, 
					sum(akum_penyuk) as sal from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
					from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
					case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end masa,
					case when (case when tmasa<>0 and kd_rek3='133' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
					else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end)
					+sisa_umur>=(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then (case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)-sisa_umur else (case when tmasa<>0 and kd_rek3='133' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
					else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end) end tmasa,
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
					case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $thn-tahun>=(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($thn-tahun)>(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then tambah else tambah/(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)*($thn-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($thn-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu FROM lamp_aset where kd_rek3 = '133' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Koreksi' uraian, 
					sum(akum_penyu-akum_penyuk) as sal from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
					from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
					case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end masa,
					case when (case when tmasa<>0 and kd_rek3='133' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
					else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end)
					+sisa_umur>=(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then (case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)-sisa_umur else (case when tmasa<>0 and kd_rek3='133' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
					else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end) end tmasa,
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
					case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $thn-tahun>=(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($thn-tahun)>(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then tambah else tambah/(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)*($thn-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($thn-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu FROM lamp_aset where kd_rek3 = '133' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Setelah Koreksi' uraian, 
					sum(akum_penyu) sal from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
					from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
					case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end masa,
					case when (case when tmasa<>0 and kd_rek3='133' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
					else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end)
					+sisa_umur>=(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then (case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)-sisa_umur else (case when tmasa<>0 and kd_rek3='133' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
					else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end) end tmasa,
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
					case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $thn-tahun>=(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($thn-tahun)>(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then tambah else tambah/(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)*($thn-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($thn-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu FROM lamp_aset where kd_rek3 = '133' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Penyusutan tahun $thn' uraian, 
					sum(akum_penyu_n) as sal from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
					from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
					case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end masa,
					case when (case when tmasa<>0 and kd_rek3='133' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
					else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end)
					+sisa_umur>=(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then (case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)-sisa_umur else (case when tmasa<>0 and kd_rek3='133' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
					else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end) end tmasa,
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
					case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $thn-tahun>=(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($thn-tahun)>(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then tambah else tambah/(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)*($thn-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($thn-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu FROM lamp_aset where kd_rek3 = '133' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Per 31 Desember $thn' uraian, 
					sum(akum_penyu+akum_penyu_n) as sal from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
					from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
					case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end masa,
					case when (case when tmasa<>0 and kd_rek3='133' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
					else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end)
					+sisa_umur>=(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then (case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)-sisa_umur else (case when tmasa<>0 and kd_rek3='133' then (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek3=tmasa) 
					else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end) end tmasa,
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
					case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $thn-tahun>=(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($thn-tahun)>(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) then tambah else tambah/(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end)*($thn-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($thn-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(case when tmasa<>0 and kd_rek3='133' then (select masa from ms_penyu where kd_rek3=tmasa) else (select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) end) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu FROM lamp_aset where kd_rek3 = '133' and kd_skpd = '$kd_skpd') a) a
					";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
						</tr>";
			}
			
			// 1.3.7 Rincian Akumulasi Penyusutan Jalan, Irigasi dan Jaringan
		$sql_12 = "	select '3' reff, 'Akumulasi Penyusutan Jalan, Irigasi dan Jaringan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='13703' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
			
			// 1.3.7 Rincian Uraian Akumulasi Penyusutan Jalan, Irigasi dan Jaringan
		$sql_12 = "	select '-' reff, 'Per 31 Desember $cthnsbl' uraian, 
					sum(akum_penyuk) sal from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
					from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
					(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) masa,
					case when (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5))
					+sisa_umur>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then (select masa from ms_penyu where kd_rek4=left(kd_rek5,5))-sisa_umur else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end tmasa,
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
					case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $thn-tahun>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($thn-tahun)>(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then tambah else tambah/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5))*($thn-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($thn-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu FROM lamp_aset where kd_rek3 = '134' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Koreksi' uraian, 
					sum(akum_penyu-akum_penyuk) sal from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
					from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
					(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) masa,
					case when (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5))
					+sisa_umur>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then (select masa from ms_penyu where kd_rek4=left(kd_rek5,5))-sisa_umur else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end tmasa,
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
					case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $thn-tahun>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($thn-tahun)>(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then tambah else tambah/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5))*($thn-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($thn-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu FROM lamp_aset where kd_rek3 = '134' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Setelah Koreksi' uraian, 
					sum(akum_penyu) sal from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
					from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
					(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) masa,
					case when (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5))
					+sisa_umur>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then (select masa from ms_penyu where kd_rek4=left(kd_rek5,5))-sisa_umur else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end tmasa,
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
					case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $thn-tahun>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($thn-tahun)>(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then tambah else tambah/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5))*($thn-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($thn-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu FROM lamp_aset where kd_rek3 = '134' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Penyusutan tahun $thn' uraian, 
					sum(akum_penyu_n) sal from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
					from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
					(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) masa,
					case when (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5))
					+sisa_umur>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then (select masa from ms_penyu where kd_rek4=left(kd_rek5,5))-sisa_umur else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end tmasa,
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
					case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $thn-tahun>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($thn-tahun)>(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then tambah else tambah/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5))*($thn-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($thn-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu FROM lamp_aset where kd_rek3 = '134' and kd_skpd = '$kd_skpd') a) a
					union all
					select '-' reff, 'Per 31 Desember $thn' uraian, 
					sum(akum_penyu+akum_penyu_n) sal from (select a.*, case when len(tahun)<>4 then 0 when sisa_umur+tmasa<=0 and tahun_n+koreksi<>0 then a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu when sisa_umur+tmasa<=0 and tahun_n+koreksi=0 then 0 when (a.sal_awal-a.kurang+a.tambah+tahun_n+koreksi-akum_penyu)<=0 then 0 else cast(((a.sal_awal+a.tambah-a.kurang+tahun_n+koreksi)-akum_penyu)/(sisa_umur+tmasa) as decimal(20,0)) end as akum_penyu_n
					from (SELECT no_lamp, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode1, case when (kd_rek6='') then kd_rek5 else kd_rek6 end as kode, case when (nm_rek6='') then nm_rek5 else nm_rek6 end as nama, tahun,  lokasi, alamat,  fungsi, luas,  satuan, sal_awal,  kurang,  tambah, tahun_n, isnull(korplus,0)-isnull(kormin,0) koreksi, kondisi_b,  kondisi_rr,  kondisi_rb,  keterangan, 
					(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) masa,
					case when (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5))
					+sisa_umur>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then (select masa from ms_penyu where kd_rek4=left(kd_rek5,5))-sisa_umur else (select case when sal_awal=0 then 0 when ((tahun_n+tambah)/sal_awal)>0 and ((tahun_n+tambah)/sal_awal)<=p1 then m1 when ((tahun_n+tambah)/sal_awal)>p1 and ((tahun_n+tambah)/sal_awal)<=p2 then m2 when ((tahun_n+tambah)/sal_awal)>p2 and ((tahun_n+tambah)/sal_awal)<=p3 then m3 when ((tahun_n+tambah)/sal_awal)>p3 and ((tahun_n+tambah)/sal_awal)<=p4 then m4 when ((tahun_n+tambah)/sal_awal)>p4 and ((tahun_n+tambah)/sal_awal)<=p5 then m5 when ((tahun_n+tambah)/sal_awal)>p5 then m5 else 0 end from ms_penyu where kd_rek4=left(kd_rek5,5)) end tmasa,
					case when len(tahun)<>4 then 0 else $thn-tahun end as usia, isnull(sisa_umur,masa) sisa_umur, isnull(akum_penyu,0) akum_penyuk, 
					case when len(tahun)<>4 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when status in ('9','10') then isnull(akum_penyub,0) when sisa_umur<=0 and tahun_n+korplus-kormin=0 then cast(sal_awal-kurang+tambah+tahun_n-kormin+korplus as decimal(20,0)) when sal_awal=sal_awal-kurang+tambah+tahun_n-kormin+korplus then akum_penyu when sal_awal-kurang+tambah+tahun_n-kormin+korplus=0 then 0 when $thn-tahun>=(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) and sal_awal=0 then sal_awal-kurang+tambah+tahun_n-kormin+korplus when (sal_awal-kurang+tambah+tahun_n-kormin+korplus)<sal_awal then cast((isnull(akum_penyu,0))*((sal_awal-kurang+tambah+tahun_n-kormin+korplus)/sal_awal) as decimal(20,0)) when sal_awal>0 and tambah>0 then akum_penyu+(case when ($thn-tahun)>(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) then tambah else tambah/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5))*($thn-tahun) end) when sal_awal=0 and tahun_n=0 then cast(($thn-tahun)*(sal_awal-kurang+tambah+tahun_n-kormin+korplus)/(select masa from ms_penyu where kd_rek4=left(kd_rek5,5)) as decimal(20,0)) else isnull(akum_penyu,0) end as akum_penyu FROM lamp_aset where kd_rek3 = '134' and kd_skpd = '$kd_skpd') a) a
					";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\"></td>
						</tr>";
			}
			
			// 1.4 ASET LAINNYA
		$sql_12 = "	select '1.4' reff, 'ASET LAINNYA' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,2)='15' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 1.4 Uraian ASET LAINNYA
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Rincian dan perbandingan saldo Aset Lainnya per 31 Desember $thn dan per 31 Desember $cthnsbl terdiri dari :<br></td>                         
						</tr>";
		
		// 1.4 Rincian ASET LAINNYA
		$sql_12 = "	select '1.4.1' reff, 'Tagihan Jangka Panjang' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='151' and a.kd_unit='$kd_skpd'
					union all
					select '1.4.2' reff, 'Kemitraan dengan Pihak Ketiga' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='152' and a.kd_unit='$kd_skpd'
					union all
					select '1.4.3' reff, 'Aset Tidak Berwujud' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='153' and a.kd_unit='$kd_skpd'
					union all
					select '1.4.4' reff, 'Aset Lain-lain' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='154' and a.kd_unit='$kd_skpd'
					union all
					select '' reff, 'Jumlah Aset Lainnya' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,2)='15' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				if($reff==''){
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$a$real_sal$b</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}else{
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td align=\"right\">$a$real_sal$b</td>
								 <td align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}
			}
			
			// 1.4.1 Tagihan Jangka Panjang
		$sql_12 = "	select '1.4.1' reff, 'Tagihan Jangka Panjang' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='151' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 1.4.1 Uraian Tagihan Jangka Panjang
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Tagihan Jangka Panjang terdiri dari tagihan penjualan angsuran dan tuntutan ganti kerugian daerah<br></td>                         
						</tr>";
		
		// 1.4.1 Rincian Tagihan Jangka Panjang
		$sql_12 = "	SELECT x.*,  z.ket FROM (select '1' reff, 'Tagihan Penjualan Angsuran' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='15101' and a.kd_unit='$kd_skpd'
					union all
					select '2' reff, 'Tuntutan Ganti Kerugian Daerah' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='15102' and a.kd_unit='$kd_skpd') x
					LEFT JOIN
										(
					select '1' as reff, ket from isi_neraca_calk where kd_rek='1411' and kd_skpd='$kd_skpd'
					UNION ALL
					select '2' as reff, ket from isi_neraca_calk where kd_rek='1412' and kd_skpd='$kd_skpd') z
										on x.reff=z.reff
										";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			$ket   = $rowsc->ket;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>
						<!--<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>-->
						";
			}
				/* $cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_141
							</td>                         
						</tr>"; */
			
			// 1.4.2 Kemitraan dengan Pihak Ketiga
		$sql_12 = "	select '1.4.2' reff, 'Kemitraan dengan Pihak Ketiga' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='152' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 1.4.2 Uraian Kemitraan dengan Pihak Ketiga
				$cRet.= "<tr>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"left\"><strong>&nbsp;</strong></td>
							<td align=\"justify\" colspan=\"5\">Kemitraan dengan Pihak Ketiga terdiri dari sewa, kerjasama pemanfaatan, bangun guna serah dan bangun serah guna<br></td>                         
						</tr>";
		
		// 1.4.2 Rincian Kemitraan dengan Pihak Ketiga
		// 1421
		$sql_12 = "	SELECT x.* FROM (select '1' reff, 'Sewa' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='15201' and a.kd_unit='$kd_skpd'
					) x";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
			$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
			
			$sql_12 = "	Select '1' as reff, ket from isi_neraca_calk where LEFT(kd_rek,4)='1421' and kd_skpd='$kd_skpd'";
			$sql_122=$this->db->query($sql_12);
			foreach ($sql_122->result() as $rowsc){
				$ket   = $rowsc->ket;
				$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>";
			}
		
		
		$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1421
							</td>                         
						</tr>";
			
		// 1422
		$sql_12 = "	SELECT x.* FROM (
					select '2' reff, 'Kerjasama Pemanfaatan' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='15202' and a.kd_unit='$kd_skpd'
					) x";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
			$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
		}
		
		$sql_12 = "	Select '2' as reff, ket from isi_neraca_calk where LEFT(kd_rek,4)='1422' and kd_skpd='$kd_skpd'";
			$sql_122=$this->db->query($sql_12);
			foreach ($sql_122->result() as $rowsc){
				$ket   = $rowsc->ket;
				$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>";
			}
		
		$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1422
							</td>                         
						</tr>";

		// 1423
		$sql_12 = "	SELECT x.* FROM (
					select '3' reff, 'Bangun Guna Serah' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='15203' and a.kd_unit='$kd_skpd'
					) x";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
			$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
				
		}
		
		$sql_12 = "	Select '3' as reff, ket from isi_neraca_calk where LEFT(kd_rek,4)='1423' and kd_skpd='$kd_skpd'";
			$sql_122=$this->db->query($sql_12);
			foreach ($sql_122->result() as $rowsc){
				$ket   = $rowsc->ket;
				$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>";
			}
		
		$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1423
							</td>                         
						</tr>";
		
		// 1424
		$sql_12 = "	SELECT x.* FROM (
					select '4' reff, 'Bangun Serah Guna' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='15204' and a.kd_unit='$kd_skpd') x";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
			$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
		}
		
		$sql_12 = "	Select '4' as reff, ket from isi_neraca_calk where LEFT(kd_rek,4)='1424' and kd_skpd='$kd_skpd'";
			$sql_122=$this->db->query($sql_12);
			foreach ($sql_122->result() as $rowsc){
				$ket   = $rowsc->ket;
				$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td valign=\"top\" align=\"right\"></td>                         
								 <td colspan =\"3\" align=\"left\" $bg_color>$ket</td>
								 <td align=\"right\"></td>
								 <td align=\"right\"></td>
							</tr>";
			}
		
		$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_1424
							</td>                         
						</tr>";	
			
			// 1.4.3 Aset Tidak Berwujud
		$sql_12 = "	select '1.4.3' reff, 'Aset Tidak Berwujud' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='153' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
		// 1.4.3 Rincian Aset Tidak Berwujud Lainnya
		$sql_12 = "	select '1' reff, 'Aset Tidak Berwujud Lainnya' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5) in ('15301','15302','15303','15304','15305') and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
			
			// 1.4.3 Aset Tidak Berwujud Lainnya
		$sql_12 = "	select '-' reff, '1' jns, 'Aset Tidak Berwujud Lainnya Per 31 Desember $cthnsbl' uraian, 
					isnull(sum(sal_awal),0) sal
					from lamp_aset where left(kd_rek5,5) in ('15301','15302','15303','15304','15305') and kd_skpd='$kd_skpd'
					union all
					select '-' reff, '2' jns, 'Mutasi Bertambah' uraian, 
					isnull(sum(tambah),0) sal
					from lamp_aset where left(kd_rek5,5) in ('15301','15302','15303','15304','15305') and kd_skpd='$kd_skpd'
					union all
					select '-' reff, '3' jns, 'Mutasi Berkurang' uraian, 
					isnull(sum(kurang),0) sal
					from lamp_aset where left(kd_rek5,5) in ('15301','15302','15303','15304','15305') and kd_skpd='$kd_skpd'
					union all
					select '-' reff, '1' jns, 'Pengadaan Tahun Anggaran $thn' uraian, 
					isnull(sum(tahun_n),0) sal
					from lamp_aset where left(kd_rek5,5) in ('15301','15302','15303','15304','15305') and kd_skpd='$kd_skpd'
					union all
					select '-' reff, '1' jns, 'Aset Tidak Berwujud Lainnya Per 31 Desember $thn' uraian, 
					isnull(sum(sal_awal+tambah-kurang+tahun_n),0) sal
					from lamp_aset where left(kd_rek5,5) in ('15301','15302','15303','15304','15305') and kd_skpd='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$jns          = $rowsc->jns;
			$uraian       = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				if($jns=='1'){
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"right\">$reff</td>                         
								 <td colspan =\"3\" align=\"left\">$uraian</td>
								 <td align=\"right\">$a$real_sal$b</td>
								 <td align=\"right\"></td>
							</tr>";
				}else{
					if($jns=='2'){
					
					
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"right\">$reff</td>                         
								 <td colspan =\"3\" align=\"left\">$uraian</td>
								 <td align=\"right\">$a$real_sal$b</td>
								 <td align=\"right\"></td>
							</tr>";
					
					$sql_1432 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1432'";
					$sql_1432_r=$this->db->query($sql_1432);
					
					
					foreach ($sql_1432_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}		
					
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_1432
							</td>                         
						</tr>";
						
					}else{
					
					
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"right\">$reff</td>                         
								 <td colspan =\"3\" align=\"left\">$uraian</td>
								 <td align=\"right\">$a$real_sal$b</td>
								 <td align=\"right\"></td>
							</tr>";
							
					$sql_1432 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1433'";
					$sql_1432_r=$this->db->query($sql_1432);
					
					
					foreach ($sql_1432_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}

					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_1433
							</td>                         
						</tr>";
						
				}
							
				
				
				}
			}
			
			// 1.4.3 Rincian Akumulasi Amortisasi Aset Tidak Berwujud
		$sql_12 = "	select '2' reff, 'Akumulasi Amortisasi Aset Tidak Berwujud' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='15306' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td valign=\"top\" align=\"right\">$reff</td>                         
							 <td colspan =\"3\" align=\"left\">$uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
			}
			
			// 1.4.4 Aset Lain-lain
		$sql_12 = "	select '1.4.4' reff, 'Aset Lain-lain' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then debet-kredit else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,3)='154' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}

			
			// 1.4.4 Aset Lain-lain
		$sql_12 = "	select '1' reff, '1' jns, 'Aset Lain-lain Per 31 Desember $cthnsbl' uraian, 
					isnull(sum(sal_awal),0) sal
					from lamp_aset where kd_rek3='154' and kd_skpd='$kd_skpd'
					union all
					select '2' reff, '2' jns, 'Mutasi Bertambah' uraian, 
					isnull(sum(tambah),0) sal
					from lamp_aset where kd_rek3='154' and kd_skpd='$kd_skpd'
					union all
					select '3' reff, '3' jns, 'Mutasi Berkurang' uraian, 
					isnull(sum(kurang),0) sal
					from lamp_aset where kd_rek3='154' and kd_skpd='$kd_skpd'
					union all
					select '4' reff, '1' jns, 'Pengadaan Tahun Anggaran $thn' uraian, 
					isnull(sum(tahun_n),0) sal
					from lamp_aset where kd_rek3='154' and kd_skpd='$kd_skpd'
					union all
					select '5' reff, '1' jns, 'Aset Lain-lain Per 31 Desember $thn' uraian, 
					isnull(sum(sal_awal+tambah-kurang+tahun_n),0) sal
					from lamp_aset where kd_rek3='154' and kd_skpd='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$jns          = $rowsc->jns;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				if($jns=='1'){
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"right\">$reff</td>                         
								 <td colspan =\"3\" align=\"left\">$uraian</td>
								 <td align=\"right\">$a$real_sal$b</td>
								 <td align=\"right\"></td>
							</tr>";
				}else{
					if($jns=='2'){
					  
					
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"right\">$reff</td>                         
								 <td colspan =\"3\" align=\"left\">$uraian</td>
								 <td align=\"right\">$a$real_sal$b</td>
								 <td align=\"right\"></td>
							</tr>";
						
					$sql_1442 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1442'";
					$sql_1442_r=$this->db->query($sql_1442);
					
					
					foreach ($sql_1442_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}	
						
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_1442
							</td>                         
						</tr>";
						
					}else{
					
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"right\">$reff</td>                         
								 <td colspan =\"3\" align=\"left\">$uraian</td>
								 <td align=\"right\">$a$real_sal$b</td>
								 <td align=\"right\"></td>
							</tr>";
						
						
					$sql_1432 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,4)='1443'";
					$sql_1432_r=$this->db->query($sql_1432);
					
					
					foreach ($sql_1432_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}

					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_1443
							</td>                         
						</tr>";
						
				}
							
				}
			}
			
			// 2 KEWAJIBAN
		$sql_12 = "	select '2' reff, 'KEWAJIBAN' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,1)='2' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
							 <td align=\"right\"><strong>&nbsp;</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
		// 2.1 Utang Perhitungan Pihak Ketiga
		$sql_12 = "	select '2.1' reff, 'Utang Perhitungan Pihak Ketiga' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='211' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong></strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$reff $uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 2.1 Rincian Utang Perhitungan Pihak Ketiga
		$sql_12 = "	select '2.1.1' reff, 'Utang PPh Pusat' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='21103' and a.kd_unit='$kd_skpd'
					union all
					select '2.1.2' reff, 'Utang PPN Pusat' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='21104' and a.kd_unit='$kd_skpd'
					union all
					select '2.1.3' reff, 'Utang Perhitungan Pihak Ketiga Lainnya' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='21107' and a.kd_unit='$kd_skpd'
					";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
				if($reff=='2.1.1'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"center\"></td>                         
							 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
						
					$sql_1432 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,3)='211'";
					$sql_1432_r=$this->db->query($sql_1432);
					
					
					foreach ($sql_1432_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}	
						
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_211
							</td>                         
						</tr>";
				}else if($reff=='2.1.2'){
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"center\"></td>                         
							 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
						
					$sql_1432 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,3)='212'";
					$sql_1432_r=$this->db->query($sql_1432);
					
					
					foreach ($sql_1432_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}	
						
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_212
							</td>                         
						</tr>";
				}else{
					
					$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"center\"></td>                         
							 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
					$sql_1432 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,3)='213'";
					$sql_1432_r=$this->db->query($sql_1432);
					
					
					foreach ($sql_1432_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}	
						
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_213
							</td>                         
						</tr>";
				}
				
			}
			
			// 2.2 Pendapatan Diterima Dimuka
		$sql_12 = "	select '2.2' reff, 'Pendapatan Diterima Dimuka' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='214' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong></strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$reff $uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 2.2 Rincian Pendapatan Diterima Dimuka
		$sql_12 = "	select '2.2.1' reff, 'Pendapatan Diterima Dimuka lainnya' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='214' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"center\"></td>                         
							 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
						
				$sql_1432 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,3)='221'";
					$sql_1432_r=$this->db->query($sql_1432);
					
					
					foreach ($sql_1432_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}	
						
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_221
							</td>                         
						</tr>";
				
			}
			
			// 2.3 Utang Belanja
		$sql_12 = "	select '2.3' reff, 'Utang Belanja' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='215' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong></strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$reff $uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
			}
			
			// 2.3 Rincian Utang Belanja
		$sql_12 = "	select '2.3.1' reff, 'Utang Belanja Pegawai' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='21501' and a.kd_unit='$kd_skpd'
					union all
					select '2.3.2' reff, 'Utang Belanja Barang dan Jasa' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='21502' and a.kd_unit='$kd_skpd'
					union all
					select '2.3.3' reff, 'Utang Belanja Modal' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,5)='21503' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
				if($reff=='2.3.1'){
				
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"center\"></td>                         
							 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
				
				$sql_1432 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,3)='231'";
					$sql_1432_r=$this->db->query($sql_1432);
					
					
					foreach ($sql_1432_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}	
						
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_231
							</td>                         
						</tr>";
				}else if($reff=='2.3.2'){
					
				
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"center\"></td>                         
							 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
				
				$sql_1432 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,3)='232'";
					$sql_1432_r=$this->db->query($sql_1432);
					
					
					foreach ($sql_1432_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}	
						
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_232
							</td>                         
						</tr>";
				}else{
				
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"center\"></td>                         
							 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
							 <td align=\"right\">$c$real_sal_lalu$d</td>
						</tr>";
				
				$sql_1432 = "select * from isi_neraca_calk where kd_skpd='$kd_skpd' and LEFT(kd_rek,3)='233'";
					$sql_1432_r=$this->db->query($sql_1432);
					
					
					foreach ($sql_1432_r->result() as $rowsc){
						$ket     = $rowsc->ket;
						$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
					}	
						
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\">
								$tombol_233
							</td>                         
						</tr>";
				}
				
			}
			
			// 2.4 Rincian Utang Jangka Pendek Lainnya
		$sql_12 = "	
					select '' reff, 'Jumlah Kewajiban' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1)='2' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				if($reff==''){
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$a$real_sal$b</td>
								 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}else{
					$cRet .= "<tr>
								 <td align=\"left\">&nbsp;</td>                         
								 <td align=\"center\">&nbsp;</td>                         
								 <td colspan =\"3\" align=\"left\">$reff $uraian</td>
								 <td align=\"right\">$a$real_sal$b</td>
								 <td align=\"right\">$c$real_sal_lalu$d</td>
							</tr>";
				}
			}
			
			// 3 EKUITAS
		$sql_12 = "	select '3' reff, 'EKUITAS' uraian, sum(sal) sal, sum(sal_lalu) sal_lalu from (
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3130101' and a.kd_unit='$kd_skpd'
					) a";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\">&nbsp;</td>                         
							 <td colspan =\"3\" align=\"left\">&nbsp;</td>
							 <td align=\"right\">&nbsp;</td>
							 <td align=\"right\">&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>                         
							 <td colspan =\"3\" align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>
						<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\">&nbsp;</td>                         
							 <td colspan =\"5\" align=\"justify\">Pada Neraca per 31 Desember $thn Ekuitas sebesar $a$real_sal$b sedangkan pada Neraca per 31 Desember $cthnsbl saldo Ekuitas sebesar $c$real_sal_lalu$d</td>
						</tr>";
			}
			
			// TOTAL KEWAJIBAN DAN EKUITAS
		$sql_12 = "	select '' reff, 'TOTAL KEWAJIBAN DAN EKUITAS DANA' uraian, sum(sal) sal, sum(sal_lalu) sal_lalu from (
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3130101' and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
					isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('2') and a.kd_unit='$kd_skpd'
					) a";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			$sal_lalu   = $rowsc->sal_lalu;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			if ($sal_lalu < 0){
                    	$c="("; $sal_lalux=$sal_lalu*-1; $d=")";
                        }else {
                    	$c=""; $sal_lalux=$sal_lalu; $d="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			$real_sal_lalu= number_format($sal_lalux,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\">&nbsp;</td>                         
							 <td colspan =\"3\" align=\"left\">&nbsp;</td>
							 <td align=\"right\">&nbsp;</td>
							 <td align=\"right\">&nbsp;</td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td colspan =\"4\" align=\"left\"><strong>$uraian</strong></td>                         
							 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\"><strong>$a$real_sal$b</strong></td>
							 <td style=\"border-top:solid;;border-bottom:solid;\" align=\"right\"><strong>$c$real_sal_lalu$d</strong></td>
						</tr>";
						
						
						

			}
			
		$cRet .= "</table><br>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("BAB III $kd_skpd /");
        $this->template->set('title', 'BAB III $kd_skpd / $cbulan');        
        
		$pilih=1;
		switch($pilih) {       
        case 1;
			echo ("<title>BAB III</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }
	
	function cetak_analisis_all($print='',$jnsctk=''){
		$thn	 = 2018;//$this->session->userdata('pcThang');
		$cthnsbl = $thn-1;
		
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd<>'3.13.01.17'";
        $sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$nmskpd = $rowsc->nm_skpd;
		} 
		$nm_skpd = strtoupper($nmskpd);	
	
		//--pindah
		$sql51 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=5";
        $hasil51 = $this->db->query($sql51);
		foreach ($hasil51->result() as $row)
        {
			$kd_rek51 = $row->kd_rek;			
		}
		
		$sql91 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=9";
        $hasil91 = $this->db->query($sql91);
		foreach ($hasil91->result() as $row)
        {
			$kd_rek91 = $row->kd_rek;			
		}
		
		$sql21 = "SELECT kd_rek FROM map_beban2 WHERE jenis=1 AND kode=2";
        $hasil21 = $this->db->query($sql21);
		foreach ($hasil21->result() as $row)
        {
			$kd_rek21 = $row->kd_rek;			
		}
		
		$sql52 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=5";
        $hasil52 = $this->db->query($sql52);
		foreach ($hasil52->result() as $row)
        {
			$kd_rek52 = $row->kd_rek;			
		}
		
		$sql92 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=9";
        $hasil92 = $this->db->query($sql92);
		foreach ($hasil92->result() as $row)
        {
			$kd_rek92 = $row->kd_rek;			
		}
		
		$sql22 = "SELECT kd_rek FROM map_beban2 WHERE jenis=2 AND kode=2";
        $hasil22 = $this->db->query($sql22);
		foreach ($hasil22->result() as $row)
        {
			$kd_rek22 = $row->kd_rek;			
		}
		
		$sql53 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=5";
        $hasil53 = $this->db->query($sql53);
		foreach ($hasil53->result() as $row)
        {
			$kd_rek53 = $row->kd_rek;			
		}
		
		$sql93 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=9";
        $hasil93 = $this->db->query($sql93);
		foreach ($hasil93->result() as $row)
        {
			$kd_rek93 = $row->kd_rek;			
		}
		
		$sql23 = "SELECT kd_rek FROM map_beban2 WHERE jenis=3 AND kode=2";
        $hasil23 = $this->db->query($sql23);
		foreach ($hasil23->result() as $row)
        {
			$kd_rek23 = $row->kd_rek;			
		}
		
		$sql54 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=5";
        $hasil54 = $this->db->query($sql54);
		foreach ($hasil54->result() as $row)
        {
			$kd_rek54 = $row->kd_rek;			
		}
		
		$sql94 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=9";
        $hasil94 = $this->db->query($sql94);
		foreach ($hasil94->result() as $row)
        {
			$kd_rek94 = $row->kd_rek;			
		}
		
		$sql24 = "SELECT kd_rek FROM map_beban2 WHERE jenis=4 AND kode=2";
        $hasil24 = $this->db->query($sql24);
		foreach ($hasil24->result() as $row)
        {
			$kd_rek24 = $row->kd_rek;			
		}
		//--akhir
	
		
		$cRet = '';
		
		//mulai
		
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
							<tr><td align=\"right\">Lampiran 1</td></tr>                         
							<tr><td align=\"center\"><strong>ANALISIS</strong></td></tr>                         
						    <tr><td align=\"center\"><strong>PEMERIKSAAN ATAS LAPORAN KEUANGAN</strong></td></tr>                         
							<tr><td align=\"center\"><strong>PEMERINTAH PROVINSI KALIMANTAN BARAT</strong></td></tr>                         
							<tr><td align=\"center\"><strong>TAHUN ANGGARAN $thn</strong></td></tr>                         
				  </table><br>";
		
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
							<tr>
								<td align=\"left\" colspan=\"3\"><b>a. ANALISIS VERTIKAL</b></td>
							</tr>
							<tr>
								<td align=\"left\" colspan=\"3\"><b>1) Analisis vertikal dalam LRA</b></td>
							</tr>                         
							<tr>
								<td align=\"center\"><b>Uraian</b></td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"center\"><b>Persamaan</b></td>
							</tr> 
							<tr>
								<td align=\"left\">Surplus/Defisit LRA tahun berjalan harus sama dengan total pendapatan dikurangi total belanja</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">Surplus/Defisit = Total Pendapatan - Total Belanja</td>
							</tr>
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
		
		//1 analisis vertikal
		$sqlsc1="SELECT tot_pend, tot_bel, tot_pend-tot_bel sur_def 
					FROM (
					SELECT 1 jns, ISNULL(SUM(kredit-debet),0) tot_pend 
					FROM trdju_calk a INNER JOIN trhju_calk b on a.kd_unit=b.kd_skpd AND a.no_voucher=b.no_voucher
					WHERE a.kd_unit<>'3.13.01.17' AND LEFT(a.kd_rek5,1) IN ('4') AND YEAR(b.tgl_voucher)=$thn
					) x
					INNER JOIN
					(
					SELECT 1 jns, ISNULL(SUM(debet-kredit),0) tot_bel 
					FROM trdju_calk a INNER JOIN trhju_calk b on a.kd_unit=b.kd_skpd AND a.no_voucher=b.no_voucher
					WHERE a.kd_unit<>'3.13.01.17' AND LEFT(a.kd_rek5,1) IN ('5') AND YEAR(b.tgl_voucher)=$thn
					) y on x.jns=y.jns";
        $sqlsclient1=$this->db->query($sqlsc1);
		foreach ($sqlsclient1->result() as $rowsc){
			$sur_def        = $rowsc->sur_def;
			$tot_pend       = $rowsc->tot_pend;
			$tot_bel        = $rowsc->tot_bel;
			
			$selisih=$sur_def-($tot_pend-$tot_bel);
			
			if($sur_def<0){
				$sur_def = $sur_def*-1;
				$a="(";
				$b=")";
			}else{
				$sur_def = $sur_def;
				$a="";
				$b="";
			}
		
		} 
		
		//Penjelasan
		$cRet .= "<tr>
								<td align=\"left\">SURPLUS/DEFISIT LRA THN BERJALAN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$a".number_format($sur_def,"2",",",".")."$b</td>
							</tr>
							<tr>
								<td align=\"left\">TOTAL PENDAPATAN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($tot_pend,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">TOTAL BELANJA DAN TRANSFER</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($tot_bel,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>".number_format($selisih,"2",",",".")."</b></td>
							</tr>";
		
		//--PINDAH
		$tombol_a11 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_a11\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='a11' order by kd_rinci"; */
		
		$usqlsc1="SELECT w.kd_skpd, w.nm_skpd, w.ket, x.selisih FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket 
					FROM isi_analisis_calk x 
					WHERE kd_skpd<>'3.13.01.17' and kd_rek='a11' ) w
					INNER JOIN (
					SELECT kd_skpd, sur_def-(tot_pend-tot_bel) selisih FROM (
					SELECT kd_skpd, ISNULL(tot_pend,0) tot_pend, ISNULL(tot_bel,0) tot_bel, ISNULL(tot_pend-tot_bel,0) sur_def
					FROM (
					SELECT s.kd_skpd, ISNULL(tot_pend,0) tot_pend, ISNULL(tot_bel,0) tot_bel
					FROM (
					SELECT kd_skpd FROM ms_skpd ) s
					LEFT JOIN
					(
					SELECT a.kd_unit, ISNULL(SUM(kredit-debet),0) tot_pend 
					FROM trdju_calk a INNER JOIN trhju_calk b on a.kd_unit=b.kd_skpd AND a.no_voucher=b.no_voucher
					WHERE LEFT(a.kd_rek5,1) IN ('4') AND YEAR(b.tgl_voucher)=$thn AND a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit) x
					ON s.kd_skpd=x.kd_unit
					LEFT JOIN
					(
					SELECT a.kd_unit, ISNULL(SUM(debet-kredit),0) tot_bel 
					FROM trdju_calk a INNER JOIN trhju_calk b on a.kd_unit=b.kd_skpd AND a.no_voucher=b.no_voucher
					WHERE LEFT(a.kd_rek5,1) IN ('5') AND YEAR(b.tgl_voucher)=$thn AND a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					) y on s.kd_skpd=y.kd_unit ) p ) s ) x
					ON w.kd_skpd=x.kd_skpd";
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_a11</td>
							</tr>";
		}else{
			$cRet .= "";
		}
		
		//--Batas
			
			$cRet .= "<tr>
								<td align=\"left\" colspan=\"3\"><b>2) Analisis vertikal dalam Neraca</b></td>
							</tr>                         
							<tr>
								<td align=\"center\"><b>Uraian</b></td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"center\"><b>Persamaan</b></td>
							</tr> 
							<tr>
								<td align=\"left\">Aset harus sama dengan total kewajiban ditambah dengan total ekuitas</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">Aset = Kewajiban + Ekuitas</td>
							</tr>
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
				  
				  
		//2 Analisis vertikal dalam Neraca
		$sqlsc1="SELECT SUM(aset) aset, SUM(kewajiban) kewajiban, SUM(ekuitas) ekuitas FROM (
				select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) aset, 0 kewajiban, 0 ekuitas
				from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				where LEFT(kd_rek5,1)='1' and a.kd_unit<>'3.13.01.17'
				UNION ALL
				select 0 aset, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) kewajiban, 0 ekuitas
				from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				where LEFT(kd_rek5,1)='2' and a.kd_unit<>'3.13.01.17'

				UNION ALL
				select 0 aset, 0 kewajiban, ISNULL(sum(sal),0) ekuitas from (
				select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal
				from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				where left(kd_rek5,1) in ('8','9') and a.kd_unit<>'3.13.01.17'
				union all
				select isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
				from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit<>'3.13.01.17'
				union all
				select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal 
				from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit<>'3.13.01.17'
				union all
				select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal
				from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
				where kd_rek5='3130101' and a.kd_unit<>'3.13.01.17'
				) a) a";
					
        $sqlsclient1=$this->db->query($sqlsc1);
		foreach ($sqlsclient1->result() as $rowsc){
			$aset        = $rowsc->aset;
			$kewajiban   = $rowsc->kewajiban;
			$ekuitas     = $rowsc->ekuitas;
			
			$selisih=$aset-($kewajiban+$ekuitas);
			
			if($selisih<0){
				$selisih = $selisih*-1;
				$a="(";
				$b=")";
			}else{
				$selisih = $selisih;
				$a="";
				$b="";
			}
		
		}		  
				  $cRet .= "<tr>
								<td align=\"left\">ASET</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">KEWAJIBAN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($kewajiban,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">EKUITAS</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($ekuitas,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>$a".number_format($selisih,"2",",",".")."$b</b></td>
							</tr>";
							
		//--PINDAH
		$tombol_a21 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_a21\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='a21' order by kd_skpd, kd_rinci"; */
		
		$usqlsc1="SELECT x.kd_skpd, x.nm_skpd, x.ket, y.aset-(y.kewajiban+y.ekuitas) selisih 
					FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket 
					from isi_analisis_calk x 
					where kd_skpd<>'3.13.01.17' and kd_rek='a21' ) x
					INNER JOIN
					(
					SELECT p.kd_skpd, ISNULL(q.aset,0) aset, ISNULL(q.kewajiban,0) kewajiban, ISNULL(q.ekuitas,0) ekuitas 
					FROM (
					SELECT kd_skpd FROM ms_skpd ) p
					LEFT JOIN
					(
					SELECT kd_unit, SUM(aset) aset, SUM(kewajiban) kewajiban, SUM(ekuitas) ekuitas FROM (
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) aset, 0 kewajiban, 0 ekuitas
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,1)='1' and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					UNION ALL
					select a.kd_unit, 0 aset, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) kewajiban, 0 ekuitas
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,1)='2' and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					UNION ALL
					select kd_unit, 0 aset, 0 kewajiban, ISNULL(sum(sal),0) ekuitas from (
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit<>'3.13.01.17'
					group by a.kd_unit
					union all
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit<>'3.13.01.17'
					group by a.kd_unit
					union all
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal 
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit<>'3.13.01.17'
					group by a.kd_unit
					union all
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3130101' and a.kd_unit<>'3.13.01.17'
					group by a.kd_unit
					) a group by kd_unit) a group by kd_unit ) q
					ON p.kd_skpd=q.kd_unit) y ON x.kd_skpd=y.kd_skpd
					ORDER BY kd_skpd";
		
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
							
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_a21</td>
							</tr>";
		}else{
			$cRet .= "";
		}
		//--Batas
			
			$cRet .= "<tr>
								<td align=\"left\">Kas di Bendahara Pengeluaran harus sama dengan sisa Uang Persediaan yang belum disetor ke kasda ditambah dengan Utang PFK di Bendahara Pengeluaran yang belum disetor ke kas negara.</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">Kas di Bendahara Pengeluaran = Sisa Uang Persediaan yang Belum Disetor + Utang PFK di Bendahara Pengeluaran</td>
							</tr>
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
		// kas di bendahara
		$sqlsc2="SELECT x.kas_keluar, y.sisa_kas, z.utang_pfk FROM (
					select 1 jns, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) kas_keluar
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,5)='11103' and a.kd_unit<>'3.13.01.17' ) x
					INNER JOIN
					(
					SELECT 1 jns, ISNULL(x.nilai_sp2d-y.sd_bulan_ini-z.nilai_cp,0) sisa_kas FROM (
					select 1 jns, ISNULL(SUM(d.nilai),0) as nilai_sp2d FROM trhsp2d a 
					INNER JOIN trhspm b ON a.kd_skpd=b.kd_skpd AND a.no_spm=b.no_spm
					INNER JOIN trhspp c ON b.kd_skpd=c.kd_skpd AND b.no_spp=c.no_spp
					INNER JOIN trdspp d ON c.kd_skpd=d.kd_skpd AND c.no_spp=d.no_spp
					WHERE a.kd_skpd<>'3.13.01.17' AND status_terima='1' 
					AND MONTH(tgl_terima)<='12' AND LEFT(kd_rek5,1)  in ('5','1')
					AND (c.sp2d_batal IS NULL  OR c.sp2d_batal !=1)) x 
					INNER JOIN
					(SELECT 1 jns, ISNULL(SUM(sd_bulan_ini),0) sd_bulan_ini 
					FROM realisasi_jurnal_objek_n_at(12,3,$thn) 
					WHERE kd_skpd<>'3.13.01.17' AND LEN(kd_rek)='3') y
					ON x.jns=y.jns
					INNER JOIN
					(SELECT 1 jns, ISNULL(SUM(nilai_cp),0) nilai_cp FROM 
					(select SUM(rupiah) as nilai_cp from 
					trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts AND c.kd_skpd = d.kd_skpd 
					where d.kd_skpd<>'3.13.01.17' AND jns_trans='5' AND pot_khusus IN ('2','1') AND MONTH(tgl_sts)<='12'
					UNION ALL
					select SUM(rupiah) as nilai_cp from 
					trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts AND c.kd_skpd = d.kd_skpd 
					where d.kd_skpd<>'3.13.01.17' AND ((jns_trans='5' AND pot_khusus='0') OR jns_trans='1')AND MONTH(tgl_sts)<='12') a) z
					ON y.jns=z.jns) y
					ON x.jns=y.jns
					INNER JOIN
					(
					select 1 jns, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) utang_pfk
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='211' and a.kd_unit<>'3.13.01.17') z
					ON y.jns=z.jns";
        $sqlsclient2=$this->db->query($sqlsc2);
		foreach ($sqlsclient2->result() as $rowsc){
			$kas_keluar = $rowsc->kas_keluar;
			$sisa_kas   = $rowsc->sisa_kas;
			$utang_pfk  = $rowsc->utang_pfk;
			
			$selisih=$kas_keluar-($sisa_kas+$utang_pfk);
			
			if($kas_keluar<0){
				$kas_keluar = $kas_keluar*-1;
				$r="(";
				$s=")";
			}else{
				$kas_keluar = $kas_keluar;
				$r="";
				$s="";
			}
			
			if($selisih<0){
				$selisih = $selisih*-1;
				$a="(";
				$b=")";
			}else{
				$selisih = $selisih;
				$a="";
				$b="";
			}
		
		}
		
				 $cRet .= "<tr>
								<td align=\"left\">KAS DI BENDAHARA PENGELUARAN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$r".number_format($kas_keluar,"2",",",".")."$s</td>
							</tr>
							<tr>
								<td align=\"left\">SISA UANG PERSEDIAAN BELUM SETOR</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($sisa_kas,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">UTANG PFK DI BENDAHARA PENGELUARAN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($utang_pfk,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>".number_format($selisih,"2",",",".")."</b></td>
							</tr>";
							
		//--PINDAH
		$tombol_a22 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_a22\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='a22' order by kd_rinci"; */
		
		$usqlsc1="SELECT y.kd_skpd, y.nm_skpd, y.ket, kas_keluar-(sisa_kas+utang_pfk) selisih FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='a22'
					) y
					INNER JOIN
					(
					SELECT e.kd_skpd, ISNULL(kas_keluar,0) kas_keluar, ISNULL(sisa_kas,0) sisa_kas, ISNULL(utang_pfk,0) utang_pfk FROM (
					SELECT kd_skpd FROM ms_skpd ) e
					LEFT JOIN
					(
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then debet-kredit else 0 end),0) kas_keluar
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where LEFT(kd_rek5,5)='11103' and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit ) f
					ON e.kd_skpd=f.kd_unit
					LEFT JOIN (
					SELECT kd_skpd, nilai_sp2d-sd_bulan_ini-nilai_cp sisa_kas FROM (
					SELECT s.kd_skpd, ISNULL(x.nilai_sp2d,0) nilai_sp2d, ISNULL(y.sd_bulan_ini,0) sd_bulan_ini, ISNULL(z.nilai_cp,0) nilai_cp FROM (
					SELECT kd_skpd FROM ms_skpd ) s
					LEFT JOIN
					(
					select d.kd_skpd, ISNULL(SUM(d.nilai),0) as nilai_sp2d FROM trhsp2d a 
					INNER JOIN trhspm b ON a.kd_skpd=b.kd_skpd AND a.no_spm=b.no_spm
					INNER JOIN trhspp c ON b.kd_skpd=c.kd_skpd AND b.no_spp=c.no_spp
					INNER JOIN trdspp d ON c.kd_skpd=d.kd_skpd AND c.no_spp=d.no_spp
					WHERE a.kd_skpd<>'3.13.01.17' AND status_terima='1' 
					AND MONTH(tgl_terima)<='12' AND LEFT(kd_rek5,1)  in ('5','1')
					AND (c.sp2d_batal IS NULL  OR c.sp2d_batal !=1) 
					GROUP BY d.kd_skpd ) x
					ON s.kd_skpd=x.kd_skpd
					LEFT JOIN
					(
					SELECT kd_skpd, ISNULL(SUM(sd_bulan_ini),0) sd_bulan_ini 
					FROM realisasi_jurnal_objek_n_at(12,3,$thn) 
					WHERE kd_skpd<>'3.13.01.17' AND LEN(kd_rek)='3'
					GROUP BY kd_skpd) y
					ON s.kd_skpd=y.kd_skpd
					LEFT JOIN 
					(
					SELECT kd_skpd, ISNULL(SUM(nilai_cp),0) nilai_cp FROM (
					select c.kd_skpd, SUM(rupiah) as nilai_cp from 
					trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts AND c.kd_skpd = d.kd_skpd 
					where d.kd_skpd<>'3.13.01.17' AND jns_trans='5' AND pot_khusus IN ('2','1') AND MONTH(tgl_sts)<='12'
					GROUP BY c.kd_skpd
					UNION ALL
					select c.kd_skpd, SUM(rupiah) as nilai_cp from 
					trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts AND c.kd_skpd = d.kd_skpd 
					where d.kd_skpd<>'3.13.01.17' AND ((jns_trans='5' AND pot_khusus='0') OR jns_trans='1')AND MONTH(tgl_sts)<='12'
					GROUP BY c.kd_skpd ) a GROUP BY kd_skpd ) z
					ON s.kd_skpd=z.kd_skpd ) r ) n
					ON e.kd_skpd=n.kd_skpd
					LEFT JOIN
					(
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) utang_pfk
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3)='211' and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit) l ON e.kd_skpd=l.kd_unit ) w
					ON y.kd_skpd=w.kd_skpd
					ORDER BY y.kd_skpd";
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
							
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_a22</td>
							</tr>";
		}else{
			$cRet .= "";
		}
		//--Batas
			$cRet .= "					
							<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
							<tr>
								<td align=\"left\" colspan=\"3\"><b>3) Analisis vertikal dalam Laporan Operasional(LO)</b></td>
							</tr>                         
							<tr>
								<td align=\"center\"><b>Uraian</b></td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"center\"><b>Persamaan</b></td>
							</tr> 
							<tr>
								<td align=\"left\">Surplus/Defisit LO harus sama dengan total Pendapatan(LO) dikurangi total Beban(LO) ditambah (dikurangi) total Surplus (Defisit) Kegaitan Non Operasional(LO) ditambah (dikurangi) Pos Luar Biasa(LO)</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">Surplus/Defisit LO= Total Pendapatan(LO) - Total Beban(LO)+/- Total Surplus/Defisit Kegiatan Non Operasional(LO) +/- Pos Luas Biasa(LO)</td>
							</tr>
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
				
			// 3) Analisis vertikal dalam Laporan Operasional(LO)
		$sqlsc3="SELECT x.pend_lo-y.beban_lo sur_def, x.pend_lo, y.beban_lo, z.pen_non_op-p.bel_non_op keg_non_op, q.pos_lb FROM (
					select 1 jns, ISNULL(sum(kredit-debet),0) as pend_lo 
					from trdju_calk a inner join trhju_calk b 
					on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where year(tgl_voucher)=$thn and month(tgl_voucher)<=12 and left(kd_rek5,1) in ('8') and kd_skpd<>'3.13.01.17') x
					INNER JOIN
					(select 1 jns, ISNULL(sum(debet-kredit),0) as beban_lo 
					from trdju_calk a inner join trhju_calk b 
					on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where year(tgl_voucher)=$thn and month(tgl_voucher)<=12 and left(kd_rek5,1) in ('9') and kd_skpd<>'3.13.01.17') y
					ON x.jns=y.jns
					INNER JOIN
					(select 1 jns, ISNULL(sum(kredit-debet),0) as pen_non_op 
					from trdju_calk a inner join trhju_calk b 
					on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where year(tgl_voucher)=$thn and month(tgl_voucher)<=12 and left(kd_rek5,2) in ('84') and kd_skpd<>'3.13.01.17') z
					ON y.jns=z.jns
					INNER JOIN
					(select 1 jns, ISNULL(sum(debet-kredit),0) as bel_non_op 
					from trdju_calk a inner join trhju_calk b 
					on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					where year(tgl_voucher)=$thn and month(tgl_voucher)<=12 and left(kd_rek5,2) in ('93') and kd_skpd<>'3.13.01.17') p
					ON z.jns=p.jns
					INNER JOIN
					(SELECT 1 jns, ISNULL(SUM(kredit-debet),0) as pos_lb 
					FROM trdju_calk a inner join trhju_calk b 
					on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
					WHERE left(kd_rek5,3) in ('851','941') and year(tgl_voucher)=$thn and kd_skpd<>'3.13.01.17') q
					ON p.jns=q.jns";
        $sqlsclient3=$this->db->query($sqlsc3);
		foreach ($sqlsclient3->result() as $rowsc){
			$sur_def = $rowsc->sur_def;
			$pend_lo   = $rowsc->pend_lo;
			$beban_lo  = $rowsc->beban_lo*-1;
			$keg_non_op  = $rowsc->keg_non_op;
			$pos_lb  = $rowsc->pos_lb;
			
			$selisih=$sur_def-($pend_lo+$beban_lo+$keg_non_op+$pos_lb);
			
			if($sur_def<0){
				$sur_def = $sur_def*-1;
				$a="(";
				$b=")";
			}else{
				$sur_def = $sur_def;
				$a="";
				$b="";
			}
			
			if($selisih<0){
				$selisih = $selisih*-1;
				$a="(";
				$b=")";
			}else{
				$selisih = $selisih;
				$a="";
				$b="";
			}
			
			if($beban_lo<0){
				$beban_lo = $beban_lo*-1;
				$a="(";
				$b=")";
			}else{
				$beban_lo = $beban_lo;
				$a="";
				$b="";
			}
		
		}
			
				$cRet .= "<tr>
								<td align=\"left\">SURPLUS(DEFISIT) LO</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$a".number_format($sur_def,"2",",",".")."$b</td>
							</tr>
							<tr>
								<td align=\"left\">TOTAL PENDAPATAN(LO)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($pend_lo,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">TOTAL BEBAN(LO)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$a".number_format($beban_lo,"2",",",".")."$b</td>
							</tr>
							<tr>
								<td align=\"left\">TOTAL SURPLUS(DEFISIT)KEGIATAN NON OPERASIONAL</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($keg_non_op,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">TOTAL POS LUAR BIASA</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($pos_lb,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>".number_format($selisih,"2",",",".")."</b></td>
							</tr>";
							
			//--PINDAH
		$tombol_a31 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_a31\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='a31' order by kd_rinci"; */
		
			$usqlsc1="SELECT w.kd_skpd, w.nm_skpd, w.ket, t.sur_def-(t.pend_lo+t.beban_lo+keg_non_op+pos_lb) selisih FROM (
			SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='a31' ) w
			INNER JOIN
			(
			SELECT kd_skpd, pend_lo-beban_lo sur_def, pend_lo, beban_lo*-1 beban_lo, pen_non_op-bel_non_op keg_non_op, pos_lb FROM (
			SELECT s.kd_skpd, ISNULL(x.pend_lo,0) pend_lo, ISNULL(y.beban_lo,0) beban_lo, ISNULL(z.pen_non_op,0) pen_non_op, ISNULL(p.bel_non_op,0) bel_non_op, ISNULL(q.pos_lb,0) pos_lb FROM (
			SELECT kd_skpd FROM ms_skpd ) s
			LEFT JOIN
			(
			select a.kd_unit, ISNULL(sum(kredit-debet),0) as pend_lo 
			from trdju_calk a inner join trhju_calk b 
			on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
			where year(tgl_voucher)=$thn and month(tgl_voucher)<=12 and left(kd_rek5,1) in ('8') and kd_skpd<>'3.13.01.17'
			GROUP BY a.kd_unit) x ON s.kd_skpd=x.kd_unit
			LEFT JOIN
			(select a.kd_unit, ISNULL(sum(debet-kredit),0) as beban_lo 
			from trdju_calk a inner join trhju_calk b 
			on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
			where year(tgl_voucher)=$thn and month(tgl_voucher)<=12 and left(kd_rek5,1) in ('9') and kd_skpd<>'3.13.01.17'
			GROUP BY a.kd_unit) y ON s.kd_skpd=y.kd_unit
			LEFT JOIN
			(select a.kd_unit, ISNULL(sum(kredit-debet),0) as pen_non_op 
			from trdju_calk a inner join trhju_calk b 
			on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
			where year(tgl_voucher)=$thn and month(tgl_voucher)<=12 and left(kd_rek5,2) in ('84') and kd_skpd<>'3.13.01.17'
			GROUP BY a.kd_unit) z ON s.kd_skpd=z.kd_unit
			LEFT JOIN
			(select a.kd_unit, ISNULL(sum(debet-kredit),0) as bel_non_op 
			from trdju_calk a inner join trhju_calk b 
			on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
			where year(tgl_voucher)=$thn and month(tgl_voucher)<=12 and left(kd_rek5,2) in ('93') and kd_skpd<>'3.13.01.17'
			group by a.kd_unit) p ON s.kd_skpd=p.kd_unit
			LEFT JOIN
			(SELECT a.kd_unit, ISNULL(SUM(kredit-debet),0) as pos_lb 
			FROM trdju_calk a inner join trhju_calk b 
			on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd 
			WHERE left(kd_rek5,3) in ('851','941') and year(tgl_voucher)=$thn and kd_skpd<>'3.13.01.17'
			group by a.kd_unit) q ON s.kd_skpd=q.kd_unit) m ) t ON w.kd_skpd=t.kd_skpd
			ORDER BY w.kd_skpd";
		
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_a31</td>
							</tr>";
		}else{
			$cRet .= "";
		}				
		//--Batas
			$cRet .= "	<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
							<tr>
								<td align=\"left\" colspan=\"3\"><b>4) Analisis vertikal dalam Laporan Perubahan Ekuitas</b></td>
							</tr>                         
							<tr>
								<td align=\"center\"><b>Uraian</b></td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"center\"><b>Persamaan</b></td>
							</tr> 
							<tr>
								<td align=\"left\">Ekuitas akhir harus sama dengan ekuitas awal ditambah(dikurangi) surplus/defisit LO ditambah(dikurangi) koreksi berdampak ke ekuitas</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">Ekuitas akhir = ekuitas awal(+/-) surplus/defisit LO(+/-) koreksi berdampak ke ekuitas</td>
							</tr>
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
		// 4) Analisis vertikal dalam Laporan Perubahan Ekuitas
		$sqlsc4="select sum(sur_awal+umum_awal+kor_awal) eq_awal,  sum(sur_akhir) sur_def, sum(umum_akhir+kor_akhir) koreksi, sum(sur_awal+umum_awal+kor_awal+sur_akhir+umum_akhir+kor_akhir) eq_akhir from (
					select isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sur_awal, 0 umum_awal, 0 kor_awal, 0 sur_akhir, 0 umum_akhir, 0 kor_akhir
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit<>'3.13.01.17'
					union all
					select 0 sur_awal, isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) umum_awal, 0 kor_awal, 0 sur_akhir, 0 umum_akhir, 0 kor_akhir
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit<>'3.13.01.17'
					union all
					select 0 sur_awal, 0 umum_awal, isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) kor_awal, 0 sur_akhir, 0 umum_akhir, 0 kor_akhir
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit<>'3.13.01.17'
					union all
					select 0 sur_awal, 0 umum_awal, 0 kor_awal, isnull(sum(case when YEAR(tgl_voucher)='$thn' then kredit-debet else 0 end),0) sur_akhir, 0 umum_akhir, 0 kor_akhir
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit<>'3.13.01.17'
					union all
					select 0 sur_awal, 0 umum_awal, 0 kor_awal, 0 sur_akhir, 0 umum_awal, 0 kor_akhir
					union all
					select 0 sur_awal, 0 umum_awal, 0 kor_awal, 0 sur_akhir, 0 umum_akhir, isnull(sum(case when YEAR(tgl_voucher)='$thn' then kredit-debet else 0 end),0) kor_akhir
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit<>'3.13.01.17'
					) a";
					
        $sqlsclient4=$this->db->query($sqlsc4);
		foreach ($sqlsclient4->result() as $rowsc){
			$ek_ak = $rowsc->eq_akhir;
			$ek_aw = $rowsc->eq_awal;
			$surdef = $rowsc->sur_def;
			$koreksi = $rowsc->koreksi;
			
			$selisih=$ek_ak-($ek_aw+$surdef+$koreksi);
			
			if($ek_ak<0){
				$ek_ak = $ek_ak*-1;
				$r="(";
				$s=")";
			}else{
				$ek_ak = $ek_ak;
				$r="";
				$s="";
			}
			
			if($ek_aw<0){
				$ek_aw = $ek_aw*-1;
				$t="(";
				$u=")";
			}else{
				$ek_aw = $ek_aw;
				$t="";
				$u="";
			}
			
			if($surdef<0){
				$surdef = $surdef*-1;
				$v="(";
				$w=")";
			}else{
				$surdef = $surdef;
				$v="";
				$w="";
			}
			
			if($koreksi<0){
				$koreksi = $koreksi*-1;
				$x="(";
				$y=")";
			}else{
				$koreksi = $koreksi;
				$x="";
				$y="";
			}
			
			if($selisih<0){
				$selisih = $selisih*-1;
				$a="(";
				$b=")";
			}else{
				$selisih = $selisih;
				$a="";
				$b="";
			}
		
		}			
							
				$cRet .= "<tr>
								<td align=\"left\">Ekuitas Akhir</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$r".number_format($ek_ak,"2",",",".")."$s</td>
							</tr>
							<tr>
								<td align=\"left\">Ekuitas Awal</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$t".number_format($ek_aw,"2",",",".")."$u</td>
							</tr>
							<tr>
								<td align=\"left\">Surplus/defisit LO</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$v".number_format($surdef,"2",",",".")."$w</td>
							</tr>
							<tr>
								<td align=\"left\">Koreksi</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$x".number_format($koreksi,"2",",",".")."$y</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>$a".number_format($selisih,"2",",",".")."$b</b></td>
							</tr>";
							
			//--PINDAH
		$tombol_a41 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_a41\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='a41' order by kd_rinci"; */
		
		$usqlsc1="SELECT p.kd_skpd, p.nm_skpd, p.ket, q.selisih FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket 
					from isi_analisis_calk x 
					where kd_skpd<>'3.13.01.17' and kd_rek='a41' ) p
					INNER JOIN (
					SELECT kd_skpd, ISNULL(eq_akhir-(eq_awal+sur_def+koreksi),0) selisih FROM (
					SELECT kd_skpd FROM ms_skpd ) y
					LEFT JOIN ( 
					select kd_unit, sum(sur_awal+umum_awal+kor_awal) eq_awal,  sum(sur_akhir) sur_def, sum(umum_akhir+kor_akhir) koreksi, sum(sur_awal+umum_awal+kor_awal+sur_akhir+umum_akhir+kor_akhir) eq_akhir from (
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sur_awal, 0 umum_awal, 0 kor_awal, 0 sur_akhir, 0 umum_akhir, 0 kor_akhir
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					union all
					select a.kd_unit, 0 sur_awal, isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) umum_awal, 0 kor_awal, 0 sur_akhir, 0 umum_akhir, 0 kor_akhir
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					union all
					select a.kd_unit, 0 sur_awal, 0 umum_awal, isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) kor_awal, 0 sur_akhir, 0 umum_akhir, 0 kor_akhir
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					union all
					select a.kd_unit, 0 sur_awal, 0 umum_awal, 0 kor_awal, isnull(sum(case when YEAR(tgl_voucher)='$thn' then kredit-debet else 0 end),0) sur_akhir, 0 umum_akhir, 0 kor_akhir
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					union all
					select a.kd_unit, 0 sur_awal, 0 umum_awal, 0 kor_awal, 0 sur_akhir, 0 umum_akhir, isnull(sum(case when YEAR(tgl_voucher)='$thn' then kredit-debet else 0 end),0) kor_akhir
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					) a group by kd_unit ) z ON y.kd_skpd=z.kd_unit ) q ON p.kd_skpd=q.kd_skpd
					order by p.kd_skpd";
		
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_a41</td>
							</tr>";
		}else{
			$cRet .= "";
		}		
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
							<tr>
								<td align=\"left\" colspan=\"3\"><b>b. ANALISIS HORIZONTAL</b></td>
							</tr>                         
							<tr>
								<td align=\"left\" colspan=\"3\"><b>1) Analisis horizontal antara LRA dan Neraca</b></td>
							</tr>                         
							<tr>
								<td align=\"justify\">Realisasi belanja modal harus sama dengan penambahan aset tetap (dan aset lainnya), jika selisih harus dijelaskan di CALK</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Teliti apakah pengungkapan selisih dalam CaLK sudah cukup memadai. Mungkin ada penerimaan hibah berupa aset dan kapitalisasi biaya. Atau ada kesalahan berupa: salah anggaran selain BM ternyata menghasilkan aset atau aset daerah yang baru ditemukan</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
				
				$sqlsc4="SELECT x.real_tanah, y.aset_tanah, z.aset_tanah_l FROM (
							select 1 jns, ISNULL(SUM(debet-kredit),0) real_tanah 
							from trhju_calk a inner join trdju_calk b 
							on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='521' AND b.kd_unit<>'3.13.01.17') x
							INNER JOIN
							(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_tanah
							from trhju_calk a inner join trdju_calk b 
							on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,3)='131' AND b.kd_unit<>'3.13.01.17') y
							ON x.jns=y.jns
							INNER JOIN
							(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_tanah_l 
							from trhju_calk a inner join trdju_calk b 
							on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,3)='131' AND b.kd_unit<>'3.13.01.17') z
							ON y.jns=z.jns";
				$sqlsclient4=$this->db->query($sqlsc4);
				foreach ($sqlsclient4->result() as $rowsc){
					$real_tanah = $rowsc->real_tanah;
					$aset_tanah = $rowsc->aset_tanah;
					$aset_tanah_l = $rowsc->aset_tanah_l;
					
					$tanah_tam_kur=$aset_tanah-$aset_tanah_l;
					$selisih = $real_tanah-$tanah_tam_kur;
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
				
				}
				
				  $cRet .= "<tr>
								<td align=\"left\">REALISASI BELANJA MODAL TANAH</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($real_tanah,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PENAMBAHAN(PENURUNAN)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($tanah_tam_kur,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET TANAH $thn</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_tanah,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET TANAH $cthnsbl</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_tanah_l,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>$a".number_format($selisih,"2",",",".")."$b</b></td>
							</tr>";
							
			//--PINDAH
		$tombol_b11 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b11\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b11' order by kd_rinci"; */
		
			$usqlsc1="SELECT m.kd_skpd, m.nm_skpd, m.ket, n.selisih FROM (
						SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b11' ) m
						INNER JOIN (
						SELECT kd_skpd, real_tanah-(aset_tanah-aset_tanah_l) selisih FROM (
						SELECT s.kd_skpd, ISNULL(x.real_tanah,0) real_tanah, ISNULL(y.aset_tanah,0) aset_tanah, ISNULL(z.aset_tanah_l,0) aset_tanah_l FROM (
						SELECT kd_skpd FROM ms_skpd ) s
						LEFT JOIN
						(
						select b.kd_unit, ISNULL(SUM(debet-kredit),0) real_tanah 
						from trhju_calk a inner join trdju_calk b 
						on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='521' AND b.kd_unit<>'3.13.01.17'
						group by b.kd_unit) x
						ON s.kd_skpd=x.kd_unit
						LEFT JOIN
						(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_tanah
						from trhju_calk a inner join trdju_calk b 
						on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,3)='131' AND b.kd_unit<>'3.13.01.17'
						group by b.kd_unit) y
						ON s.kd_skpd=y.kd_unit
						LEFT JOIN
						(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_tanah_l 
						from trhju_calk a inner join trdju_calk b 
						on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
						where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,3)='131' AND b.kd_unit<>'3.13.01.17'
						group by b.kd_unit) z
						ON s.kd_skpd=z.kd_unit ) a ) n ON m.kd_skpd=n.kd_skpd
						order by m.kd_skpd";
		
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b11</td>
							</tr>";
		}else{
			$cRet .= "";
		}	
		
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\">Realisasi belanja modal harus sama dengan penambahan aset tetap (dan aset lainnya), jika selisih harus dijelaskan di CALK</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Teliti apakah pengungkapan selisih dalam CaLK sudah cukup memadai. Mungkin ada penerimaan hibah berupa aset dan kapitalisasi biaya. Atau ada kesalahan berupa: salah anggaran selain BM ternyata menghasilkan aset atau aset daerah yang baru ditemukan</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
					$sqlsc5="SELECT x.real_pmesin, y.aset_pm, z.aset_pml FROM (
								select 1 jns, ISNULL(SUM(debet-kredit),0) real_pmesin 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='522' AND b.kd_unit<>'3.13.01.17') x
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_pm 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,3)='132' AND b.kd_unit<>'3.13.01.17') y
								ON x.jns=y.jns
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_pml 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,3)='132' AND b.kd_unit<>'3.13.01.17') z
								ON y.jns=z.jns";
				$sqlsclient5=$this->db->query($sqlsc5);
				foreach ($sqlsclient5->result() as $rowsc){
					$real_pmesin = $rowsc->real_pmesin;
					$aset_pm = $rowsc->aset_pm;
					$aset_pml = $rowsc->aset_pml;
					
					$pm_tam_kur=$aset_pm-$aset_pml;
					$selisih = $real_pmesin-$pm_tam_kur;
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
				
				}
					
					$cRet .= "<tr>
								<td align=\"left\">REALISASI BELANJA MODAL PERALATAN DAN MESIN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($real_pmesin,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PENAMBAHAN(PENURUNAN)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($pm_tam_kur,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET PERALATAN DAN MESIN $thn</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_pm,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET PERALATAN DAN MESIN $cthnsbl</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_pml,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>".number_format($selisih,"2",",",".")."</b></td>
							</tr>
							";
							
			//--PINDAH
		$tombol_b12 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b12\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b12' AND kd_skpd<>'' order by kd_rinci"; */
		
		$usqlsc1="SELECT q.kd_skpd, q.nm_skpd, q.ket, n.selisih  FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x 
					where kd_skpd<>'3.13.01.17' and kd_rek='b12' AND kd_skpd<>'' ) q
					INNER JOIN (
					SELECT kd_skpd, real_pmesin-(aset_pm-aset_pml) selisih FROM (
					SELECT s.kd_skpd, ISNULL(x.real_pmesin,0) real_pmesin , ISNULL(y.aset_pm,0) aset_pm, ISNULL(z.aset_pml,0) aset_pml FROM (
					SELECT kd_skpd FROM ms_skpd
					) s
					LEFT JOIN
					(
					select b.kd_unit, ISNULL(SUM(debet-kredit),0) real_pmesin 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='522' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) x
					ON s.kd_skpd=x.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_pm 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,3)='132' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) y
					ON s.kd_skpd=y.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_pml 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,3)='132' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) z
					ON s.kd_skpd=z.kd_unit ) c ) n
					ON q.kd_skpd=n.kd_skpd
					order by q.kd_skpd";
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b12</td>
							</tr>";
		}else{
			$cRet .= "";
		}	
		
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\">Realisasi belanja modal harus sama dengan penambahan aset tetap (dan aset lainnya), jika selisih harus dijelaskan di CALK</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Teliti apakah pengungkapan selisih dalam CaLK sudah cukup memadai. Mungkin ada penerimaan hibah berupa aset dan kapitalisasi biaya. Atau ada kesalahan berupa: salah anggaran selain BM ternyata menghasilkan aset atau aset daerah yang baru ditemukan</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
				$sqlsc6="SELECT x.real_gb, y.aset_gb, z.aset_gbl FROM (
								select 1 jns, ISNULL(SUM(debet-kredit),0) real_gb 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='523' AND b.kd_unit<>'3.13.01.17') x
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_gb 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,3)='133' AND b.kd_unit<>'3.13.01.17') y
								ON x.jns=y.jns
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_gbl 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,3)='133' AND b.kd_unit<>'3.13.01.17') z
								ON y.jns=z.jns";
				$sqlsclient6=$this->db->query($sqlsc6);
				foreach ($sqlsclient6->result() as $rowsc){
					$real_gb = $rowsc->real_gb;
					$aset_gb = $rowsc->aset_gb;
					$aset_gbl = $rowsc->aset_gbl;
					
					$gb_tam_kur=$aset_gb-$aset_gbl;
					$selisih = $real_gb-$gb_tam_kur;
					
					if($real_gb<0){
						$real_gb = $real_gb*-1;
						$r="(";
						$s=")";
					}else{
						$real_gb = $real_gb;
						$r="";
						$s="";
					}
					
					if($aset_gb<0){
						$aset_gb = $aset_gb*-1;
						$t="(";
						$u=")";
					}else{
						$aset_gb = $aset_gb;
						$t="";
						$u="";
					}
					
					if($gb_tam_kur<0){
						$gb_tam_kur = $gb_tam_kur*-1;
						$v="(";
						$w=")";
					}else{
						$gb_tam_kur = $gb_tam_kur;
						$v="";
						$w="";
					}
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
				
				}		
							
					$cRet .= "<tr>
								<td align=\"left\">REALISASI BELANJA MODAL GEDUNG DAN BANGUNAN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$r".number_format($real_gb,"2",",",".")."$s</td>
							</tr>
							<tr>
								<td align=\"left\">PENAMBAHAN(PENURUNAN)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$v".number_format($gb_tam_kur,"2",",",".")."$w</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET GEDUNG DAN BANGUNAN $thn</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$t".number_format($aset_gb,"2",",",".")."$u</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET GEDUNG DAN BANGUNAN $cthnsbl</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_gbl,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>".number_format($selisih,"2",",",".")."</b></td>
							</tr>";
							
			//--PINDAH
		$tombol_b13 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b13\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b13' order by kd_rinci";
        $usqlsclient1=$this->db->query($usqlsc1); */
		
		$usqlsc1="SELECT q.kd_skpd, q.nm_skpd, q.ket, n.selisih  FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x 
					where kd_skpd<>'3.13.01.17' and kd_rek='b13' AND kd_skpd<>'' ) q
					INNER JOIN (
					SELECT kd_skpd, real_gb-(aset_gb-aset_gbl) selisih FROM (
					SELECT s.kd_skpd, ISNULL(x.real_gb,0) real_gb , ISNULL(y.aset_gb,0) aset_gb, ISNULL(z.aset_gbl,0) aset_gbl FROM (
					SELECT kd_skpd FROM ms_skpd
					) s
					LEFT JOIN
					(
					select b.kd_unit, ISNULL(SUM(debet-kredit),0) real_gb 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='523' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) x
					ON s.kd_skpd=x.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_gb 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,3)='133' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) y
					ON s.kd_skpd=y.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_gbl 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,3)='133' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) z
					ON s.kd_skpd=z.kd_unit ) c ) n
					ON q.kd_skpd=n.kd_skpd
					order by q.kd_skpd";
		$usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b13</td>
							</tr>";
		}else{
			$cRet .= "";
		}
		
			
		//--Batas
			$cRet .= "
							
							<tr>
								<td align=\"justify\">Realisasi belanja modal harus sama dengan penambahan aset tetap (dan aset lainnya), jika selisih harus dijelaskan di CALK</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Teliti apakah pengungkapan selisih dalam CaLK sudah cukup memadai. Mungkin ada penerimaan hibah berupa aset dan kapitalisasi biaya. Atau ada kesalahan berupa: salah anggaran selain BM ternyata menghasilkan aset atau aset daerah yang baru ditemukan</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
					$sqlsc7="SELECT x.real_jij, y.aset_jij, z.aset_jijl FROM (
								select 1 jns, ISNULL(SUM(debet-kredit),0) real_jij 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='524' AND b.kd_unit<>'3.13.01.17') x
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_jij 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,3)='134' AND b.kd_unit<>'3.13.01.17') y
								ON x.jns=y.jns
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_jijl 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,3)='134' AND b.kd_unit<>'3.13.01.17') z
								ON y.jns=z.jns";
				$sqlsclient7=$this->db->query($sqlsc7);
				foreach ($sqlsclient7->result() as $rowsc){
					$real_jij = $rowsc->real_jij;
					$aset_jij = $rowsc->aset_jij;
					$aset_jijl = $rowsc->aset_jijl;
					
					$jij_tam_kur=$aset_jij-$aset_jijl;
					$selisih = $real_jij-$jij_tam_kur;
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
				
				}
							
					$cRet .= "<tr>
								<td align=\"left\">REALISASI BELANJA MODAL JALAN, IRIGASI DAN JARINGAN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($real_jij,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PENAMBAHAN(PENURUNAN)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($jij_tam_kur,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET JALAN, IRIGASI DAN JARINGAN $thn</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_jij,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET JALAN, IRIGASI DAN JARINGAN $cthnsbl</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_jijl,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>".number_format($selisih,"2",",",".")."</b></td>
							</tr>";
							
			//--PINDAH
		$tombol_b14 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b14\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b14' order by kd_rinci"; */
		
		$usqlsc1="SELECT q.kd_skpd, q.nm_skpd, q.ket, n.selisih  FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x 
					where kd_skpd<>'3.13.01.17' and kd_rek='b14' AND kd_skpd<>'' ) q
					INNER JOIN (
					SELECT kd_skpd, real_jij-(aset_jij-aset_jijl) selisih FROM (
					SELECT s.kd_skpd, ISNULL(x.real_jij,0) real_jij , ISNULL(y.aset_jij,0) aset_jij, ISNULL(z.aset_jijl,0) aset_jijl FROM (
					SELECT kd_skpd FROM ms_skpd
					) s
					LEFT JOIN
					(
					select b.kd_unit, ISNULL(SUM(debet-kredit),0) real_jij 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='524' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) x
					ON s.kd_skpd=x.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_jij 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,3)='134' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) y
					ON s.kd_skpd=y.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_jijl 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,3)='134' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) z
					ON s.kd_skpd=z.kd_unit ) c ) n
					ON q.kd_skpd=n.kd_skpd
					order by q.kd_skpd"; 
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b14</td>
							</tr>";
		}else{
			$cRet .= "";
		}
		
			
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\">Realisasi belanja modal harus sama dengan penambahan aset tetap (dan aset lainnya), jika selisih harus dijelaskan di CALK</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Teliti apakah pengungkapan selisih dalam CaLK sudah cukup memadai. Mungkin ada penerimaan hibah berupa aset dan kapitalisasi biaya. Atau ada kesalahan berupa: salah anggaran selain BM ternyata menghasilkan aset atau aset daerah yang baru ditemukan</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
					$sqlsc8="SELECT x.real_tl, y.aset_tl, z.aset_tll FROM (
								select 1 jns, ISNULL(SUM(debet-kredit),0) real_tl 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='525' AND b.kd_unit<>'3.13.01.17') x
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_tl 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,3)='135' AND b.kd_unit<>'3.13.01.17') y
								ON x.jns=y.jns
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_tll 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,3)='135' AND b.kd_unit<>'3.13.01.17') z
								ON y.jns=z.jns";
				$sqlsclient8=$this->db->query($sqlsc8);
				foreach ($sqlsclient8->result() as $rowsc){
					$real_tl = $rowsc->real_tl;
					$aset_tl = $rowsc->aset_tl;
					$aset_tll = $rowsc->aset_tll;
					
					$tl_tam_kur=$aset_tl-$aset_tll;
					$selisih = $real_tl-$tl_tam_kur;
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
				
				}		
							
					$cRet .= "<tr>
								<td align=\"left\">REALISASI BELANJA MODAL ASET TETAP LAINNYA</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($real_tl,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PENAMBAHAN(PENURUNAN)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($tl_tam_kur,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET TETAP LAINNYA $thn</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_tl,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET TETAP LAINNYA $cthnsbl</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_tll,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>".number_format($selisih,"2",",",".")."</b></td>
							</tr>";
							
			//--PINDAH
		$tombol_b15 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b15\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b15' order by kd_rinci"; */
		
		$usqlsc1="SELECT q.kd_skpd, q.nm_skpd, q.ket, n.selisih  FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x 
					where kd_skpd<>'3.13.01.17' and kd_rek='b15' AND kd_skpd<>'' ) q
					INNER JOIN (
					SELECT kd_skpd, real_tl-(aset_tl-aset_tll) selisih FROM (
					SELECT s.kd_skpd, ISNULL(x.real_tl,0) real_tl , ISNULL(y.aset_tl,0) aset_tl, ISNULL(z.aset_tll,0) aset_tll FROM (
					SELECT kd_skpd FROM ms_skpd
					) s
					LEFT JOIN
					(
					select b.kd_unit, ISNULL(SUM(debet-kredit),0) real_tl 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='525' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) x
					ON s.kd_skpd=x.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_tl 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,3)='135' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) y
					ON s.kd_skpd=y.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_tll 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,3)='134' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) z
					ON s.kd_skpd=z.kd_unit ) c ) n
					ON q.kd_skpd=n.kd_skpd
					order by q.kd_skpd";
        $usqlsclient1=$this->db->query($usqlsc1);
		
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
			
			
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b15</td>
							</tr>";
		}else{
			$cRet .= "";
		}
			
		//--Batas
			$cRet .= "

							<tr>
								<td align=\"justify\">Realisasi belanja modal harus sama dengan penambahan aset tetap (dan aset lainnya), jika selisih harus dijelaskan di CALK</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Teliti apakah pengungkapan selisih dalam CaLK sudah cukup memadai. Mungkin ada penerimaan hibah berupa aset dan kapitalisasi biaya. Atau ada kesalahan berupa: salah anggaran selain BM ternyata menghasilkan aset atau aset daerah yang baru ditemukan</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
					$sqlsc9="SELECT x.real_al, y.aset_al, z.aset_all FROM (
								select 1 jns, ISNULL(SUM(debet-kredit),0) real_al 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='526' AND b.kd_unit<>'3.13.01.17') x
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_al 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,2)='15' AND b.kd_unit<>'3.13.01.17') y
								ON x.jns=y.jns
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) aset_all 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,2)='15' AND b.kd_unit<>'3.13.01.17') z
								ON y.jns=z.jns";
				$sqlsclient9=$this->db->query($sqlsc9);
				foreach ($sqlsclient9->result() as $rowsc){
					$real_al = $rowsc->real_al;
					$aset_al = $rowsc->aset_al;
					$aset_all = $rowsc->aset_all;
					
					$al_tam_kur=$aset_al-$aset_all;
					$selisih = $real_al-$al_tam_kur;
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
				
				}		
							
					$cRet .= "<tr>
								<td align=\"left\">REALISASI BELANJA MODAL ASET LAINNYA</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($real_al,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PENAMBAHAN(PENURUNAN)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($al_tam_kur,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET LAINNYA $thn</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_al,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">- ASET LAINNYA $cthnsbl</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($aset_all,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>".number_format($selisih,"2",",",".")."</b></td>
							</tr>";
							
		//--PINDAH
		$tombol_b16 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b16\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b16' order by kd_rinci"; */
		$usqlsc1="SELECT q.kd_skpd, q.nm_skpd, q.ket, n.selisih  FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x 
					where kd_skpd<>'3.13.01.17' and kd_rek='b16' AND kd_skpd<>'' ) q
					INNER JOIN (
					SELECT kd_skpd, real_al-(aset_al-aset_all) selisih FROM (
					SELECT s.kd_skpd, ISNULL(x.real_al,0) real_al , ISNULL(y.aset_al,0) aset_al, ISNULL(z.aset_all,0) aset_all FROM (
					SELECT kd_skpd FROM ms_skpd
					) s
					LEFT JOIN
					(
					select b.kd_unit, ISNULL(SUM(debet-kredit),0) real_al 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,3)='526' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) x
					ON s.kd_skpd=x.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_al 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$thn AND LEFT(b.kd_rek5,2)='15' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) y
					ON s.kd_skpd=y.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) aset_all 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)<=$cthnsbl AND LEFT(b.kd_rek5,2)='15' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) z
					ON s.kd_skpd=z.kd_unit ) c ) n
					ON q.kd_skpd=n.kd_skpd
					order by q.kd_skpd";
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b16</td>
							</tr>";
		}else{
			$cRet .= "";
		}
			
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
							<tr>
								<td align=\"left\" colspan=\"3\"><b>2) Analisis horizontal antara LO,Laporan Perubahan Equitas dan Neraca</b></td>
							</tr>                         
							<tr>
								<td align=\"justify\">Ekuitas Awal pada Laporan Perubahan Ekuitas harus sama dengan Ekuitas Akhir pada Neraca Tahun Sebelumnya</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Ekuitas Awal pada Laporan Perubahan Ekuitas = Ekuitas Akhir pada Neraca Tahun Sebelumnya</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
				$sqlsc10="select sum(sal) ek_aw, sum(sal) ek_sbl 
							from (
							select isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
							from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
							where left(kd_rek5,1) in ('8','9') and a.kd_unit<>'3.13.01.17'
							union all
							select isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
							from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
							where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit<>'3.13.01.17'
							union all
							select isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
							from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
							where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit<>'3.13.01.17'
							) a";
							
				$sqlsclient10=$this->db->query($sqlsc10);
				foreach ($sqlsclient10->result() as $rowsc){
					$ek_aw = $rowsc->ek_aw;
					$ek_sbl = $rowsc->ek_sbl;
					
					$selisih = $ek_aw-$ek_sbl;
					
					if($ek_aw<0){
						$ek_aw = $ek_aw*-1;
						$r="(";
						$s=")";
					}else{
						$ek_aw = $ek_aw;
						$r="";
						$s="";
					}
					
					if($ek_sbl<0){
						$ek_sbl = $ek_sbl*-1;
						$t="(";
						$u=")";
					}else{
						$ek_sbl = $ek_sbl;
						$t="";
						$u="";
					}
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
				
				}				
							
				$cRet .= " <tr>
								<td align=\"left\">EKUITAS AWAL(LAPORAN PERUBAHAN EKUITAS)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$r".number_format($ek_aw,"2",",",".")."$s</td>
							</tr>
							<tr>
								<td align=\"left\">EKUITAS AKHIR TAHUN SEBELUMNYA (NERACA)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$t".number_format($ek_sbl,"2",",",".")."$u</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>".number_format($selisih,"2",",",".")."</b></td>
							</tr>";
							
		//--PINDAH
		$tombol_b21 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b21\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b21' order by kd_rinci"; */
		
		$usqlsc1="SELECT w.kd_skpd, w.nm_skpd, w.ket, t.selisih FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b21' ) w
					INNER JOIN
					(
					SELECT p.kd_skpd, ek_aw-ek_sbl selisih FROM (
					SELECT s.kd_skpd, ISNULL(z.ek_aw,0) ek_aw , ISNULL(z.ek_sbl,0) ek_sbl FROM (
					SELECT kd_skpd FROM ms_skpd) s
					LEFT JOIN
					(
					select kd_unit, sum(sal) ek_aw, sum(sal) ek_sbl 
					from (
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					union all
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					union all
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					) a group by kd_unit ) z ON s.kd_skpd=z.kd_unit ) p ) t
					ON w.kd_skpd=t.kd_skpd
					order by w.kd_skpd";
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b21</td>
							</tr>";
		}else{
			$cRet .= "";
		}
		
			
		//--Batas
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
							
							<tr>
								<td align=\"justify\">Surplus/Defisit pada Laporan Operasional harus sama dengan Surplus/Defisit pada Laporan Perubahan Ekuitas</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Surplus/Defisit pada Laporan Operasional = Surplus/Defisit pada Laporan Perubahan Ekuitas</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
				$sqlsc11="SELECT x.pen_lo-y.bel_lo sur_def_lo FROM (
								select 1 jns, ISNULL(SUM(kredit-debet),0) pen_lo 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,1)='8' AND b.kd_unit<>'3.13.01.17') x
								INNER JOIN
								(select 1 jns, ISNULL(SUM(debet-kredit),0) bel_lo 
								from trhju_calk a inner join trdju_calk b 
								on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,1)='9' AND b.kd_unit<>'3.13.01.17') y
								ON x.jns=y.jns";
				$sqlsclient11=$this->db->query($sqlsc11);
				foreach ($sqlsclient11->result() as $rowsc){
					$sur_def_lo = $rowsc->sur_def_lo;
					
					$selisih = $sur_def_lo-$sur_def_lo;
					
					if($sur_def_lo<0){
						$sur_def_lo = $sur_def_lo*-1;
						$c="(";
						$d=")";
					}else{
						$sur_def_lo = $sur_def_lo;
						$c="";
						$d="";
					}
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
				
				}			
							
					$cRet .= "<tr>
								<td align=\"left\">SURPLUS/DEFISIT (LAPORAN OPERASIONAL)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$c".number_format($sur_def_lo,"2",",",".")."$d</td>
							</tr>
							<tr>
								<td align=\"left\">SURPLUS/DEFISIT (LAPORAN PERUBAHAN EKUITAS)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$c".number_format($sur_def_lo,"2",",",".")."$d</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>".number_format($selisih,"2",",",".")."</b></td>
							</tr>";
							
		//--PINDAH
		$tombol_b22 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b22\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b22' order by kd_rinci"; */
		
		$usqlsc1="SELECT p.kd_skpd, p.nm_skpd, p.ket, q.selisih FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b22'
					) p
					INNER JOIN (
					SELECT kd_skpd, (pen_lo-bel_lo)-(pen_lo-bel_lo) selisih FROM (
					SELECT s.kd_skpd, ISNULL(SUM(x.pen_lo),0) pen_lo, ISNULL(SUM(y.bel_lo),0) bel_lo FROM (
					SELECT kd_skpd FROM ms_skpd ) s
					LEFT JOIN
					(
					select b.kd_unit, ISNULL(SUM(kredit-debet),0) pen_lo 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,1)='8' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) x
					ON s.kd_skpd=x.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(SUM(debet-kredit),0) bel_lo 
					from trhju_calk a inner join trdju_calk b 
					on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where YEAR(a.tgl_voucher)=$thn AND LEFT(b.kd_rek5,1)='9' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) y
					ON s.kd_skpd=y.kd_unit
					GROUP BY s.kd_skpd ) m ) q ON p.kd_skpd=q.kd_skpd";
		
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
			
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b22</td>
							</tr>";
		}else{
			$cRet .= "";
		}
		
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
							<tr>
								<td align=\"justify\">Ekuitas Akhir pada Laporan Perubahan Ekuitas harus sama dengan Ekuitas pada Neraca</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Ekuitas Akhir pada Laporan Perubahan Ekuitas = Ekuitas pada Neraca</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
				$sqlsc12="select sum(sal) ekuitas
							from (
							select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
							isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
							from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
							where left(kd_rek5,1) in ('8','9') and a.kd_unit<>'3.13.01.17'
							union all
							select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
							isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
							from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
							where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit<>'3.13.01.17'
							union all
							select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal,
							isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal_lalu 
							from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
							where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit<>'3.13.01.17') x";
				$sqlsclient12=$this->db->query($sqlsc12);
				foreach ($sqlsclient12->result() as $rowsc){
					$ekuitas_ner = $rowsc->ekuitas;
					
					$selisih = $ekuitas_ner-$ekuitas_ner;
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
					
					if($ekuitas_ner<0){
						$ekuitas_ner = $ekuitas_ner*-1;
						$c="(";
						$d=")";
					}else{
						$ekuitas_ner = $ekuitas_ner;
						$c="";
						$d="";
					}
				
				}
				
				$cRet .= "<tr>
								<td align=\"left\">EKUITAS AKHIR(LAPORAN PERUBAHAN EKUITAS)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$c".number_format($ekuitas_ner,"2",",",".")."$d</td>
							</tr>
							<tr>
								<td align=\"left\">EKUITAS (NERACA)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$c".number_format($ekuitas_ner,"2",",",".")."$d</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>$a".number_format($selisih,"2",",",".")."$b</b></td>
							</tr>";
							
		//--PINDAH
		$tombol_b23 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b23\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b23' order by kd_rinci"; */
		$usqlsc1="SELECT w.kd_skpd, w.nm_skpd, w.ket, z.ekuitas-z.ekuitas selisih FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b23'
					) w
					INNER JOIN (
					SELECT s.kd_skpd, ISNULL(ekuitas,0) ekuitas  FROM (
					SELECT kd_skpd FROM ms_skpd ) s
					LEFT JOIN (
					select kd_unit, sum(sal) ekuitas
					from (
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					union all
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit
					union all
					select a.kd_unit, isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit<>'3.13.01.17'
					GROUP BY a.kd_unit) x
					group by kd_unit ) y ON s.kd_skpd=y.kd_unit ) z
					ON w.kd_skpd=z.kd_skpd
					ORDER BY w.kd_skpd";
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b23</td>
							</tr>";
		}else{
			$cRet .= "";
		}
		
			
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
							<tr>
								<td align=\"left\" colspan=\"3\"><b>3) Analisis horizontal antara LO,LRA dan Neraca</b></td>
							</tr>                         
							<tr>
								<td align=\"justify\">Pendapatan Pajak (LO) harus sama dengan Pendapatan Pajak (LRA) dikurangi Piutang Pajak Awal Tahun ditambah Piutang Pajak Akhir Tahun</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Pendapatan Pajak (LO) = Pendapatan Pajak (LRA) - Piutang Pajak Awal Tahun + Piutang Pajak Akhir Tahun</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
				$sqlsc13="SELECT w.pend_pajak_lo, x.pend_pajak_lra, y.piutang_pajak_akhir, z.piutang_pajak_awal*-1 piutang_pajak_awal FROM (
							SELECT 1 jns, ISNULL(SUM(kredit-debet),0) pend_pajak_lo 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE LEFT(kd_rek5,3)='811' AND YEAR(a.tgl_voucher)='$thn' AND b.kd_unit<>'3.13.01.17') w
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(kredit-debet),0) pend_pajak_lra 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE LEFT(kd_rek5,3)='411' AND YEAR(a.tgl_voucher)='$thn' AND b.kd_unit<>'3.13.01.17') x
							ON w.jns=x.jns
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(debet-kredit),0) piutang_pajak_akhir 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE LEFT(kd_rek5,5)='11301' AND YEAR(a.tgl_voucher)<='$thn' AND b.kd_unit<>'3.13.01.17') y
							ON x.jns=y.jns
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(debet-kredit),0) piutang_pajak_awal 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE LEFT(kd_rek5,5)='11301' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND b.kd_unit<>'3.13.01.17') z
							ON y.jns=z.jns";
				$sqlsclient13=$this->db->query($sqlsc13);
				foreach ($sqlsclient13->result() as $rowsc){
					$pend_pajak_lo = $rowsc->pend_pajak_lo;
					$pend_pajak_lra = $rowsc->pend_pajak_lra;
					$piutang_pajak_akhir = $rowsc->piutang_pajak_akhir;
					$piutang_pajak_awal = $rowsc->piutang_pajak_awal;
					
					$selisih = $pend_pajak_lo-($pend_pajak_lra+$piutang_pajak_awal+$piutang_pajak_akhir);
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
					
					if($piutang_pajak_awal<0){
						$piutang_pajak_awal = $piutang_pajak_awal*-1;
						$c="(";
						$d=")";
					}else{
						$piutang_pajak_awal = $piutang_pajak_awal;
						$c="";
						$d="";
					}
				
				}
							
				$cRet .= "	<tr>
								<td align=\"left\">PENDAPATAN PAJAK (LO)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($pend_pajak_lo,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PENDAPATAN PAJAK (LRA)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($pend_pajak_lra,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PIUTANG PAJAK AKHIR TAHUN (NERACA)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($piutang_pajak_akhir,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PIUTANG PAJAK AWAL TAHUN (NERACA)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$c".number_format($piutang_pajak_awal,"2",",",".")."$d</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>$a".number_format($selisih,"2",",",".")."$b</b></td>
							</tr>";
							
		//--PINDAH
		$tombol_b31 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b31\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b31' order by kd_rinci"; */
		
		$usqlsc1="SELECT z.kd_skpd,  z.nm_skpd, z.ket, pend_pajak_lo-(pend_pajak_lra+piutang_pajak_awal+piutang_pajak_akhir) selisih FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket 
					from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b31' ) z
					INNER JOIN 
					(
					SELECT s.kd_skpd, ISNULL(w.pend_pajak_lo,0) pend_pajak_lo, 
									  ISNULL(x.pend_pajak_lra,0) pend_pajak_lra, 
									  ISNULL(y.piutang_pajak_akhir,0) piutang_pajak_akhir, 
									  ISNULL(z.piutang_pajak_awal,0)*-1 piutang_pajak_awal FROM (
					SELECT kd_skpd FROM ms_skpd ) s
					LEFT JOIN
					(
					SELECT b.kd_unit, ISNULL(SUM(kredit-debet),0) pend_pajak_lo 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
					WHERE LEFT(kd_rek5,3)='811' AND YEAR(a.tgl_voucher)='$thn' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) w
					ON s.kd_skpd=w.kd_unit
					LEFT JOIN
					(SELECT b.kd_unit, ISNULL(SUM(kredit-debet),0) pend_pajak_lra 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
					WHERE LEFT(kd_rek5,3)='411' AND YEAR(a.tgl_voucher)='$thn' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) x
					ON s.kd_skpd=x.kd_unit
					LEFT JOIN
					(SELECT b.kd_unit, ISNULL(SUM(debet-kredit),0) piutang_pajak_akhir 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
					WHERE LEFT(kd_rek5,5)='11301' AND YEAR(a.tgl_voucher)<='$thn' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) y
					ON s.kd_skpd=y.kd_unit
					LEFT JOIN
					(SELECT b.kd_unit, ISNULL(SUM(debet-kredit),0) piutang_pajak_awal 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
					WHERE LEFT(kd_rek5,5)='11301' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) z
					ON s.kd_skpd=z.kd_unit ) m
					ON z.kd_skpd=m.kd_skpd
					ORDER BY z.kd_skpd";
		
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b31</td>
							</tr>";
		}else{
			$cRet .= "";
		}
			
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
							
							<tr>
								<td align=\"justify\">Pendapatan Retribusi (LO) harus sama dengan Pendapatan Retribusi (LRA) dikurangi Piutang Retribusi Awal Tahun ditambah Piutang Retribusi Akhir Tahun</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Pendapatan Retribusi (LO) = Pendapatan Retribusi (LRA) - Piutang Retribusi Awal Tahun + Piutang Retribusi Akhir Tahun</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
							
				$sqlsc14="SELECT w.pend_retri_lo, x.pend_retri_lra, y.piutang_retri_akhir, z.piutang_retri_awal*-1 piutang_retri_awal FROM (
							SELECT 1 jns, ISNULL(SUM(kredit-debet),0) pend_retri_lo 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE LEFT(kd_rek5,3)='812' AND YEAR(a.tgl_voucher)='$thn' AND b.kd_unit<>'3.13.01.17') w
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(kredit-debet),0) pend_retri_lra 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE LEFT(kd_rek5,3)='412' AND YEAR(a.tgl_voucher)='$thn' AND b.kd_unit<>'3.13.01.17') x
							ON w.jns=x.jns
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(debet-kredit),0) piutang_retri_akhir 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE LEFT(kd_rek5,5)='11302' AND YEAR(a.tgl_voucher)<='$thn' AND b.kd_unit<>'3.13.01.17') y
							ON x.jns=y.jns
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(debet-kredit),0) piutang_retri_awal 
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
							WHERE LEFT(kd_rek5,5)='11302' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND b.kd_unit<>'3.13.01.17') z
							ON y.jns=z.jns";
				$sqlsclient14=$this->db->query($sqlsc14);
				foreach ($sqlsclient14->result() as $rowsc){
					$pend_retri_lo = $rowsc->pend_retri_lo;
					$pend_retri_lra = $rowsc->pend_retri_lra;
					$piutang_retri_akhir = $rowsc->piutang_retri_akhir;
					$piutang_retri_awal = $rowsc->piutang_retri_awal;
					
					$selisih = $pend_retri_lo-($pend_retri_lra+$piutang_retri_awal+$piutang_retri_akhir);
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
					
					if($piutang_retri_awal<0){
						$piutang_retri_awal = $piutang_retri_awal*-1;
						$c="(";
						$d=")";
					}else{
						$piutang_retri_awal = $piutang_retri_awal;
						$c="";
						$d="";
					}
				
				}
				
				$cRet .= "<tr>
								<td align=\"left\">PENDAPATAN RETRIBUSI (LO)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($pend_retri_lo,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PENDAPATAN RETRIBUSI (LRA)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($pend_retri_lra,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PIUTANG RETRIBUSI AKHIR TAHUN (NERACA)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($piutang_retri_akhir,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PIUTANG RETRIBUSI AWAL TAHUN (NERACA)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$c".number_format($piutang_retri_awal,"2",",",".")."$d</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>$a".number_format($selisih,"2",",",".")."$b</b></td>
							</tr>";
							
		//--PINDAH
		$tombol_b32 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b32\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b32' order by kd_rinci"; */
		
		$usqlsc1="SELECT z.kd_skpd, z.nm_skpd, z.ket, pend_retri_lo-(pend_retri_lra+piutang_retri_awal+piutang_retri_akhir) selisih FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket 
					from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b32' ) z
					INNER JOIN 
					(
					SELECT s.kd_skpd, ISNULL(w.pend_retri_lo,0) pend_retri_lo, 
									  ISNULL(x.pend_retri_lra,0) pend_retri_lra, 
									  ISNULL(y.piutang_retri_akhir,0) piutang_retri_akhir, 
									  ISNULL(z.piutang_retri_awal,0)*-1 piutang_retri_awal FROM (
					SELECT kd_skpd FROM ms_skpd ) s
					LEFT JOIN
					(
					SELECT b.kd_unit, ISNULL(SUM(kredit-debet),0) pend_retri_lo 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
					WHERE LEFT(kd_rek5,3)='812' AND YEAR(a.tgl_voucher)='$thn' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) w
					ON s.kd_skpd=w.kd_unit
					LEFT JOIN
					(SELECT b.kd_unit, ISNULL(SUM(kredit-debet),0) pend_retri_lra 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
					WHERE LEFT(kd_rek5,3)='412' AND YEAR(a.tgl_voucher)='$thn' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) x
					ON s.kd_skpd=x.kd_unit
					LEFT JOIN
					(SELECT b.kd_unit, ISNULL(SUM(debet-kredit),0) piutang_retri_akhir 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
					WHERE LEFT(kd_rek5,5)='11302' AND YEAR(a.tgl_voucher)<='$thn' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) y
					ON s.kd_skpd=y.kd_unit
					LEFT JOIN
					(SELECT b.kd_unit, ISNULL(SUM(debet-kredit),0) piutang_retri_awal 
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_unit
					WHERE LEFT(kd_rek5,5)='11302' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND b.kd_unit<>'3.13.01.17'
					GROUP BY b.kd_unit) z
					ON s.kd_skpd=z.kd_unit ) m
					ON z.kd_skpd=m.kd_skpd
					ORDER BY z.kd_skpd";
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b32</td>
							</tr>";
		}else{
			$cRet .= "";
		}
			
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
							
							<tr>
								<td align=\"justify\">Beban Persediaan (LO) harus sama dengan Belanja Barang dan Jasa Persediaan (LRA) ditambah Persediaan Awal Tahun dikurangi Persdiaan Akhir Tahun</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Beban Persediaan(LO)=Belanja Barang dan Jasa Persediaan (LRA)+Persediaan Awal Tahun-Persediaan Akhir Tahun.Perhatikan cara penilaian persediaan: FIFO atau <i>weighted average</i></td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
				
				$sqlsc15="SELECT x.beban_persediaan, t.belanja_persediaan, y.persediaan_awal, z.persediaan_akhir*-1 persediaan_akhir , r.persediaan_lain_awal, s.persediaan_lain_akhir*-1  persediaan_lain_akhir
							FROM (
							select 1 jns, ISNULL(sum(b.debet-b.kredit),0) beban_persediaan 
							from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where b.kd_rek5 IN ($kd_rek92) 
							AND b.kd_unit<>'3.13.01.17' AND YEAR(tgl_voucher)='$thn') x
							INNER JOIN
							(select 1 jns, ISNULL(sum(b.debet-b.kredit),0) belanja_persediaan 
								from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
								where b.kd_rek5 IN ($kd_rek52) 
								AND b.kd_unit<>'3.13.01.17' AND YEAR(tgl_voucher)='$thn') t
							ON x.jns=t.jns
							INNER JOIN
							(select 1 jns, ISNULL(sum(b.debet-b.kredit),0) persediaan_awal 
							from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('117') and left(b.kd_rek5,5)<>'11703'
							AND b.kd_unit<>'3.13.01.17' AND YEAR(tgl_voucher)<='$cthnsbl') y
							ON x.jns=y.jns
							INNER JOIN
							(select 1 jns, ISNULL(sum(b.debet-b.kredit),0) persediaan_akhir 
							from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
							where LEFT(b.kd_rek5,3) IN ('117') and left(b.kd_rek5,5)<>'11703'
							AND b.kd_unit<>'3.13.01.17' AND YEAR(tgl_voucher)<='$thn') z
							ON y.jns=z.jns
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(sal_awal),0) persediaan_lain_awal 
							FROM lamp_aset 
							WHERE kd_skpd<>'3.13.01.17' AND left(kd_rek5,5)='11703') r
							ON z.jns=r.jns
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(sal_awal+tambah-kurang+tahun_n+(kormin-korplus)),0) persediaan_lain_akhir 
							FROM lamp_aset 
							WHERE kd_skpd<>'3.13.01.17' AND left(kd_rek5,5)='11703') s
							ON r.jns=s.jns";
				$sqlsclient15=$this->db->query($sqlsc15);
				foreach ($sqlsclient15->result() as $rowsc){
					$beban_persediaan = $rowsc->beban_persediaan;
					$belanja_persediaan = $rowsc->belanja_persediaan;
					$persediaan_awal = $rowsc->persediaan_awal;
					$persediaan_akhir = $rowsc->persediaan_akhir;
					$persediaan_lain_awal = $rowsc->persediaan_lain_awal;
					$persediaan_lain_akhir = $rowsc->persediaan_lain_akhir;
					
					$selisih = $beban_persediaan-($belanja_persediaan+$persediaan_awal+$persediaan_akhir+$persediaan_lain_awal+$persediaan_lain_akhir);
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
					
					if($persediaan_akhir<0){
						$persediaan_akhir = $persediaan_akhir*-1;
						$c="(";
						$d=")";
					}else{
						$persediaan_akhir = $persediaan_akhir;
						$c="";
						$d="";
					}
					
					if($persediaan_lain_akhir<0){
						$persediaan_lain_akhir = $persediaan_lain_akhir*-1;
						$e="(";
						$f=")";
					}else{
						$persediaan_lain_akhir = $persediaan_lain_akhir;
						$e="";
						$f="";
					}
				
				}
					
				$cRet .= "<tr>
								<td align=\"left\">BEBAN PERSEDIAAN (LO)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($beban_persediaan,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">BELANJA BARANG DAN JASA - PERSEDIAAN (LRA)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($belanja_persediaan,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PERSEDIAAN AWAL TAHUN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($persediaan_awal,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PERSEDIAAN AKHIR TAHUN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$c".number_format($persediaan_akhir,"2",",",".")."$d</td>
							</tr>
							<tr>
								<td align=\"left\">PERSEDIAAN LAIN LAIN AWAL TAHUN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($persediaan_lain_awal,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">PERSEDIAAN LAIN LAIN AKHIR TAHUN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$e".number_format($persediaan_lain_akhir,"2",",",".")."$f</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>$a".number_format($selisih,"2",",",".")."$b</b></td>
							</tr>";
							
		//--PINDAH
		$tombol_b33 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b33\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b33' order by kd_rinci"; */
		
		$usqlsc1="SELECT a.kd_skpd, a.nm_skpd, a.ket, b.selisih FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b33' ) a
					INNER JOIN (
					SELECT kd_skpd, beban_persediaan-(belanja_persediaan+persediaan_awal+persediaan_akhir+persediaan_lain_awal+persediaan_lain_akhir) selisih 
					FROM (
					SELECT m.kd_skpd, ISNULL(x.beban_persediaan,0) beban_persediaan, ISNULL(t.belanja_persediaan,0) belanja_persediaan, ISNULL(y.persediaan_awal,0) persediaan_awal, ISNULL(z.persediaan_akhir,0)*-1 persediaan_akhir , ISNULL(r.persediaan_lain_awal,0) persediaan_lain_awal, ISNULL(s.persediaan_lain_akhir,0)*-1 persediaan_lain_akhir
					FROM (
					SELECT kd_skpd FROM ms_skpd ) m
					LEFT JOIN
					(
					select b.kd_unit, ISNULL(sum(b.debet-b.kredit),0) beban_persediaan 
					from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where b.kd_rek5 IN ('9120101','9120102','9120103','9120104','9120105','9120106','9120107','9120108','9120109','9120201','9120202','9120203','9120204','9120205','9120206','9120207','9120601','9122000','9122002','9122001','9122101','9123001') 
					AND b.kd_unit<>'3.13.01.17' AND YEAR(tgl_voucher)='$thn'
					GROUP BY b.kd_unit) x
					ON m.kd_skpd=x.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(sum(b.debet-b.kredit),0) belanja_persediaan 
					from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where b.kd_rek5 IN ('5122001','5120101','5120102','5120103','5120104','5120105','5120106','5120107','5120108','5120109','5120201','5120202','5120203','5120204','5120205','5120206','5120207','5120601','5122000','5122002','5122101') 
					AND b.kd_unit<>'3.13.01.17' AND YEAR(tgl_voucher)='$thn'
					GROUP BY b.kd_unit) t
					ON m.kd_skpd=t.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(sum(b.debet-b.kredit),0) persediaan_awal 
					from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where LEFT(b.kd_rek5,3) IN ('117') and left(b.kd_rek5,5)<>'11703'
					AND b.kd_unit<>'3.13.01.17' AND YEAR(tgl_voucher)<='$cthnsbl'
					GROUP BY b.kd_unit) y
					ON m.kd_skpd=y.kd_unit
					LEFT JOIN
					(select b.kd_unit, ISNULL(sum(b.debet-b.kredit),0) persediaan_akhir 
					from trhju_calk a inner join trdju_calk b on a.kd_skpd=b.kd_unit and a.no_voucher=b.no_voucher
					where LEFT(b.kd_rek5,3) IN ('117') and left(b.kd_rek5,5)<>'11703'
					AND b.kd_unit<>'3.13.01.17' AND YEAR(tgl_voucher)<='$thn'
					GROUP BY b.kd_unit) z
					ON m.kd_skpd=z.kd_unit
					LEFT JOIN
					(SELECT kd_skpd, ISNULL(SUM(sal_awal),0) persediaan_lain_awal 
					FROM lamp_aset 
					WHERE kd_skpd<>'3.13.01.17' AND left(kd_rek5,5)='11703'
					GROUP BY kd_skpd) r
					ON m.kd_skpd=r.kd_skpd
					LEFT JOIN
					(SELECT kd_skpd, ISNULL(SUM(sal_awal+tambah-kurang+tahun_n+(kormin-korplus)),0) persediaan_lain_akhir 
					FROM lamp_aset 
					WHERE kd_skpd<>'3.13.01.17' AND left(kd_rek5,5)='11703'
					GROUP BY kd_skpd) s
					ON m.kd_skpd=s.kd_skpd ) z ) b ON a.kd_skpd=b.kd_skpd
					ORDER BY kd_skpd";
        $usqlsclient1=$this->db->query($usqlsc1);
		
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b33</td>
							</tr>";
		}else{
			$cRet .= "";
		}
		
			
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
							
							<tr>
								<td align=\"justify\">Beban Penyusutan (LO) harus sama dengan Akumulasi Penyusutan Akhir Tahun dikurangi Akumulasi Penyusutan Akhir Tahun dikurangi Akumulasi Penyusutan Awal Tahun</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"justify\">Beban Penyusutan(LO) = Akumulasi Penyusutan Akhir Tahun - Akumulasi Penyusutan Awal Tahun</td>
							</tr> 
							<tr>
								<td align=\"left\">RUMUS</td>
								<td align=\"center\">&nbsp;</td>
								<td align=\"left\">&nbsp;</td>
							</tr>";
					
				$sqlsc16="SELECT x.penyu_lo, y.akum_penyu_ak, z.akum_penyu_aw, r.akum_amor_ak*-1 akum_amor_ak, s.akum_amor_aw 
							FROM (
							SELECT 1 jns, ISNULL(SUM(debet-kredit),0) penyu_lo
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
							WHERE b.kd_unit<>'3.13.01.17' AND YEAR(a.tgl_voucher)='$thn' AND LEFT(b.kd_rek5,3)='917') x
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(kredit-debet),0) akum_penyu_ak
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
							WHERE b.kd_unit<>'3.13.01.17' AND YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,3)='137') y
							ON x.jns=y.jns
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(kredit-debet),0) akum_penyu_aw
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
							WHERE b.kd_unit<>'3.13.01.17' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,3)='137') z
							ON y.jns=z.jns
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(kredit-debet),0) akum_amor_ak
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
							WHERE b.kd_unit<>'3.13.01.17' AND YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,5)='15306') r
							ON z.jns=r.jns
							INNER JOIN
							(SELECT 1 jns, ISNULL(SUM(kredit-debet),0) akum_amor_aw
							FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
							WHERE b.kd_unit<>'3.13.01.17' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,5)='15306') s
							ON r.jns=s.jns";
				$sqlsclient16=$this->db->query($sqlsc16);
				foreach ($sqlsclient16->result() as $rowsc){
					$penyu_lo = $rowsc->penyu_lo;
					$akum_penyu_ak = $rowsc->akum_penyu_ak;
					$akum_penyu_aw = $rowsc->akum_penyu_aw;
					$akum_amor_ak = $rowsc->akum_amor_ak;
					$akum_amor_aw = $rowsc->akum_amor_aw;
					
					$selisih = $penyu_lo-($akum_penyu_ak-$akum_penyu_aw-$akum_amor_ak-$akum_amor_aw);
					
					if($selisih<0){
						$selisih = $selisih*-1;
						$a="(";
						$b=")";
					}else{
						$selisih = $selisih;
						$a="";
						$b="";
					}
					
					if($akum_amor_ak<0){
						$akum_amor_ak = $akum_amor_ak*-1;
						$c="(";
						$d=")";
					}else{
						$akum_amor_ak = $akum_amor_ak;
						$c="";
						$d="";
					}
				
				}
					
				 $cRet .= "<tr>
								<td align=\"left\">BEBAN PENYUSUTAN (LO)</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($penyu_lo,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">AKUMULASI PENYUSUTAN AKHIR TAHUN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($akum_penyu_ak,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">AKUMULASI PENYUSUTAN AWAL TAHUN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($akum_penyu_aw,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"left\">AKUMULASI AMORTISASI AKHIR TAHUN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">$c".number_format($akum_amor_ak,"2",",",".")."$d</td>
							</tr>
							<tr>
								<td align=\"left\">AKUMULASI AMORTISASI AWAL TAHUN</td>
								<td align=\"center\">:</td>
								<td align=\"right\">".number_format($akum_amor_aw,"2",",",".")."</td>
							</tr>
							<tr>
								<td align=\"center\"><b>Selisih</b></td>
								<td align=\"center\"><b>:</b></td>
								<td align=\"right\"><b>$a".number_format($selisih,"2",",",".")."$b</b></td>
							</tr>";
							
		//--PINDAH
		$tombol_b34 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp1_b34\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit Penjelasan\">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$ket='';
		/* $usqlsc1="SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b34' order by kd_rinci"; */
		$usqlsc1="SELECT t.kd_skpd, t.nm_skpd, t.ket, w.selisih FROM (
					SELECT kd_skpd, (SELECT nm_skpd FROM ms_skpd WHERE kd_skpd=x.kd_skpd) nm_skpd, ket from isi_analisis_calk x where kd_skpd<>'3.13.01.17' and kd_rek='b34' ) t
					INNER JOIN
					(
					SELECT kd_skpd, penyu_lo-(akum_penyu_ak-akum_penyu_aw-akum_amor_ak-akum_amor_aw) selisih FROM (
					SELECT s.kd_skpd, ISNULL(x.penyu_lo,0) penyu_lo, ISNULL(y.akum_penyu_ak,0) akum_penyu_ak, ISNULL(z.akum_penyu_aw,0) akum_penyu_aw, ISNULL(r.akum_amor_ak,0)*-1 akum_amor_ak, ISNULL(m.akum_amor_aw,0) akum_amor_aw 
					FROM (
					SELECT kd_skpd FROM ms_skpd ) s
					LEFT JOIN
					(
					SELECT b.kd_unit, ISNULL(SUM(debet-kredit),0) penyu_lo
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
					WHERE b.kd_unit<>'3.13.01.17' AND YEAR(a.tgl_voucher)='$thn' AND LEFT(b.kd_rek5,3)='917'
					GROUP BY b.kd_unit) x
					ON s.kd_skpd=x.kd_unit
					LEFT JOIN
					(SELECT b.kd_unit, ISNULL(SUM(kredit-debet),0) akum_penyu_ak
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
					WHERE b.kd_unit<>'3.13.01.17' AND YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,3)='137'
					GROUP BY b.kd_unit) y
					ON s.kd_skpd=y.kd_unit
					INNER JOIN
					(SELECT b.kd_unit, ISNULL(SUM(kredit-debet),0) akum_penyu_aw
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
					WHERE b.kd_unit<>'3.13.01.17' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,3)='137'
					GROUP BY b.kd_unit) z
					ON s.kd_skpd=z.kd_unit
					INNER JOIN
					(SELECT b.kd_unit, ISNULL(SUM(kredit-debet),0) akum_amor_ak
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
					WHERE b.kd_unit<>'3.13.01.17' AND YEAR(a.tgl_voucher)<='$thn' AND LEFT(b.kd_rek5,5)='15306'
					GROUP BY b.kd_unit) r
					ON s.kd_skpd=r.kd_unit
					INNER JOIN
					(SELECT b.kd_unit, ISNULL(SUM(kredit-debet),0) akum_amor_aw
					FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher
					WHERE b.kd_unit<>'3.13.01.17' AND YEAR(a.tgl_voucher)<='$cthnsbl' AND LEFT(b.kd_rek5,5)='15306'
					GROUP BY b.kd_unit) m
					ON s.kd_skpd=m.kd_unit ) z ) w
					ON t.kd_skpd=w.kd_skpd
					ORDER BY kd_skpd";
        $usqlsclient1=$this->db->query($usqlsc1);
		foreach ($usqlsclient1->result() as $rowsc){
			$kd_skpd = $rowsc->kd_skpd;
			$nm_skpd = $rowsc->nm_skpd;
			$ket1 = $rowsc->ket;
			$selisih_all = $rowsc->selisih;
		
			if($ket1<>''){
				$ket = $ket1;
			}else{
				$ket = $ket;
			}
			
			$cRet .= "	<tr>
							 <td align=\"justify\" colspan=\"2\">$kd_skpd - $nm_skpd, $ket</td>
							 <td align=\"right\" valign=\"bottom\">".number_format($selisih_all,"2",",",".")."</td>
						</tr>";
		}
		
		if($jnsctk==1){
			$cRet .= "<tr>
								<td align=\"justify\" colspan=\"3\">$tombol_b34</td>
							</tr>";
		}else{
			$cRet .= "";
		}
		
			
		//--Batas
			$cRet .= "
							<tr>
								<td align=\"justify\" colspan=\"3\">&nbsp;</td>
							</tr>
				  </table>";
		
		$cRet .= "</table>";
		
	    $data['prev']= $cRet;
        $judul  = ("ANALISIS_$kd_skpd");
        $this->template->set('title', 'ANALISIS $kd_skpd');        
        
		switch($print) {       
        case 1;
			echo ("<title>BAB III</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }
	
	
	function calk_lamp2(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp2',$data) ; 
    }
	
	function calk_lamp1_a11(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_a11',$data) ; 
    }
	
	function calk_lamp1_a21(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_a21',$data) ; 
    }
	
	function calk_lamp1_a22(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_a22',$data) ; 
    }
	
	function calk_lamp1_a31(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_a31',$data) ; 
    }
	
	function calk_lamp1_a41(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_a41',$data) ; 
    }
	
	function calk_lamp1_b11(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b11',$data) ; 
    }
	
	function calk_lamp1_b12(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b12',$data) ; 
    }
	
	function calk_lamp1_b13(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b13',$data) ; 
    }
	
	function calk_lamp1_b14(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b14',$data) ; 
    }
	
	function calk_lamp1_b15(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b15',$data) ; 
    }
	
	function calk_lamp1_b16(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b16',$data) ; 
    }
	
	function calk_lamp1_b21(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b21',$data) ; 
    }
	
	function calk_lamp1_b22(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b22',$data) ; 
    }
	
	function calk_lamp1_b23(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b23',$data) ; 
    }
	
	
	function calk_lamp1_b31(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b31',$data) ; 
    }
	
	function calk_lamp1_b32(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b32',$data) ; 
    }
	
	function calk_lamp1_b33(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b33',$data) ; 
    }
	
	function calk_lamp1_b34(){
        $data['page_title']= 'CALK NERACA';
        $this->template->set('title', 'CALK NERACA');   
        $this->template->load('template','calk/calk_lamp1_b34',$data) ; 
    }
	
	function cetak_penyajian_data($dcetak='',$ttd='',$kd_skpd='',$jnsctk='',$judul=''){
		$thn	 = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;
		$cthnsbl2 = $cthnsbl-1;
		
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd'";
        $sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$nmskpd = $rowsc->nm_skpd;
		} 
		$nm_skpd = strtoupper($nmskpd);	
	
		$tombol_lamp2 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lamp2\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
		
		$cRet = '';
		
		//mulai
		
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
							<tr><td align=\"right\">Lampiran 2</td></tr>                         
							<tr><td align=\"center\"><strong>PENJELASAN ATAS PENYAJIAN DATA REALISASI BELANJA MODAL TAHUN ANGGARAN $thn</strong></td></tr>                         
						    <tr><td align=\"center\"><strong>YANG DICATAT SEBAGAI REALISASI PADA NERACA TAHUN $thn</strong></td></tr>
							<tr><td align=\"center\"><strong>&nbsp;</strong></td></tr>							
							<tr><td align=\"left\"><strong>SKPD : $kd_skpd - $nm_skpd</strong></td></tr>                         
				  </table><br>";
		
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
							<tr>
								<td rowspan=\"2\" width=\"5%\" align=\"center\"><b>NO</b></td>
								<td rowspan=\"2\" width=\"15%\" align=\"center\"><b>URAIAN</b></td>
								<td colspan=\"2\" width=\"30%\" align=\"center\"><b>REALISASI $thn</b></td>
								<td rowspan=\"2\" width=\"20%\" align=\"center\"><b>SELISIH</b></td>
								<td colspan=\"2\" width=\"30%\" align=\"center\"><b>KETERANGAN</b></td>
							</tr>
							<tr>
								<td align=\"center\" ><b>BELANJA MODAL</b></td>
								<td align=\"center\"><b>NERACA</b></td>
								<td align=\"center\"><b>Nilai</b></td>
								<td align=\"center\"><b>Penjelasan</b></td>
							</tr>";
		
		$no=1;
		$tot_belanja_modal=0;
		$tot_neraca=0;
		$tot_neraca=0;
		$tot_selisih=0;
		$tot_nilai=0;
				
		$sqlsc="SELECT 1 kode, 131 rek, x.uraian, y.tot_belanja_modal, z.tot_neraca, y.tot_belanja_modal-z.tot_neraca selisih, 0 nilai, '' ket, '' kd_rinci FROM (
				SELECT 1 jns, 'Tanah' uraian) x
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(debet-kredit),0) tot_belanja_modal FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)='$thn' AND LEFT(b.kd_rek5,3)='521') y ON x.jns=y.jns
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(tahun_n),0) tot_neraca FROM lamp_aset WHERE kd_skpd='$kd_skpd' AND kd_rek3='131') z ON x.jns=z.jns
				UNION ALL
				SELECT 2 kode, 131 rek, '' uraian, 0 tot_belanja_modal, 0 tot_neraca, 0 selisih,  nilai, ket, kd_rinci 
				FROM isi_analisis_calk WHERE kd_skpd='$kd_skpd' AND kd_rek='131'

				UNION ALL
				SELECT 1 kode, 132 rek, x.uraian, y.tot_belanja_modal, z.tot_neraca, y.tot_belanja_modal-z.tot_neraca selisih, 0 nilai, '' ket, '' kd_rinci FROM (
				SELECT 1 jns, 'Peralatan dan Mesin' uraian) x
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(debet-kredit),0) tot_belanja_modal FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)='$thn' AND LEFT(b.kd_rek5,3)='522') y ON x.jns=y.jns
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(tahun_n),0) tot_neraca FROM lamp_aset WHERE kd_skpd='$kd_skpd' AND kd_rek3='132') z ON x.jns=z.jns
				UNION ALL
				SELECT 2 kode, 132 rek, '' uraian, 0 tot_belanja_modal, 0 tot_neraca, 0 selisih,  nilai, ket, kd_rinci 
				FROM isi_analisis_calk WHERE kd_skpd='$kd_skpd' AND kd_rek='132'
				
				UNION ALL
				SELECT 1 kode, 133 rek, x.uraian, y.tot_belanja_modal, z.tot_neraca, y.tot_belanja_modal-z.tot_neraca selisih, 0 nilai, '' ket, '' kd_rinci FROM (
				SELECT 1 jns, 'Gedung dan Bangunan' uraian) x
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(debet-kredit),0) tot_belanja_modal FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)='$thn' AND LEFT(b.kd_rek5,3)='523') y ON x.jns=y.jns
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(tahun_n),0) tot_neraca FROM lamp_aset WHERE kd_skpd='$kd_skpd' AND kd_rek3='133') z ON x.jns=z.jns
				UNION ALL
				SELECT 2 kode, 133 rek, '' uraian, 0 tot_belanja_modal, 0 tot_neraca, 0 selisih,  nilai, ket, kd_rinci 
				FROM isi_analisis_calk WHERE kd_skpd='$kd_skpd' AND kd_rek='133'
				
				
				UNION ALL
				SELECT 1 kode, 134 rek, x.uraian, y.tot_belanja_modal, z.tot_neraca, y.tot_belanja_modal-z.tot_neraca selisih, 0 nilai, '' ket, '' kd_rinci FROM (
				SELECT 1 jns, 'Jalan, Irigasi dan Jaringan' uraian) x
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(debet-kredit),0) tot_belanja_modal FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)='$thn' AND LEFT(b.kd_rek5,3)='524') y ON x.jns=y.jns
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(tahun_n),0) tot_neraca FROM lamp_aset WHERE kd_skpd='$kd_skpd' AND kd_rek3='134') z ON x.jns=z.jns
				UNION ALL
				SELECT 2 kode, 134 rek, '' uraian, 0 tot_belanja_modal, 0 tot_neraca, 0 selisih,  nilai, ket, kd_rinci 
				FROM isi_analisis_calk WHERE kd_skpd='$kd_skpd' AND kd_rek='134'
				
				
				UNION ALL
				SELECT 1 kode, 135 rek, x.uraian, y.tot_belanja_modal, z.tot_neraca, y.tot_belanja_modal-z.tot_neraca selisih, 0 nilai, '' ket, '' kd_rinci FROM (
				SELECT 1 jns, 'Aset Tetap Lainnya' uraian) x
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(debet-kredit),0) tot_belanja_modal FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)='$thn' AND LEFT(b.kd_rek5,3)='525') y ON x.jns=y.jns
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(tahun_n),0) tot_neraca FROM lamp_aset WHERE kd_skpd='$kd_skpd' AND kd_rek3='135') z ON x.jns=z.jns
				UNION ALL
				SELECT 2 kode, 135 rek, '' uraian, 0 tot_belanja_modal, 0 tot_neraca, 0 selisih,  nilai, ket, kd_rinci 
				FROM isi_analisis_calk WHERE kd_skpd='$kd_skpd' AND kd_rek='135'
				
				UNION ALL
				SELECT 1 kode, 136 rek, x.uraian, y.tot_belanja_modal, z.tot_neraca, y.tot_belanja_modal-z.tot_neraca selisih, 0 nilai, '' ket, '' kd_rinci FROM (
				SELECT 1 jns, 'Aset Lainnya' uraian) x
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(debet-kredit),0) tot_belanja_modal FROM trhju_calk a INNER JOIN trdju_calk b ON a.kd_skpd=b.kd_unit AND a.no_voucher=b.no_voucher WHERE b.kd_unit='$kd_skpd' AND YEAR(a.tgl_voucher)='$thn' AND LEFT(b.kd_rek5,3)='526') y ON x.jns=y.jns
				INNER JOIN
				(SELECT 1 jns, ISNULL(SUM(tahun_n),0) tot_neraca FROM lamp_aset WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek3,2)='15') z ON x.jns=z.jns
				UNION ALL
				SELECT 2 kode, 136 rek, '' uraian, 0 tot_belanja_modal, 0 tot_neraca, 0 selisih,  nilai, ket, kd_rinci 
				FROM isi_analisis_calk WHERE kd_skpd='$kd_skpd' AND kd_rek='136'
				ORDER BY rek, kode, kd_rinci";
        $sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$kode          = $rowsc->kode;
			$uraian        = $rowsc->uraian;
			$belanja_modal = $rowsc->tot_belanja_modal;
			$neraca        = $rowsc->tot_neraca;
			$selisih       = $rowsc->selisih;
			$nilai         = $rowsc->nilai;
			$ket           = $rowsc->ket;
			
			if($selisih<0){
				$num_selisih = $selisih*-1;
				$a="(";
				$b=")";
			}else{
				$num_selisih = $selisih;
				$a="";
				$b="";
			}
			
			if($nilai<0){
				$num_nilai = $nilai*-1;
				$c="(";
				$d=")";
			}else{
				$num_nilai = $nilai;
				$c="";
				$d="";
			}
			
			if($kode==1){
				$cRet .= "<tr>
								<td align=\"center\" >".$no++."</td>
								<td align=\"left\" >$uraian</td>
								<td align=\"right\" >".number_format($belanja_modal,"2",",",".")."</td>
								<td align=\"right\" >".number_format($neraca,"2",",",".")."</td>
								<td align=\"right\" >$a".number_format($num_selisih,"2",",",".")."$b</td>
								<td align=\"right\" ></td>
								<td align=\"justify\" ></td>
							</tr>";
			}else{
				$cRet .= "<tr>
								<td align=\"center\" style=\"border-top:hidden;\"></td>
								<td align=\"left\" style=\"border-top:hidden;\"></td>
								<td align=\"right\" style=\"border-top:hidden;\"></td>
								<td align=\"right\" style=\"border-top:hidden;\"></td>
								<td align=\"right\" style=\"border-top:hidden;\"></td>
								<td align=\"right\" style=\"border-top:hidden;\">$c".number_format($num_nilai,"2",",",".")."$d</td>
								<td align=\"justify\" style=\"border-top:hidden;\">$ket</td>
							</tr>";
			}
			
							
			
			$tot_belanja_modal=$tot_belanja_modal+$belanja_modal;
			$tot_neraca=$tot_neraca+$neraca;
			$tot_selisih=$tot_selisih+$selisih;
			$tot_nilai=$tot_nilai+$nilai;
			
			if($tot_selisih<0){
				$num_tot_selisih = $tot_selisih*-1;
				$x="(";
				$y=")";
			}else{
				$num_tot_selisih = $tot_selisih;
				$x="";
				$y="";
			}
		
		} 					
				  $cRet .= "<tr>
								<td align=\"center\" colspan=\"2\"><b>Jumlah</b></td>
								<td align=\"right\" ><b>".number_format($tot_belanja_modal,"2",",",".")."</b></td>
								<td align=\"right\" ><b>".number_format($tot_neraca,"2",",",".")."</b></td>
								<td align=\"right\" ><b>$x".number_format($num_tot_selisih,"2",",",".")."$y</b></td>
								<td align=\"right\" ><b>".number_format($tot_nilai,"2",",",".")."</b></td>
								<td align=\"justify\" ></td>
							</tr>
				  </table>";
		
		$cRet .= "</table>";
		
		if($jnsctk==1){
			$cRet .= "$tombol_lamp2";
		}else{
			$cRet .= "";
		}
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("ANALISIS $kd_skpd /");
        $this->template->set('title', 'ANALISIS $kd_skpd');        
        
		$pilih=1;
		switch($pilih) {       
        case 1;
			echo ("<title>BAB III</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }
	
	
	
	function cetak_babIII_lpe($dcetak='',$ttd='',$kd_skpd='',$jnsctk='',$judul=''){
		$spasi = "line-height: 1.5em;";
		$thn	 = $this->session->userdata('pcThang');
		$cthnsbl = $thn-1;
		$cbulan  = substr($dcetak,5,2);
		$cbulan2 = 12;
	
		if($jnsctk==1){
			$bg_color = "bgcolor=\"yellow\"";
			$tombol_314 = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_lpe_314\" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp;
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
        }else{
			$bg_color = "";
			$tombol_314 = "";
		}
		
	
	
	
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd'";
        $sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$nmskpd = $rowsc->nm_skpd;
		} 
		$nm_skpd = strtoupper($nmskpd);	
	
		$lcttd = str_replace('a',' ',$ttd);
		$sqlsc ="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc){
			$kab     = $rowsc->kab_kota;
			$prov    = $rowsc->provinsi;
			$daerah  = $rowsc->daerah;
			//$thn     = $rowsc->thn_ang;
		}
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd){
			$nip      =$rowttd->nip;                    
			$nama_ttd = $rowttd->nm;
			$jabatan  = $rowttd->jab;
		}
		
		$cRet = '';
		
		//mulai
		if($judul=='2'){
				$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
                        <td align=\"center\"><strong>BAB III  PENJELASAN POS-POS LAPORAN KEUANGAN</strong></td>                         
                    </tr>
				 </table><br>";
				
				$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\"  width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						 <td align=\"left\" width=\"2%\"><strong>3.1</strong></td>                         
						 <td align=\"left\" colspan=\"2\"><strong>Rincian dan Penjelasan masing-masing pos-pos laporan Keuangan SKPD.</strong></td>                         
					</tr></table>";
		}
		
		
		$cRet .= "<table style=\"border-collapse:collapse;".$spasi."\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
							<tr>
								 <td align=\"left\" width=\"2%\"><strong>&nbsp;</strong></td>                         
								 <td align=\"left\" width=\"4%\"><strong>3.1.4</strong></td>                         
								 <td align=\"left\" colspan=\"5\"><strong>Penjelasan atas Laporan Perubahan Ekuitas</strong></td>                         
							</tr>";
			
			
		// 3.1.4 Ekuitas Awal
		$sql_12 = "	select '1' reff, 'Ekuitas Awal' uraian, sum(sal) sal from (
					select isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<'$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit='$kd_skpd'
					) a";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong></strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>
							 <td align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
						</tr>";
			}
			
			// 3.1.4 Surplus/ Defisit - LO
		$sql_12 = "	select '2' reff, 'Surplus/ Defisit - LO' uraian, isnull(sum(kredit-debet),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong></strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>
							 <td align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
						</tr>";
			}
			
			// 3.1.4 Rincian Surplus/ Defisit - LO
		$sql_12 = "	select '2.1' reff, 'Surplus/defisit kegiatan operasional' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3) in ('811','812','813','814','831','832','833','911','912','913','914','915','916','917','918','919','921','922','923','924','925','926') and a.kd_unit='$kd_skpd'
					union all
					select '2.2' reff, 'Surplus/defisit kegiatan Non operasional' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3) in ('841','842','843','931','932','933') and a.kd_unit='$kd_skpd'
					union all
					select '2.3' reff, 'Pos Luar Biasa' uraian, 
					isnull(sum(case when YEAR(tgl_voucher)='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,3) in ('851','941') and a.kd_unit='$kd_skpd'
					";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\"></td>
							 <td align=\"left\">$reff $uraian</td>
							 <td align=\"right\">$a$real_sal$b</td>
						</tr>";
			}
			
			// 3.1.4 Dampak Kumulatif Perubahan Kebijakan/ Kesalahan mendasar :
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong></strong></td>                         
							 <td align=\"left\"><strong>3</strong></td>
							 <td align=\"left\" colspan=\"4\"><strong>Dampak Kumulatif Perubahan Kebijakan/ Kesalahan mendasar :</strong></td>
						</tr>
						<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong></strong></td>                         
							 <td align=\"left\"></td>
							 <td align=\"justify\" colspan=\"4\">Koreksi yang langsung menambah/mengurangi ekuitas, yang antara lain berasal dari dampak kumulatif yang disebabkan oleh perubahan kebijakan akuntansi dan koreksi kesalahan mendasar, seperti:</td>
						</tr>";
			
			
			// 3.1.4 Koreksi Nilai Persediaan 
		$sql_12 = "	select '3.1' reff, 'Koreksi Nilai Persediaan' uraian, 
					isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='2' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				$prv = $this->db->query("SELECT x.kd_rek, x.nm_rek, y.ket FROM (
											SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE kd_rek='31431') x 
											LEFT JOIN (
											SELECT kd_rek, ket FROM isi_neraca_calk where kd_skpd='$kd_skpd') y
											on x.kd_rek=y.kd_rek");
				$prvn = $prv->row();          
				$ket = $prvn->ket;
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\"></td>
							 <td align=\"left\"><strong>$reff $uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
						</tr>
						<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\"></td>
							 <td align=\"justify\" colspan=\"3\">Koreksi kesalahan mendasar dari persediaan yang terjadi pada periode</td>							 
						</tr>";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
			}
			
			// 3.1.4 Selisih Revaluasi Aset Tetap 
		$sql_12 = "	select '3.2' reff, 'Selisih Revaluasi Aset Tetap' uraian, 
					isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='1' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
			$prv = $this->db->query("SELECT x.kd_rek, x.nm_rek, y.ket FROM (
											SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE kd_rek='31432') x 
											LEFT JOIN (
											SELECT kd_rek, ket FROM isi_neraca_calk where kd_skpd='$kd_skpd') y
											on x.kd_rek=y.kd_rek");
				$prvn = $prv->row();          
				$ket = $prvn->ket;
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\"></td>
							 <td align=\"left\"><strong>$reff $uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
						</tr>
						<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\"></td>
							 <td align=\"justify\" colspan=\"3\">Perubahan nilai aset tetap karena revaluasi aset tetap.</td>							 
						</tr>";
						
					$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
			}
			
			// 3.1.4 Lain - lain 
		$sql_12 = "	select '3.3' reff, 'Lain - lain' uraian, 
					isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
			$prv = $this->db->query("SELECT x.kd_rek, x.nm_rek, y.ket FROM (
											SELECT kd_rek, nm_rek FROM ket_neraca_calk WHERE kd_rek='31433') x 
											LEFT JOIN (
											SELECT kd_rek, ket FROM isi_neraca_calk where kd_skpd='$kd_skpd') y
											on x.kd_rek=y.kd_rek");
				$prvn = $prv->row();          
				$ket = $prvn->ket;
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\"></td>
							 <td align=\"left\"><strong>$reff $uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
						</tr>
						<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\"></td>
							 <td align=\"justify\" colspan=\"3\">Transaksi yang mempengaruhi perubahan pada Ekuitas</td>							 
						</tr>";
						
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"5\" $bg_color>
								$ket
							</td>                         
						</tr>";
			$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_314
							</td>                         
						</tr>";
			}
			
			// 3.1.4 Lain - lain (rincian)
		$sql_123 = "select q.reff,q.urain,isnull(q.sal,0) nilai from (
					select '314331'reff,'Penyisihan Piutang' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='1' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '314332'reff,'Koreksi Penyusutan' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='2' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '314333'reff,'Hibah Keluar' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='3' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '314334'reff,'Mutasi Masuk Aset OPD' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='4' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '314335'reff,'Mutasi Keluar Aset OPD' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='5' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '314336'reff,'Penghapusan Persediaan APBN' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='6' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '314337'reff,'Perubahan Kode Rekening' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='7' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '314338'reff,'Koreksi Tanah' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='8' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '314339'reff,'Koreksi Utang Belanja' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='9' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '3143310'reff,'Reklass  Antar Akun' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='10' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '3143311'reff,'Tagihan Penjualan Angsuran' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='11' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '3143312'reff,'Penyertaan Modal' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='12' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '3143313'reff,'Persediaan APBN yang belum' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='13' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '3143314'reff,'Aset peralatan dan mesin reklas ke persediaan lain-lain' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='14' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					union all
					select '3143315'reff,'Koreksi Dana Transfer Pemerintah Pusat' urain,isnull(sum(kredit-debet),0) sal
					from trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev='3' and tgl_real='15' and year(tgl_voucher)='$thn' and a.kd_unit='$kd_skpd'
					) q
					order by cast(q.reff as int)";
					
        $sql_1223=$this->db->query($sql_123);
		
		foreach ($sql_1223->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->urain;
			$sal    = $rowsc->nilai;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
		
			
				$cRet .= "<tr>
							 <td align=\"left\">&nbsp;</td>                         
							 <td align=\"left\"></td>                         
							 <td align=\"left\"></td>
							 <td align=\"left\">$uraian</td>
							 <td align=\"center\">$a$real_sal$b</td>
						</tr>";
					
			}
			
			
			// 3.1.4 Ekuitas Akhir
		$sql_12 = "	select '4' reff, 'Ekuitas Akhir' uraian, sum(sal) sal from (
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where left(kd_rek5,1) in ('8','9') and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and tabel='1' and reev='0' and a.kd_unit='$kd_skpd'
					union all
					select isnull(sum(case when YEAR(tgl_voucher)<='$thn' then kredit-debet else 0 end),0) sal
					from trdju_calk a inner join trhju_calk b on a.no_voucher=b.no_voucher and a.kd_unit=b.kd_skpd
					where kd_rek5='3110101' and reev in ('1','2','3') and a.kd_unit='$kd_skpd'
					) a";
					
        $sql_122=$this->db->query($sql_12);
		
		foreach ($sql_122->result() as $rowsc){
			$reff         = $rowsc->reff;
			$uraian         = $rowsc->uraian;
			$sal    = $rowsc->sal;
			
			if ($sal < 0){
                    	$a="("; $salx=$sal*-1; $b=")";
                        }else {
                    	$a=""; $salx=$sal; $b="";
                        }
			
			$real_sal= number_format($salx,"2",",",".");
			
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>                         
							 <td align=\"left\"><strong></strong></td>                         
							 <td align=\"left\"><strong>$reff</strong></td>
							 <td align=\"left\"><strong>$uraian</strong></td>
							 <td align=\"right\"><strong>$a$real_sal$b</strong></td>
						</tr>";
			}
			
		$cRet .= "</table><br>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("BAB III $kd_skpd /");
        $this->template->set('title', 'BAB III $kd_skpd / $cbulan');        
        
		$pilih=1;
		switch($pilih) {       
        case 1;
			echo ("<title>BAB III</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }
	
	
	
//bab 2
	function calk_program(){
        $data['page_title']= 'CALK BAB II';
        $this->template->set('title', 'CALK BAB II');   
        $this->template->load('template','calk/calk_program',$data) ; 
    }	

	function load_calk_program($data) {
		$skpd     = $this->session->userdata('kdskpd');
		$angg = 'nilai_ubah';
		$thn     = $this->session->userdata('pcThang');
        $result = array();
        $row = array();
      	$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
	    $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
	    $offset = ($page-1)*$rows;        
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> ''){                               
            $where=" AND no_terima LIKE '%$kriteria%' OR tgl_terima LIKE '%$kriteria%' OR keterangan LIKE '%$kriteria%' ";            
        }
        $sql = "SELECT 0 as total" ;
        $query1 = $this->db->query($sql);
        $total = $query1->row();
       	$result["total"] = $total->total; 
        $query1->free_result();
       $sql = "select * from(
                    select kode,bidang,angg_ubah,[real],selisih=angg_ubah-[real],case when angg_ubah=0  then 0 else ([real]/angg_ubah)*100 end [persen],isnull(e.hambatan,'') [hambatan],'$skpd' [kd_skpd] from(
                                                select 7 [nomor], b.kd_kegiatan [kode],b.nm_kegiatan [bidang],sum(a.nilai_ubah) [angg_ubah],
                                                isnull((select sum(debet)-sum(kredit) from trdju_calk d inner join trhju_calk c on d.kd_unit=c.kd_skpd and c.no_voucher=d.no_voucher where d.kd_unit='$skpd' and YEAR(c.tgl_voucher)='$thn' and d.kd_kegiatan=b.kd_kegiatan),0) [real]
                                                from trdrka a join trskpd b on a.kd_kegiatan=b.kd_kegiatan and a.kd_skpd=b.kd_skpd 
                                                where a.kd_skpd='$skpd' and right(b.kd_program,2) not in ('00')  and a.nilai_ubah>0
                                                group by b.kd_kegiatan,b.nm_kegiatan 
                                            ) as prog left join calk_babII e on prog.kode=e.kd_program
                )as gabung where persen<=75 order by kode";
        
        $query1 = $this->db->query($sql); 
        $ii = 0;
        foreach($query1->result_array() as $resulte){ 
                $row[] = array(  
                            'id' => $ii,    
                            'kd_skpd' => $resulte['kd_skpd'],    
                            'kode' => $resulte['kode'],
                            'bidang' => $resulte['bidang'] ,  
                            'hambatan' => $resulte['hambatan']    
                            );
                            $ii++;
        }
       $result["rows"] = $row; 
        echo json_encode($result);
        $query1->free_result();	
        
    }
	
	function cetak_babII($dcetak='',$ttd='',$kd_skpd='',$jnsctk=''){
		
		$spasi = 'line-height:1.5em;';
		$thn_ang     = $this->session->userdata('pcThang');
		$cbulan  = substr($dcetak,5,2);
		$cthnsbl = $thn_ang-1;
        $angg    = "nilai_ubah"; 
        $lanjut  = 0;

		if($cbulan== 12){
			$sumber_data= "_at";
			$trdju = "trdju_calk";
			$trhju = "trhju_calk";
		}else{
		$sumber_data= "";
			$trdju = "trdju";
			$trhju = "trhju";
		}
		
		$sqlsc="SELECT nm_skpd FROM ms_skpd where kd_skpd='$kd_skpd'";
        $sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$nmskpd = $rowsc->nm_skpd;
		} 
		$nm_skpd = strtoupper($nmskpd);	
	    if($angg=='nilai'){
            $jangg = 'PENYUSUNAN' ;  
            $v = '1';
	    } else{
	       if($angg=='nilai_sempurna'){
	           $jangg = 'PENYEMPURNAAN' ;
               $v = '2';
	       }else{
	           $jangg = 'PERUBAHAN' ;
               $v = '3';
	       }
	    }
		$lcttd = str_replace('a',' ',$ttd);
		$sqlsc ="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient where kd_skpd='$kd_skpd'";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc){
			$kab     = $rowsc->kab_kota;
			$prov    = $rowsc->provinsi;
			$daerah  = $rowsc->daerah;
			//$thn     = $rowsc->thn_ang;
		}
		
		$thn = $thn_ang;
		
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode IN ('PA','KPA') and nip='$lcttd'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd){
			$nip      =$rowttd->nip;                    
			$nama_ttd = $rowttd->nm;
			$jabatan  = $rowttd->jab;
		}
        
		if($jnsctk==1){
			$bg_color = "bgcolor=\"yellow\"";
			$tombol_program = "<form name=\"patient\" action=\"/simakdaskpd_2018/calk/calk_program/$v \" methode=\"get\" target=\"blank\">
							<input type=\"submit\" value=\"Edit \">&nbsp;&nbsp; 
							<input type=\"button\" value=\"Refresh\" onClick=\"window.location.reload()\">
					   </form>";
        }else{
			$bg_color = "";
			$tombol_program = "";
		}
		
		
        $cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;$spasi\" width=\"100%\" align=\"left\" border=\"0\">
                  <tr>
                    <td style=\"font-weight:bold;\" colspan=\"7\" align=\"center\">BAB   II   IKHTISAR PENCAPAIAN KINERJA KEUANGAN <br><br></td>      
                  </tr>

                  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\">2.1.</td>
                    <td style=\"font-weight:bold;\" colspan=\"6\">Ikhtisar Realisasi Pencapaian Target Kinerja Keuangan.</td>      
                  </tr>
				  <tr>
                    <td style=\"font-weight:bold;\" width=\"3%\">&nbsp;</td>
                    <td style=\"font-weight:bold;\" colspan=\"6\">&nbsp;</td>      
                  </tr>
                  <tr>
                    <td align=\"center\" style=\"font-weight:bold;border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\" colspan=\"2\">KODE</td>
                    <td align=\"center\" style=\"font-weight:bold;border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\">BIDANG URUSAN PEMERINTAH DAERAH</td>
                    <td align=\"center\" style=\"font-weight:bold;border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\">ANGGARAN $jangg</td>
                    <td align=\"center\" style=\"font-weight:bold;border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\">REALISASI</td>
                    <td align=\"center\" style=\"font-weight:bold;border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\">BERLEBIH/ (BERKURANG) </br>(Rp.)</td>
                    <td align=\"center\" style=\"font-weight:bold;border-left:solid 1px black;border-right:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\">%</td>
                  </tr>";

				$sql = "select * from(
                            select 1 [nomor], kd_org [kode],nm_org [bidang],0 [angg_ubah], 0 [real],0 selisih,0 persen,'' [hambatan] from ms_organisasi where kd_org=left('$kd_skpd',7)
                            union all
                            select 2 [nomor], kd_skpd [kode],nm_skpd [bidang],0 [angg_ubah], 0 [real],0 selisih,0 persen,'' [hambatan] from ms_skpd where kd_skpd='$kd_skpd'
                            union all
                            select 3 [nomor], '' [kode],upper(nm_kegiatan)+' '+nm_skpd [bidang],sum($angg) [angg_ubah], 
                            (select sum(kredit-debet) from trdju_calk a inner join trhju_calk b on a.kd_unit=b.kd_skpd and a.no_voucher=b.no_voucher where a.kd_unit='$kd_skpd' and a.map_real like '4%' and YEAR(b.tgl_voucher)=$thn ) [real],0 selisih,0 persen,'' [hambatan]
                            from trdrka_pend where kd_skpd='$kd_skpd'
                            group by kd_skpd,nm_skpd,nm_kegiatan
                            union all
                            select 4 [nomor], '' [kode],'BELANJA'+' '+nm_skpd [bidang],0 [angg_ubah], 0 [real],0 selisih,0 persen,'' [hambatan]
                            from ms_skpd where kd_skpd='$kd_skpd'
                            union all
                            select 5 [nomor], '' [kode],'BELANJA TIDAK LANGSUNG' [bidang],sum($angg) [angg_ubah], 
                            (select sum(debet-kredit) from trdju_calk a inner join trhju_calk b on a.kd_unit=b.kd_skpd and a.no_voucher=b.no_voucher where a.kd_unit='$kd_skpd' and a.map_real like '51%' and YEAR(b.tgl_voucher)=$thn) [real],0 selisih,0 persen,'' [hambatan]
                            from trdrka where kd_skpd='$kd_skpd' and kd_rek5 like '51%'
                            group by kd_skpd
                            union all
                            select 6 [nomor], '' [kode],'BELANJA LANGSUNG' [bidang],0 [angg_ubah], 0 [real],0 selisih,0 persen,'' [hambatan]
                            from ms_skpd where kd_skpd='$kd_skpd' 
                            union all
                            select nomor,kode,bidang,angg_ubah,real,selisih=[real]-angg_ubah,case when angg_ubah=0  then 0 else ([real]/angg_ubah)*100 end [persen],isnull(e.hambatan,'') [hambatan] from(
                                select 7 [nomor], b.kd_program [kode],b.nm_program [bidang],sum(a.$angg) [angg_ubah],
                                (select ISNULL(sum(debet-kredit),0) from trdju_calk d inner join trhju_calk c on d.kd_unit=c.kd_skpd and c.no_voucher=d.no_voucher where d.kd_unit='$kd_skpd' and YEAR(c.tgl_voucher)='$thn' and left(d.kd_kegiatan,18)=b.kd_program) [real]
                                from trdrka a join trskpd b on a.kd_kegiatan=b.kd_kegiatan and a.kd_skpd=b.kd_skpd 
                                where a.kd_skpd='$kd_skpd' and right(b.kd_program,2) not in ('00')
                                group by b.kd_program,b.nm_program 
                            ) as prog left join calk_babII e on prog.kode=e.kd_program where angg_ubah>0 
                            union all
                            select nomor,kode,bidang,angg_ubah,real,selisih=[real]-angg_ubah,case when angg_ubah=0  then 0 else ([real]/angg_ubah)*100 end [persen],isnull(e.hambatan,'') [hambatan] from(
                                select 8 [nomor], b.kd_kegiatan [kode],b.nm_kegiatan [bidang],sum(a.$angg) [angg_ubah],
                                (select ISNULL(sum(debet-kredit),0) from trdju_calk d inner join trhju_calk c on d.kd_unit=c.kd_skpd and c.no_voucher=d.no_voucher where d.kd_unit='$kd_skpd' and YEAR(c.tgl_voucher)='$thn' and d.kd_kegiatan=b.kd_kegiatan) [real]
                                from trdrka a join trskpd b on a.kd_kegiatan=b.kd_kegiatan and a.kd_skpd=b.kd_skpd 
                                where a.kd_skpd='$kd_skpd' and right(b.kd_program,2) not in ('00')
                                group by b.kd_kegiatan,b.nm_kegiatan 
                            ) as keg left join calk_babII e on keg.kode=e.kd_program   where angg_ubah>0                 
                        )as gabung order by nomor,kode ";
			$csql=$this->db->query($sql);
            $this->tprogram = 'A';
		    $anggbl = 0;  $realbl = 0; $anggbtl = 0; $realbtl = 0;
            foreach ($csql->result() as $rowsc){
                switch($rowsc->nomor) {       
                    case 5;
                        $anggbtl=$anggbtl+$rowsc->angg_ubah;
                        $realbtl=$realbtl+$rowsc->real;
                    break;
                    case 7;
                        $anggbl=$anggbl+$rowsc->angg_ubah;
                        $realbl=$realbl+$rowsc->real;
                    break;
                    
                }
            }
            
            foreach ($csql->result() as $rowsc1){
            if($rowsc1->nomor!=8){    
                $kode = $rowsc1->kode;
                $bidang = $rowsc1->bidang;
                $angg = $rowsc1->angg_ubah;
                $real = $rowsc1->real;
                $selisih = $rowsc1->selisih;
                
				if($rowsc1->nomor!=7){
                    $bold = 'font-weight:bold;';
                    
                    
                    if($rowsc1->nomor==4){
                        $angg =  $anggbl + $anggbtl;
                        $real =  $realbl + $realbtl;
                    }

                    if($rowsc1->nomor==6){
                        $angg =  $anggbl;
                        $real =  $realbl;
                    }                    
                }else{
                    $bold='';
                }
                
                if($selisih==0){
                    $selisih = $real - $angg;
                }
                
 
                if($angg!=0){
					$persen2 = ($real!=0)?($real / $angg ) * 100:0;
					$persen =$persen2;// empty($persen2) || $persen2 == 0 ? 0 :$persen2;				
				}else{
					$persen2 = 100;$persen=100;
				}

 
                if($persen==0){
                    $persen = $this->persen($angg,$real);
                }
                
                
                $persen =  substr($persen, 0, 5); 
                if($rowsc1->nomor==1 || $rowsc1->nomor==2){
                    $angg = '';
                    $real = '';
                    $selisih = '';
                    $persen = '';
                }else{
                    $angg = number_format($angg,"2",",",".");
                    $real = number_format($real,"2",",",".");
                    $selisih =  $this->rp_minus($selisih); ;
                    if($rowsc1->nomor==8){
                        $lanjut =1;
                        if($persen<=75){
                            $lanjut = $lanjut + 1;
                        }                        
                        $persen = $persen;
						
                    }
                }

				
               
        		$cRet .= "
                          <tr>
        						 <td style=\" $bold border-left:solid 1px black;border-bottom:solid 1px black;\" align=\"left\" valign=\"top\" colspan=\"2\">$kode</td>                         
        						 <td style=\" $bold border-left:solid 1px black;border-bottom:solid 1px black;\" align=\"left\" valign=\"top\">$bidang</td>                         
        						 <td style=\" $bold border-left:solid 1px black;border-bottom:solid 1px black;\" align=\"right\" valign=\"top\">$angg</td>
        						 <td style=\" $bold border-left:solid 1px black;border-bottom:solid 1px black;\" align=\"right\" valign=\"top\">$real</td>
        						 <td style=\" $bold border-left:solid 1px black;border-bottom:solid 1px black;\" align=\"right\" valign=\"top\">$selisih</td>
        						 <td style=\" $bold border-left:solid 1px black;border-right:solid 1px black;border-bottom:solid 1px black;\" align=\"right\" valign=\"top\">$persen </td>   						  
        					</tr>";
            }else{
                $angg = $rowsc1->angg_ubah;
                $real = $rowsc1->real;

				$persen2 = ($real!=0)?($real / $angg ) * 100:0;
				$persen =$persen2;// empty($persen2) || $persen2 == 0 ? 0 :$persen2;
						
					                     
                        if($persen<=75){
                            $lanjut = $lanjut + 1;
                        }                        
                    
            }
			}

                  
            if($lanjut>0){
        		$cRet .= "<tr>
                            <td colspan=\"7\">&nbsp;</br></br></td>
                          </tr>
                          <tr>
                            <td style=\"font-weight:bold;\" >2.1.</td>
                            <td style=\"font-weight:bold;\" colspan=\"6\">Hambatan dan Kendala Yang Ada Dalam Pencapaian Target</td>      
                          </tr>
                          <tr>
                            <td style=\"font-weight:bold;\" ></td>
                            <td style=\"\" colspan=\"6\">Adapun Hambatan dan Kendala yang ada pada program-program kegiatan $nmskpd Provinsi Kalimantan Barat dalam pencapaian target kurang 
                            dari 75%, dapat dijelaskan sebagai berikut :</br></br></td>      
                          </tr>
                          </table>
                          <table width=\"100%\" style=\"border-collapse:collapse;$spasi\"  align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"1\"> 
                          <tr>
    						 <td style=\" font-weight:bold; border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\" align=\"center\" colspan=\"2\">No</td>                         
    						 <td style=\" font-weight:bold; border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\" align=\"center\">PROGRAM KEGIATAN</td>                         
    						 <td style=\" font-weight:bold; border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\" align=\"center\">ANGGARAN $jangg</td>
    						 <td style=\" font-weight:bold; border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\" align=\"center\">REALISASI</td>
    						 <td style=\" font-weight:bold; border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\" align=\"center\">%</td>
    						 <td style=\" font-weight:bold; border-left:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\" align=\"center\">HAMBATAN DAN KENDALA DALAM PENCAPAIAN TARGET KURANG DARI 75%</td>   						  
     					  </tr>";
                          
                    	
    
                $i = 1;
                foreach ($csql->result() as $rowsc2){
                    if($rowsc2->nomor==8){
                        $kode = $rowsc2->kode;
                        $bidang = $rowsc2->bidang;
                        $angg = $rowsc2->angg_ubah;
                        $real = $rowsc2->real;
                        $selisih = $rowsc2->selisih;
                        $persen = substr($rowsc2->persen, 0, 5);
                        $hambatan = $rowsc2->hambatan;
                        
                        if($persen<=75){
                    		$cRet .= "
                                      <tr>
                    						 <td style=\" $bold border-left:solid 1px black;border-bottom:solid 1px black;\" align=\"center\" valign=\"top\" colspan=\"2\">$i</td>                         
                    						 <td style=\" $bold border-left:solid 1px black;border-bottom:solid 1px black;\" align=\"left\" valign=\"top\">$bidang</td>                         
                    						 <td style=\" $bold border-left:solid 1px black;border-bottom:solid 1px black;\" align=\"right\" valign=\"top\">".number_format($angg,"2",",",".")."</td>
                    						 <td style=\" $bold border-left:solid 1px black;border-bottom:solid 1px black;\" align=\"right\" valign=\"top\">".number_format($real,"2",",",".")."</td>
                    						 <td style=\" $bold border-left:solid 1px black;border-bottom:solid 1px black;\" align=\"right\" valign=\"top\">".number_format($persen,"2",",",".")."</td>
                    						 <td style=\" $bold border-left:solid 1px black;border-right:solid 1px black;border-top:solid 1px black;border-bottom:solid 1px black;\" align=\"left\" valign=\"top\" $bg_color>$hambatan</td>   						  
                    					</tr>
                                        "; 
                            $i++;                             
                        }
                    }
                
                }        
				$cRet .= "<tr>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"left\"><strong>&nbsp;</strong></td>
							 <td align=\"justify\" colspan=\"7\">
								$tombol_program
							</td>                         
						</tr>";

            }

		$cRet .= "</table><br>";
		
	    $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul  = ("BAB II $kd_skpd");
        $this->template->set('title', 'BAB II $kd_skpd / $cbulan');        
        
		$pilih=1;
		switch($pilih) {       
        case 1;
			echo ("<title>$judul</title>");
			 echo $cRet;
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break; 
		case 4;     
		   $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		break;
        } 
    }


	function simpan_babII() {
		
            $tabel          = $this->input->post('tabel');
            $lckolom        = $this->input->post('kolom');
            $lcnilai        = $this->input->post('nilai');
            $kdprog         = $this->input->post('kdprog');
            $ken             = $this->input->post('ken');
			$skpd           = $this->input->post('skpd');
			
			
			$sql = "delete calk_babII where kd_program='$kdprog'";
            $asg = $this->db->query($sql);
            if ($asg){
				$sql        = "insert into $tabel $lckolom values $lcnilai";
				$asg       	 = $this->db->query($sql);
				if ( $asg > 0 ) {
					echo '2';
				} else {
					echo '0';
					exit();
				}
			}
		
	}
	
//end bab 2	

	
	function  dotrek($rek){
				$nrek=strlen($rek);
				switch ($nrek) {
                case 1:
				$rek = $this->left($rek,1);								
       			 break;
    			case 2:
					$rek = $this->left($rek,1).'.'.substr($rek,1,1);								
       			 break;
    			case 3:
					$rek = $this->left($rek,1).'.'.substr($rek,1,1).'.'.substr($rek,2,1);								
       			 break;
    			case 5:
					$rek = $this->left($rek,1).'.'.substr($rek,1,1).'.'.substr($rek,2,1).'.'.substr($rek,3,2);								
        		break;
    			case 7:
					$rek = $this->left($rek,1).'.'.substr($rek,1,1).'.'.substr($rek,2,1).'.'.substr($rek,3,2).'.'.substr($rek,5,2);								
        		break;
    			default:
				$rek = "";	
				}
				return $rek;
    }
    
    function right($value, $count){
    return substr($value, ($count*-1));
    }

    function left($string, $count){
    return substr($string, 0, $count);
    }    
	
}